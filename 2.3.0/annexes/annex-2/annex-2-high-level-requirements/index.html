
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.3.0/annexes/annex-2/annex-2-high-level-requirements/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>European Digital Identity Wallet - European Digital Identity</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="European Digital Identity Wallet - European Digital Identity" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.3.0/assets/images/social/annexes/annex-2/annex-2-high-level-requirements.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.3.0/annexes/annex-2/annex-2-high-level-requirements/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="European Digital Identity Wallet - European Digital Identity" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.3.0/assets/images/social/annexes/annex-2/annex-2-high-level-requirements.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#annex-2-high-level-requirements" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="European Digital Identity" class="md-header__button md-logo" aria-label="European Digital Identity" data-md-component="logo">
      
  <img src="../../../media/eu-logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            European Digital Identity
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              European Digital Identity Wallet
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  European Digital Identity Wallet

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../architecture-and-reference-framework-main/" class="md-tabs__link">
        
  
  
    
  
  Architecture and reference framework

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../discussion-topics/" class="md-tabs__link">
        
  
  
    
  
  Discussion topics

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../technical-specifications/" class="md-tabs__link">
        
  
  
    
  
  Technical specifications

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="European Digital Identity" class="md-nav__button md-logo" aria-label="European Digital Identity" data-md-component="logo">
      
  <img src="../../../media/eu-logo.jpg" alt="logo">

    </a>
    European Digital Identity
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    European Digital Identity Wallet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../architecture-and-reference-framework-main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture and reference framework
    
      <br>
      <small>Architecture and Reference Framework</small>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../discussion-topics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discussion topics
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../technical-specifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical specifications
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="annex-2-high-level-requirements">ANNEX 2 - High-Level Requirements <!-- omit from toc --></h1>
<h2 id="a2-high-level-requirements">A.2 High-level requirements</h2>
<h3 id="a21-introduction">A.2.1 Introduction</h3>
<h4 id="a211-overview">A.2.1.1 Overview</h4>
<p>This annex to the <a href="../../../architecture-and-reference-framework-main/">ARF main document</a>
includes high-level requirements (HLRs) related to the EUDI Wallet ecosystem.
The requirements define the responsible actor that should implement each
requirement. There are no requirements imposed on the Users.</p>
<p>All requirements in this Annex only apply in the context of the EUDI Wallet
ecosystem. Attestations that are not bound to Wallet Units, as described in
<a href="../../../architecture-and-reference-framework-main/#6638-relying-party-instance-verifies-device-binding">Section 6.6.3.8 of the ARF main document</a>,
 are not included in the scope of this Annex.</p>
<h4 id="a212-key-words">A.2.1.2 Key words</h4>
<p>This Annex uses the capitalised key words 'SHALL', 'SHOULD' and 'MAY' as
specified in <a href="https://datatracker.ietf.org/doc/html/rfc2119">RFC 2119</a>, i.e., to
indicate requirements, recommendations and options specified in this annex.</p>
<p>In addition, 'must' (non-capitalised) is used to indicate an external
constraint, i.e., a requirement that is not mandated by this document,
but, for instance, by an external standard or specification. The word
'can' indicates a capability, whereas other words, such as 'will', and
'is' or 'are', are intended as statements of fact.</p>
<h3 id="a22-structure-and-order-of-presentation-of-the-hlrs">A.2.2 Structure and order of presentation of the HLRs</h3>
<p>Topics presented in <a href="#a23-high-level-requirements">Section A.2.3</a> are ordered by
a Topic number.</p>
<p>Each Topic includes a short description, followed by the High-Level
Requirements (HLRs), identified by a unique identifier. The identifier
includes a prefix which signifies the context of the HLRs (e.g. ISSU
for issuance), an underscore and a numerator, e.g. ISSU_10.</p>
<h3 id="a23-high-level-requirements">A.2.3 High-Level Requirements</h3>
<h4 id="a231-topic-1-accessing-online-services-with-a-wallet-unit">A.2.3.1 Topic 1 - Accessing Online Services with a Wallet Unit</h4>
<h5 id="description">Description <!-- omit from toc --></h5>
<p>One of the main use cases of the EUDI Wallet ecosystem is to enable Users to access
online services and to enable Relying Parties offering such services to, where needed, identify
and authenticate Users with a high level of assurance. This essential
functionality ensures that Relying Parties can confidently verify that they are
interacting with the correct User.</p>
<p>Note: As specified in the [European Digital Identity Regulation], legally speaking, the term 'Relying Party' also include QEAA Providers, PuB-EAA Providers,
and non-qualified EAA Providers. However, for clarity this Annex uses the term 'Relying Party' exclusively in the meaning of a service provider interacting with a Wallet Unit to request and receive attributes from an attestation.</p>
<p>In this use case, a User is using their Wallet Unit to present attributes in order to access online services offered by Relying Parties. The User is concerned about presenting such attributes during online interactions. Their objectives include maintaining control
over the presentation of personal attributes from PIDs and attestations.</p>
<h5 id="hlrs">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>OIA_01</td>
<td>A Wallet Unit SHALL support [SD-JWT VC] for remote presentation flows and [ISO/IEC 18013-5] for proximity presentation flows, to receive and respond to presentation requests for person identification data (PID) and attestations by Relying Parties.</td>
</tr>
<tr>
<td>OIA_02</td>
<td>A Wallet Unit SHALL support proving cryptographic device binding between a WSCA/WSCD included in the Wallet Unit and a PID or attestation, in accordance with [SD-JWT VC] or [ISO/IEC 18013-5]. <em>Notes: Such a mechanism is called 'mdoc authentication' in [ISO/IEC 18013-5] and 'key binding' in [SD-JWT VC]. - Discussions on device binding are ongoing, in particular regarding whether non-device-bound PIDs or attestations should be supported by a Wallet Unit, and if so, what the requirements for this support should be.</em></td>
</tr>
<tr>
<td>OIA_03</td>
<td>Empty</td>
</tr>
<tr>
<td>OIA_03a</td>
<td>Wallet Providers SHALL ensure that their Wallet Solution supports the protocol specified in 'OpenID for Verifiable Presentations', see [OpenID4VP], with additions and changes as documented in this Annex and in technical specifications referenced in this Annex.</td>
</tr>
<tr>
<td>OIA_03b</td>
<td>For remote presentation flows, when the format of the requested attestation complies with [ISO/IEC 18013-5], Relying Parties and Wallet Units SHALL comply with the requirements in the profile for OpenID4VP specified in [ISO/IEC 18013-7] Annex B.</td>
</tr>
<tr>
<td>OIA_03c</td>
<td>For remote presentation flows, when the format of the requested attestation complies with [SD-JWT VC], Relying Parties and Wallet Units SHALL comply with the requirements in the 'OpenID for Verifiable Presentations for IETF SD-JWT VC' profile specified in [HAIP].</td>
</tr>
<tr>
<td>OIA_04</td>
<td>A Wallet Unit SHALL verify and process PID or attestation presentation requests from Relying Parties in accordance with the protocols and interfaces specified in [OpenID4VP] for remote flows.</td>
</tr>
<tr>
<td>OIA_05</td>
<td>After verifying and processing a PID or attestation request, the Wallet Unit SHALL display to the User the identity of the requesting Relying Party and the requested attributes.</td>
</tr>
<tr>
<td>OIA_06</td>
<td>A Wallet Unit SHALL present the requested attributes only after having received the User's authorisation. <em>Note: See also OIA_07</em>.</td>
</tr>
<tr>
<td>OIA_07</td>
<td>A Wallet Unit SHALL support selective disclosure of attributes from PIDs and attestations to be released to the requesting Relying Parties.</td>
</tr>
<tr>
<td>OIA_08</td>
<td>Wallet Units and Relying Party Instances SHOULD support the [W3C Digital Credentials API]](<a href="https://wicg.github.io/digital-credentials/">https://wicg.github.io/digital-credentials/</a>) for remote presentation flows, provided that a) this API is fully standardised, b) this API complies with the expectations outlined in <a href="../../../discussion-topics/f-digital-credential-api/#3">Chapter 3</a> of the Topic F discussion paper, and c) this API is broadly supported by relevant browsers and operating systems.</td>
</tr>
<tr>
<td>OIA_08a</td>
<td>If Wallet Units and Relying Party Instances do not support the [W3C Digital Credentials API], they SHALL implement adequate mitigations for the challenges described in <a href="../../../architecture-and-reference-framework-main/#4431-introduction">Section 4.4.3.1</a> of the ARF main document.</td>
</tr>
<tr>
<td>OIA_08b</td>
<td>If a Wallet Unit supports the [W3C Digital Credentials API], it SHALL disclose the presence of all stored attestations and attributes to the Digital Credentials API framework, but it SHALL NOT disclose the value of the attributes in these attestations. <em>Note: The latter restriction applies even if such disclosure would enhance the services provided by the operating system to the Wallet Unit, for example, attestation selection in the context of the Digital Credentials API.</em></td>
</tr>
<tr>
<td>OIA_08c</td>
<td>If a Relying Party supports the [W3C Digital Credentials API], the Relying Party's presentation request MAY be processed by the browser for searching available attestations, for preventing fraud targeting the user, or for troubleshooting purposes. Moreover, the request SHOULD be processed by the browser for User security purposes. However, the request SHALL NOT be processed by the browser for market analysis purposes (including as a secondary purpose) or for the browser's own purposes.</td>
</tr>
<tr>
<td>OIA_09</td>
<td>For remote presentation flows the Wallet Unit SHALL ensure that the attributes included in the presented attestation are accessible only to the Relying Party Instance, by encrypting the presentation response. The technical specification meant in OIA_03a SHALL specify mechanisms preventing decryption of the presentation response via Man-in-the-Middle attacks by the browser, the operating system, or other components between the Wallet Unit and the Relying Party.</td>
</tr>
<tr>
<td>OIA_10</td>
<td>For both proximity and remote presentation flows, if a Wallet Unit contains two PIDs having the same encoding (e.g. ISO/IEC 18013-5 or SD-JWT VC-compliant) and a Relying Party requests a PID, the Wallet Unit SHALL ask the User which of these PIDs they want to release, unless the Wallet Unit can decide from context.</td>
</tr>
<tr>
<td>OIA_11</td>
<td>For both proximity and remote presentation flows, if a Wallet Unit contains two attestations having the same encoding (e.g. ISO/IEC 18013-5 or SD-JWT VC-compliant) and the same attestation type, and a Relying Party requests an attestation of that type and encoding, the Wallet Unit SHALL ask the User which of these attestations they want to release, unless the Wallet Unit can decide from context. <em>Note: Attestation types are explained in [<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>].</em></td>
</tr>
<tr>
<td>OIA_12</td>
<td>For both proximity and remote presentation flows, a Relying Party SHALL validate the signature of a PID using a trust anchor provided in a PID Provider Trusted List made available in accordance with [<a href="#a2331-topic-31----notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">Topic 31</a>].</td>
</tr>
<tr>
<td>OIA_13</td>
<td>For both proximity and remote presentation flows, a Relying Party SHALL validate the qualified signature of a QEAA in accordance with Art.32 of the [European Digital Identity Regulation]. For the verification, the Relying Party SHALL use a trust anchor provided in a QEAA Provider Trusted List made available in accordance with <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv%3AOJ.L_.2014.257.01.0073.01.ENG#d1e2162-73-1">Art. 22</a> of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>OIA_14</td>
<td>For both proximity and remote presentation flows, a Relying Party SHALL validate the qualified signature of a PuB-EAA in accordance with <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv%3AOJ.L_.2014.257.01.0073.01.ENG#d1e2594-73-1">Art.32</a> of the [European Digital Identity Regulation]. For that verification, the Relying Party SHALL use the public key provided in the qualified certificate of the QTSP supporting the qualified signature. The Relying Party SHALL also validate the qualified certificate of the QTSP using a trust anchor provided in a Trusted List made available in accordance with <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv%3AOJ.L_.2014.257.01.0073.01.ENG#d1e2162-73-1">Art. 22</a> of the [European Digital Identity Regulation]. The Relying Party SHALL also verify the certified attributes of the qualified certificate, as specified in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e3902-1-1">Article 45f</a>.</td>
</tr>
<tr>
<td>OIA_15</td>
<td>For both proximity and remote presentation flows, a Relying Party SHALL validate the signature of a non-qualified EAA using a trust anchor provided according to the mechanism(s) specified in the applicable Rulebook, see [<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>]. <em>Notes: - OIA_12 - OIA_15 imply that a Relying Party Instance must know if the attestation it is requesting from a Wallet Instance is a PID, a QEAA, a PuB-EAA, or a non-qualified EAA. These requirements also imply that the Relying Party Instance must store trust anchors in such a way that, at the time of verification, it is able to distinguish between trust anchors usable either for PIDs, for QEAAs, for PuB-EAAs, or for non-qualified EAAs. - PID Providers, QEAA Providers, and PuB-EAA Providers are trusted by other actors in the EUDI Wallet ecosystem to not fraudulently issue attestations (or PIDs) that they are not legally allowed to issue. This trust is warranted since these kinds of providers operate within a regulated framework and are regularly audited. However, non-qualified EAA Providers are unregulated and may not be completely trustworthy. Therefore, when it receives an non-qualified attestation, a Relying Party Instance may have to verify that the non-qualified EAA Provider is authorised or registered to issue this type of attestation, in addition to verifying the signature over the attestation using the EAA Provider's trust anchor. Mechanisms allowing to do this should be defined in the applicable Rulebook, see ARB_26.</em></td>
</tr>
<tr>
<td>OIA_16</td>
<td>When receiving a PID or attestation, a Relying Party Instance SHALL discard the values of all unique elements, including at least the ones mentioned in requirement ISSU_35 in <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>, as well as any timestamps, as soon as they are no longer needed. The Relying Party Instance SHALL NOT communicate these values to the Relying Party or to any other party inside or outside the EUDI Wallet ecosystem.</td>
</tr>
</tbody>
</table>
<h4 id="a232-topic-2-mobile-driving-licence-within-the-eudi-wallet-ecosystem">A.2.3.2 Topic 2 - Mobile Driving Licence within the EUDI Wallet ecosystem</h4>
<h5 id="description_1">Description <!-- omit from toc --></h5>
<p>A User can obtain their mobile Driving Licence (mDL) from an mDL Provider and
store it in an Wallet Unit. The User can then present the mDL to a Relying Party
upon request to prove their driving rights conveniently, securely, and in
compliance with the Driving Licences Directive, once it is adopted.</p>
<p>This Topic contains high-level requirements related to a User presenting a
mobile Driving Licence (mDL) to a Relying Party in a supervised or unsupervised
scenario, and also in an unsupervised scenario, in proximity mode.</p>
<h5 id="hlrs_1">HLRs <!-- omit from toc --></h5>
<p>No high-level requirements are identified for this Topic, as the mDL is an
attestation that must comply with all relevant requirements in other Topics.</p>
<h4 id="a233-topic-3-pid-rulebook">A.2.3.3 Topic 3 - PID Rulebook</h4>
<h5 id="description_2">Description <!-- omit from toc --></h5>
<p>The Person Identification Data (PID) Rulebook contains requirements specific to
the PID within the EUDI Wallet ecosystem.</p>
<p>The PID Rule Book contains the PID attribute schema, which describes the structure, the type, the identifiers, and the logical organisation of the mandatory and optional
attributes and metadata of the PID, as specified in Commission Implementing
Regulation (EU) 2024/2977. It also describes how Member States can specify any
possible national attributes. Two encodings for these attributes are specified,
one compliant with [ISO/IEC 18013-5], the other compliant with [SD-JWT VC].</p>
<p>For more information, see Annex 3 - [PID Rulebook].</p>
<h5 id="a-generic-hlrs">A. Generic HLRs <!-- omit from toc --></h5>
<p>The requirements in the table below are valid for all PIDs in the EUDI Wallet
ecosystem, regardless of the encoding used.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PID_01</td>
<td>PIDs and PID Providers SHALL comply with all requirements in [PID Rulebook].</td>
</tr>
<tr>
<td>PID_02</td>
<td>A PID Provider SHALL issue any PID in both the format specified in ISO/IEC 18013-5 [ISO/IEC 18013-5] and the format specified in [SD-JWT VC]. <em>Note: [CIR 2024/2977] mentions the W3C Verifiable Credentials Data Model v1.1 instead of [SD-JWT VC]. The latest stable version of this standard is [W3C VCDM 2.0].  However, W3C VCDM is not a complete specification of an attestation format. In particular, it does not specify a specific proof method to be used. Without additional specification, such as those in [W3C VC-JOSE-COSE] or [W3C VC Data Integrity], and making further choices, it is impossible to implement a PID based on W3C VCDM. This Rulebook considers [SD-JWT VC] to essentially be such an additional specification. See also <a href="../../../architecture-and-reference-framework-main/#534-w3c-verifiable-credentials">Section 5.3.4</a> of the ARF main document.</em></td>
</tr>
<tr>
<td>PID_03</td>
<td>The portrait in a PID SHALL consist of a single portrait image in JPEG format. The portrait image SHALL comply with the quality requirements for a Full Frontal Image Type in ISO/IEC 19794-5 clauses 8.2, 8.3, and 8.4. However, the attribute portrait SHALL NOT comply with the format requirements in ISO/IEC 19794-5 clauses 8.1 and 8.5, meaning it SHALL NOT contain any of the headers or blocks specified in clause 5 except for the image data itself (a JPEG).</td>
</tr>
</tbody>
</table>
<h5 id="b-hlrs-for-isoiec-18013-5-compliant-pids">B. HLRs for ISO/IEC 18013-5-compliant PIDs <!-- omit from toc --></h5>
<p>The requirements in the table below are valid for PIDs in the EUDI Wallet
ecosystem that are compliant with [ISO/IEC 18013-5].</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PID_04</td>
<td>PID Providers SHALL use "eu.europa.ec.eudi.pid.1" as the attestation type for ISO/IEC 18013-5-compliant PIDs. <em>Notes: - This identifier uses the general format [Reverse Domain].[Domain Specific Extension]. Since the European Commission controls the domain ec.europa.eu, this attestation type identifier will not collide with any attestation type identifiers defined by other organisations in other Attestation Rulebooks. - The Commission may use the version number "1" in this identifier to distinguish between the first version of the PID, defined in the <a href="../../annex-3/annex-3.01-pid-rulebook/">PID Rulebook</a>, and any future version, which will then have an incremented version number.</em></td>
</tr>
<tr>
<td>PID_05</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider SHALL use the value "eu.europa.ec.eudi.pid.1" for the identifier of the namespace for the PID attributes specified in <a href="../../annex-3/annex-3.01-pid-rulebook/#42-encoding-of-pid-attributes-and-metadata">Section 4.2 of the PID Rulebook</a>. <em>Notes: - The version number "1" allows for future extension(s) or change(s) of the ISO/IEC 18013-5-compliant PID attributes. - This namespace has the same value as the attestation type specified in requirement PID_04. This is allowed according to ISO/IEC 18013-5.</em></td>
</tr>
<tr>
<td>PID_06</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider MAY include attributes that are not defined in the <a href="../../annex-3/annex-3.01-pid-rulebook/">PID Rulebook</a>. If so, these attributes SHALL be defined within a domestic PID namespace as meant in requirement ARB_10 in <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>. The PID Provider SHALL generate the identifier for this domestic PID namespace by appending the applicable ISO 3166-1 alpha-2 country code or the ISO 3166-2 region code, separated by a period, to the PID namespace identifier specified in PID_05, excluding the version number. The PID Provider MAY include a version number in the domestic PID namespace identifier. <em>Note: For example, the identifier of the first domestic PID namespace for Germany could be "eu.europa.ec.eudi.pid.de.1".</em></td>
</tr>
<tr>
<td>PID_07</td>
<td>A PID Provider that defines a domestic namespace SHALL publish the namespace, including all attribute identifiers, their definition, presence and encoding format, in an Attestation Rulebook complying with all applicable requirements in <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>.</td>
</tr>
<tr>
<td>PID_08</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider SHALL include both the attributes and the metadata specified in [CIR 2024/2977] in the PID as (issuer-signed or device-signed) data elements. <em>Note: This implies that technically speaking, there is no difference between these attributes and metadata.</em></td>
</tr>
<tr>
<td>PID_09</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider SHALL encode each attribute or metadata in the PID as specified in the third column of the tables in <a href="../../annex-3/annex-3.01-pid-rulebook/#421-overview">Section 4.2.1 of the PID Rulebook</a>.</td>
</tr>
<tr>
<td>PID_10</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider SHALL encode each attribute or metadata in the PID in Concise Binary Object Representation (CBOR) according to [RFC 8949].</td>
</tr>
<tr>
<td>PID_11</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider SHALL ensure that each PID contains at most one attribute with the same attribute identifier.</td>
</tr>
<tr>
<td>PID_12</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider SHALL ensure that the value of all attributes and metadata in the PID is valid at the value of the timestamp in the validFrom element in the MSO, see [ISO/IEC 18013-5] clause 9.1.2.4. <em>Note: The value of the age_over_18, age_over_NN, or age_in_years attributes, if present, changes whenever the User to whom the person identification data relates has a relevant birthday. The value of many other attributes will also change over time.</em></td>
</tr>
<tr>
<td>PID_13</td>
<td>When issuing a PID compliant with [ISO/IEC 18013-5], a PID Provider SHALL ensure that the issuance_date attribute, if present, is not later than the validFrom element in the MSO, see [ISO/IEC 18013-5] clause 9.1.2.4.</td>
</tr>
</tbody>
</table>
<h5 id="c-hlrs-for-sd-jwt-vc-compliant-pids">C. HLRs for SD-JWT VC-compliant PIDs <!-- omit from toc --></h5>
<p>The requirements in the table below are valid for PIDs in the EUDI Wallet
ecosystem that are compliant with [SD-JWT VC].</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PID_14</td>
<td>A PID Provider issuing [SD-JWT VC]-compliant PIDs SHALL include the vct claim in their PIDs, where the vct claim SHALL be a URN within the <code>urn:eudi:pid:</code> namespace. The type indicated by the vct claim SHALL be <code>urn:eudi:pid:1</code> for the type defined in this document or a domestic type that extends it.</td>
</tr>
<tr>
<td>PID_15</td>
<td>A catalog linked in the PID Rulebook SHALL associate all SD-JWT VC types for PIDs with SD-JWT VC type metadata which will include the same information as the PID Rulebook applicable to the type.</td>
</tr>
<tr>
<td>PID_16</td>
<td>A PID Provider that defines a domestic type SHALL publish information about the type, including all claim identifiers, their definition, presence and encoding format, in an Attestation Rulebook complying with all applicable requirements in <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>.</td>
</tr>
<tr>
<td>PID_17</td>
<td>When issuing a PID compliant with [SD-JWT VC], a PID Provider SHALL include both the attributes and the metadata specified in [CIR 2024/2977] in the PID as claims. <em>Note: This implies that technically speaking, there is no difference between these attributes and metadata.</em></td>
</tr>
<tr>
<td>PID_18</td>
<td>When issuing a PID compliant with [SD-JWT VC], a PID Provider SHALL encode each attribute or metadata in the PID as specified in the tables in <a href="../../annex-3/annex-3.01-pid-rulebook/#52-encoding-of-pid-attributes">Section 5.2 of the PID Rulebook</a>.</td>
</tr>
<tr>
<td>PID_19</td>
<td>When issuing a PID compliant with [SD-JWT VC], a PID Provider SHALL ensure that the value of all attributes and metadata in the PID is valid at the value of the timestamp in the nbf claim, if present. <em>Note: The value of the age-related claims, if present, changes whenever the User to whom the person identification data relates has a relevant birthday. The value of many other attributes will also change over time.</em></td>
</tr>
<tr>
<td>PID_20</td>
<td>When issuing a PID compliant with [SD-JWT VC], a PID Provider SHALL ensure that the date_of_issuance claim, if present, is not later than the value of the timestamp in the nbf claim, if present.</td>
</tr>
<tr>
<td>PID_21</td>
<td>When issuing a PID compliant with [SD-JWT VC], a PID Provider SHALL make all claims (i.e., all top-level properties, all nested properties, and all array entries) selectively disclosable individually, except those claims defined as non-selectively disclosable in [SD-JWT VC].</td>
</tr>
</tbody>
</table>
<h4 id="a234-topic-4-mdl-rulebook">A.2.3.4 Topic 4 - mDL Rulebook</h4>
<h5 id="description_3">Description <!-- omit from toc --></h5>
<p>The mobile driving licence (mDL) Rulebook contains requirements specific
to the mDL use case within the EUDI Wallet ecosystem.</p>
<p>Mobile driving licences are legally specified in the proposed EC
Regulation 2023_127 (4th Driving Licence Regulation). This Regulation
specifies that mDLs must comply with the ISO/IEC 18013-5 standard. It
does not mention any other standards, in particular not [SD-JWT VC].
Consequently, mDLs issued to a Wallet Unit will not be implemented
as [SD JWT VC]- compliant documents. The mDL Rulebook therefore specifies
only an ISO/IEC 18013-5 compliant encoding.</p>
<p>For more information, see Annex 3 - [mDL Rulebook].</p>
<h5 id="hlrs_2">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>mDL_01</td>
<td>mDLs and mDL Providers SHALL comply with all requirements in [mDL Rulebook].</td>
</tr>
</tbody>
</table>
<h4 id="a235-topic-5-wallet-unit-design-guide">A.2.3.5 Topic 5 - Wallet Unit Design Guide</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a236-topic-6-relying-party-authentication-and-user-approval">A.2.3.6 Topic 6 - Relying Party authentication and User approval</h4>
<h5 id="description_4">Description <!-- omit from toc --></h5>
<p>Relying Party authentication is a process whereby a Relying Party proves
its identity to a Wallet Unit, in the context of a transaction in
which the Relying Party requests the Wallet Unit to release some
attributes.</p>
<p>To perform Relying Party authentication, the Wallet Unit verifies a
Relying Party Instance access certificate offered by the entity with which it
communicates, which is called a "Relying Party Instance". Note that
there could be multiple Relying Party Instances for each Relying Party.</p>
<p>The Wallet Unit communicates the outcome of Relying Party authentication to the
User when it requests the User for approval to present the requested attributes.
High-level requirements for User approval are also included in this Topic. If requested by the User, the Wallet Unit also communicates the outcome of the verification of the information in the Relying Party registration certificate or obtained from the Registrar, see
<a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>. The Wallet Unit also informs the User about the outcome
of the evaluation of an embedded disclosure policy, if present, see
<a href="#a2343-topic-43---embedded-disclosure-policies">Topic 43</a>.</p>
<h5 id="hlrs_3">HLRs <!-- omit from toc --></h5>
<p>A. Relying Party authentication</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPA_01</td>
<td>The Wallet Unit used by a User, as well as the Relying Party Instance used by the Relying Party, SHALL implement a mechanism for Relying Party authentication in PID or attestation presentation transactions. This mechanism SHALL: - enable the Wallet Unit to identify and authenticate the Relying Party, - enable the Wallet Unit to verify that the request from the Relying Party was not copied and replayed, - use Relying Party Instance access certificates issued in accordance with [<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>].</td>
</tr>
<tr>
<td>RPA_01a</td>
<td>If a Wallet Unit supports the [W3C Digital Credentials API] for remote presentation flows, it SHALL retain full authority over the process meant in RPA_01. In particular, this process SHALL NOT be handled by a third party, including the browser and the operating system.</td>
</tr>
<tr>
<td>RPA_02</td>
<td>The Commission SHALL ensure that technical specifications for the Relying Party authentication mechanism mentioned in RPA_01 are created both for Wallet Units complying with [ISO/IEC 18013-5] and for Wallet Units complying with [OpenID4VP]. These specifications SHALL comply with applicable requirements in these standards.</td>
</tr>
<tr>
<td>RPA_02a</td>
<td>The technical specifications mentioned in RPA_02 SHALL ensure that a Relying Party Instance includes its access certificates in the presentation request by value, not by reference. <em>Note: This ensures that no external requests are necessary to carry out Relying Party authentication, and that transactions are atomic and self-contained.</em></td>
</tr>
<tr>
<td>RPA_03</td>
<td>A Wallet Unit and a Relying Party Instance SHALL perform Relying Party authentication in all PID or attestation presentation transactions to Relying Parties, whether proximity or remote, using a Relying Party Instance access certificate. <em>Note: The actions both entities perform differ. For example, while the Relying Party creates a signature over some data in the request, the Wallet Unit validates that signature.</em></td>
</tr>
<tr>
<td>RPA_04</td>
<td>For the verification of Relying Party Instance access certificates, a Wallet Unit SHALL accept the trust anchors in the Trusted List(s) of Relying Party Access Certificate Authorities of all Member States. <em>Note: For more information about Relying Party Access Certificate Authorities, please see [<a href="#a2331-topic-31----notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">Topic 31</a>].</em></td>
</tr>
<tr>
<td>RPA_05</td>
<td>If Relying Party authentication fails for any reason, the Wallet Instance SHALL inform the User that the identity of the Relying Party could not be verified and that therefore the request is not trustworthy.</td>
</tr>
<tr>
<td>RPA_06</td>
<td>If Relying Party authentication succeeds, the Wallet Instance SHALL display to the User the name of the Relying Party as included in the Relying Party access certificate, together with the attributes requested by the Relying Party. The Wallet Instance SHALL do so when asking the User for approval according to RPA_07. <em>Note: If the Relying Party is an intermediary acting on behalf of an intermediated Relying Party, the Wallet Instance displays the names of both the intermediary and the intermediated Relying Party to the User, see RPI_07.</em></td>
</tr>
<tr>
<td>RPA_06a</td>
<td>If Relying Party authentication fails for any reason, the Wallet Unit SHALL notify the User. In addition, the Wallet Unit SHALL either not present the requested attributes to the Relying Party, or give the User the choice to present the requested attributes or not. <em>Note: It is up to the Wallet Provider to make a choice for one of these two options.</em></td>
</tr>
</tbody>
</table>
<p>B. User approval</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPA_07</td>
<td>A Wallet Unit SHALL ensure the User approved the release of any attribute(s) in the Wallet Unit to a Relying Party, prior to releasing these attributes. A Wallet Unit SHALL always allow the User to refuse releasing an attribute requested by the Relying Party.</td>
</tr>
<tr>
<td>RPA_07a</td>
<td>If a Wallet Unit supports the [W3C Digital Credentials API] for remote presentation flows, it SHALL retain full authority over the process meant in RPA_07. In particular, this process SHALL NOT be handled by a third party, including the browser and the operating system.</td>
</tr>
<tr>
<td>RPA_08</td>
<td>A Wallet Unit SHALL ensure that (one of) its WSCA(s) has authenticated the User before allowing the User to give or refuse approval for releasing any attributes. <em>Note: See [<a href="#a239-topic-9---wallet-unit-attestation">Topic 09</a>] for information about the WSCA.</em></td>
</tr>
<tr>
<td>RPA_09</td>
<td>A Relying Party SHOULD communicate in the request which attributes are needed for which purpose (use case, service), if this is supported by the protocol used for communication with the Wallet Unit. <em>Notes: - This could be done, for instance, by grouping the attributes and describing the use case, service, or purpose of each group. - The purpose of this recommendation is that a Relying Party makes clear to the User what the intended use, the service being accessed, or the specific purpose is of each requested attribute. For example, a service may legally require attributes for age verification (e.g., birthdate), but the Relying Party may additionally want a User address (e.g., street, location, PObox, country) in order to offer added-value services. Age verification attributes and address attributes should be grouped separately, and the purposes should be clearly distinguished. This allows the User to be better informed about the request, and also allows them to approve one purpose but deny the other; see RPA_10.</em></td>
</tr>
<tr>
<td>RPA_10</td>
<td>If a Wallet Unit receives a request indicating one or more purposes (use cases, services) for requesting attributes, the Wallet Instance SHOULD show these to the User when asking for User approval. Moreover, the Wallet Unit SHOULD ensure that for each purpose, the User gives approval either to release all attributes requested for that purpose, or none of them. <em>Note: This means that a User should either approve the release of all attributes in a given group or to deny the entire group. The Wallet Unit should not allow partial approval within a group. Partial approval would mean that the Relying Party cannot deliver the service, but nevertheless receives some User attributes. This would be a violation of the User's privacy.</em></td>
</tr>
<tr>
<td>RPA_11</td>
<td>When the presentation of an attestation is denied by the User, the Wallet Unit SHALL behave towards the Relying Party as if the attestation did not exist.</td>
</tr>
</tbody>
</table>
<h4 id="a237-topic-7-attestation-revocation-and-revocation-checking">A.2.3.7 Topic 7 - Attestation revocation and revocation checking</h4>
<h5 id="description_5">Description <!-- omit from toc --></h5>
<p>This Topic contains the high-level requirements (HLRs) relating to the
(possible) revocation of PIDs, QEAAs, PuB-EAAs, non-qualified EAAs, and WUAs by
their providers. It also contains HLRs relating to the (possible) checking of
the revocations status of a PID or attestation by a Relying Party.</p>
<p>Note: This Topic does not pertain to access certificates for Relying Parties,
PID Providers, or Attestation Providers as discussed in
[<a href="#a2331-topic-31----notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">Topic 31</a>].
Neither does it apply to any intermediate certificates establishing trust
between these certificates and the respective trust anchors. These access
certificates are part of a Public Key Infrastructure, and rules for revoking
these certificates will be established within the respective PKI.</p>
<h5 id="hlrs_4">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>VCR_01</td>
<td>A PID Provider, QEAA Provider, or PuB-EAA Provider SHALL use one of the following methods for revocation of a PID, QEAA, or PuB-EAA: - Only issue short-lived attestations having a validity period of 24 hours or less, such that revocation will never be necessary, - Use an Attestation Status List mechanism specified per VCR_11, or - Use an Attestation Revocation List mechanism specified per VCR_11. <em>Note: The 24-hour period originates from ETSI EN 319 411-1 V1.4.1, requirement REV-6.2.4-03A. This requires that the process of revocation must take at most 24 hours. Consequently, revocation may make no sense if the attestation is valid for less than 24 hours, because it may reach the end of its validity period before it is revoked.</em></td>
</tr>
<tr>
<td>VCR_01a</td>
<td>A Wallet Provider SHALL use either the second or the third of the methods specified in VCR_01 for revocation of a WUA. <em>Note: Due to requirement WUA_08 in <a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>, it is not possible to issue short-lived WUAs. This implies that all WUAs are revocable.</em></td>
</tr>
<tr>
<td>VCR_02</td>
<td>For non-qualified EAAs, the relevant Rulebook SHALL specify whether that type of EAA must be revocable. If a non-qualified EAA type must be revocable, the relevant Rulebook SHALL determine which of the methods mentioned in VCR_01 must be implemented by the relevant EAA Providers for the revocation of such an EAA.</td>
</tr>
<tr>
<td>VCR_03</td>
<td>If a PID or attestation is revocable, the PID Provider of a given PID, or the Attestation Provider of a given attestation, SHALL be the only party in the EUDI Wallet ecosystem responsible for executing the revocation of that PID or attestation. *Note: A PID Provider, Attestation Provider MAY outsource the operation of the revocation process to a third party.</td>
</tr>
<tr>
<td>VCR_03a</td>
<td>The Wallet Provider of a given WUA SHALL be the only party in the EUDI Wallet ecosystem responsible for executing the revocation of that WUA. <em>Note: A Wallet Provider MAY outsource the operation of the revocation process to a third party.</em></td>
</tr>
<tr>
<td>VCR_04</td>
<td>A PID Provider, Attestation Provider or Wallet Provider that revoked a PID, attestation, or WUA SHALL NOT reverse the revocation.</td>
</tr>
<tr>
<td>VCR_05</td>
<td>If a PID, attestation, or WUA is revocable, the PID Provider, Attestation Provider, or Wallet Provider SHALL have a policy specifying under which conditions a PID, attestation, or WUA it issued will be revoked.</td>
</tr>
<tr>
<td>VCR_06</td>
<td>If a PID, attestation, or WUA is revocable, the PID Provider, Attestation Provider, or Wallet Provider SHALL revoke a PID, attestation, or WUA when its security has been compromised.</td>
</tr>
<tr>
<td>VCR_07</td>
<td>A Wallet Provider SHALL revoke all valid WUAs issued to a Wallet Unit upon the explicit request of the User to revoke their Wallet Unit.</td>
</tr>
<tr>
<td>VCR_07a</td>
<td>If a PID or attestation is revocable, the PID Provider or Attestation Provider SHOULD revoke that PID or attestation upon the explicit request of the User to whom the PID or the attestation was issued.</td>
</tr>
<tr>
<td>VCR_07b</td>
<td>If a PID or attestation is revocable, the PID Provider or Attestation Provider SHOULD revoke that PID if the Wallet Unit on which it resides is revoked, in compliance with requirement WURevocation_18 in <a href="#a2338-topic-38---wallet-unit-revocation">Topic 38</a>.</td>
</tr>
<tr>
<td>VCR_08</td>
<td>If a PID is revocable, the PID Provider SHALL revoke a PID upon the death of the natural person who is the subject of the PID, or the cease of activity of the legal person who is the subject of the PID.</td>
</tr>
<tr>
<td>VCR_09</td>
<td>If a PID, attestation, or WUA is revocable, the PID Provider, Attestation Provider or Wallet Provider SHALL revoke a PID, attestation, or WUA if the value of one or more attributes in the PID, attestation, or WUA was changed (including attributes being added or deleted) and it is still valid for at least 24 hours. Subsequently, if the User's contact details are known, the PID Provider, Attestation Provider, or Wallet Provider SHOULD, via an out-of-band manner, notify the User about the revocation and ask the User to request re-issuance of the PID, attestation, or WUA using their Wallet Unit. <em>Note: If the value of the attributes is determined by a party different from the Provider, such as an Authentic Source, the Provider is responsible for ensuring that this third party notifies them about such changes.</em></td>
</tr>
<tr>
<td>VCR_10</td>
<td>Wallet Providers SHALL implement the attestation revocation mechanisms specified per VCR_11 in their Wallet Solutions.</td>
</tr>
<tr>
<td>VCR_11</td>
<td>The Commission SHALL create or reference technical specifications providing all necessary details for PID Providers, Attestation Providers, and Wallet Providers to implement an Attestation Status List mechanism or an Attestation Revocation List mechanism for the PIDs, attestations, and WUAs they issue. These technical specifications SHALL also contain all details necessary for Relying Party Instances, Relying Parties, and Wallet Units interacting with other Wallet Units to use these mechanisms to verify the revocation status of PIDs, attestations, and WUAs. <em>Note: 'Attestation Status List' and 'Attestation Revocation List' are specific mechanisms, defined in Annex 1. Attestation Revocation Lists are sometimes referred to as 'Identifier Lists'.</em></td>
</tr>
<tr>
<td>VCR_12</td>
<td>If a Relying Party decides it needs to be able to verify the revocation status of PIDs or attestations, it SHALL support both the Attestation Status List mechanism and the Attestation Revocation List mechanism specified per VCR_11. <em>Note: Per VCR_13, it is recommended but not mandatory for a Relying Party to verify whether a PID or attestation is revoked.</em></td>
</tr>
<tr>
<td>VCR_12a</td>
<td>A PID Provider or Attestation Provider SHALL support both the Attestation Status List mechanism and the Attestation Revocation List mechanism specified per VCR_11 for verifying the revocation status of a WUA.</td>
</tr>
<tr>
<td>VCR_13</td>
<td>A Relying Party Instance SHOULD verify the revocation status of a PID or attestation upon obtaining it from a Wallet Unit, following the steps specified per VCR_11.</td>
</tr>
<tr>
<td>VCR_14</td>
<td>When no reliable information regarding the revocation status of a PID or attestation is available, a Relying Party SHOULD perform a risk analysis considering all relevant factors for the use case, before taking a decision to accept or refuse the PID or attestation.</td>
</tr>
<tr>
<td>VCR_15</td>
<td>A Relying Party Instance SHOULD NOT request the relevant Attestation Status List or Attestation Revocation List each time an attestation is presented to it by a Wallet Unit. Rather, the Relying Party operating the Relying Party Instance SHOULD download each new version of the list once, at a time and from a location unrelated to the presentation of a PID or attestation by a User. The Relying Party SHOULD then distribute the list to all of its Relying Party Instances, using an Relying Party-internal distribution mechanism.</td>
</tr>
<tr>
<td>VCR_16</td>
<td>A PID Provider, Attestation Provider or Wallet Provider SHALL NOT require the Relying Party or Relying Party Instance to authenticate itself before downloading an Attestation Status List or Attestation Revocation List.</td>
</tr>
<tr>
<td>VCR_17</td>
<td>When using an Attestation Status List for revocation, the PID Provider, Attestation Provider or Wallet Provider SHALL randomly assign the index for each PID or attestation, to prevent this index from becoming a correlator. <em>Note: Randomly assigning indices within a bitstring or byte array is more complicated than creating random identifiers (e.g. serial numbers) for attestations, as is needed for an Attestation Revocation List. This is because duplicate indices and unnecessarily long bitstrings or byte arrays must be prevented.</em></td>
</tr>
<tr>
<td>VCR_18</td>
<td>When using an Attestation Status List for revocation, the PID Provider, Attestation Provider, or Wallet Provider SHALL represent a sufficiently large number of PIDs, attestations, or WUAs on each Attestation Status List to ensure herd privacy. <em>Note: In this context, herd privacy means that if an entity requests a particular status list, the PID Provider, Attestation Provider, or Wallet Provider is not able to deduce which PID, attestation or WUA (likely) was presented to that entity. </em>Note: Complying with this requirement may be difficult in case the number of PIDs, attestations, or WUAs to be represented on the list is small. In such a case, decoy entries can be added to the list to obfuscate the real number of referenced PIDs, attestations, or WUAs.*</td>
</tr>
<tr>
<td>VCR_19</td>
<td>A Wallet Unit SHOULD regularly check the revocation status of its PIDs, attestations, and WUAs, and notify the User if a PID, attestation, or WUA (i.e, the Wallet Unit itself), is revoked.</td>
</tr>
</tbody>
</table>
<h4 id="a238-topic-8-design-solutions-on-data-sharing-scenarios">A.2.3.8 Topic 8 - Design Solutions on Data Sharing scenarios</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a239-topic-9-wallet-unit-attestation">A.2.3.9 Topic 9 - Wallet Unit Attestation</h4>
<p>Note to this Topic: The Commission received many comments on
the ideas described in this Topic, particularly relating to revocation and
the differing needs of Relying Parties on one side and
PID Providers and Attestation Providers on the other.
Further details on these subjects will be provided in <a href="../../../technical-specifications/ts3-wallet-unit-attestation/">Technical Specification 3</a>
and the high level requirements in Topic 9 intentionally do not go into these technical details.</p>
<p><strong>NOTE: <a href="../../../technical-specifications/ts3-wallet-unit-attestation/">Technical Specification 3</a> is not finalised yet. Discussions on the WUA are ongoing. In particular, no final decision has been taken yet regarding the use of a WUA on the Relying Party interface. Nevertheless, it seems likely that this will not be a possibility, and that a Wallet Unit will send a WUA only to a PID Provider or Attestation Provider during issuance.</strong></p>
<h5 id="description_6">Description <!-- omit from toc --></h5>
<p>When a User's Wallet Unit interacts with other actors
in the EUDI Wallet ecosystem, in particular PID Providers, Attestation Providers,
or Relying Parties, these actors may want to verify if the Wallet Unit is  authentic and has not been revoked.</p>
<p>Furthermore, when a PID Provider or Attestation Provider receives a request from a
User to issue a PID or attestation to the User's Wallet Unit,
the PID Provider or Attestation Provider needs to decide whether it can
comply with this request. To determine this, the PID Provider or
Attestation Provider needs to know (among other things) if the Wallet
Unit offers the functional capabilities required by the PID Provider
or Attestation Provider in its PID or attestation issuing policy. In
addition, the PID Provider or Attestation Provider needs to know if the
Wallet Secure Cryptographic Application(s) (WSCA) and the corresponding
Wallet Secure Cryptographic Device(s) (WSCD) that are part of the Wallet Unit
offer the required level of security. Therefore, the PID Provider or
Attestation Provider needs to receive trustworthy information about
these capabilities and security posture.</p>
<p>This Topic introduces an information object that contains the necessary
information to allow PID Providers and Attestation Provider to verify if he Wallet Unit is  authentic and has not been revoked, and that also contains the information needed by the Provider to take a decision on issuance. This object is called the Wallet Unit
Attestation (WUA). The WUA also contains a public key. By including this public
key in the WUA, the Wallet Provider attests that the corresponding private key is
protected by a certified WSCA/WSCD that has the properties and security posture
described in the WUA. The PID Provider or Attestation Provider then asks the Wallet Unit to create a key
pair for its new PID or attestation, and to prove that both this new private key and the
private key corresponding to public key in the WUA are in possession of the Wallet Unit.</p>
<p>A topic related to the WUA is the following. It would be useful for the Wallet Unit to be able to provide a proof that the PID or attestation private key is protected by the same WSCA/WSCD as the WUA private
key. Because if that is the case, the PID Provider or Attestation Provider can be sure that the security level of the new PID or attestation key is the same as the security level of the WUA key. A mechanism for providing such a proof is discussed in <a href="#a2318-topic-18---combined-presentations-of-attributes">Topic 18</a>, where it is used to give assurance to a Relying Party that multiple attestations originate from the same WSCA/WSCD and thus are related to the same User. The same mechanism could also be used here.</p>
<h5 id="hlrs_5">HLRs <!-- omit from toc --></h5>
<h6 id="a-support-for-wua-use-cases">A.  Support for WUA Use Cases <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WUA_01</td>
<td>The WUA SHALL provide a PID Provider or Attestation Provider with information about the capabilities of the WSCA and WSCD of the Wallet Unit, such that they are able to take a well-grounded decision on whether to issue a PID or attestation to the Wallet Unit.</td>
</tr>
<tr>
<td>WUA_02</td>
<td>The WUA SHALL enable PID Providers and Attestation Providers to verify the authenticity and revocation status of the Wallet Unit.</td>
</tr>
<tr>
<td>WUA_03</td>
<td>A Wallet Provider SHALL ensure that a non-revoked Wallet Unit at all times can present a WUA, when requested by a PID Provider or Attestation Provider.</td>
</tr>
<tr>
<td>WUA_04</td>
<td>Empty</td>
</tr>
<tr>
<td>WUA_05</td>
<td>During PID or attestation issuance, a Wallet Unit SHALL retrieve the requirements of the PID Provider or Attestation Provider regarding User authentication and key storage by the WSCA/WSCD from the Issuer metadata (as specified in [OpenID4VCI]). The Wallet Unit SHALL determine which of its WSCA/WSCD(s), if any, comply with these requirements. If a compliant WSCA/WSCD is available to the Wallet Unit, the Wallet Unit SHALL request it to generate a new key pair for the new PID or attestation. The Wallet Unit SHALL provide the PID Provider or Attestation Provider with the WUA describing the properties of the WSCA/WSCD that generated the new PID or attestation private key.</td>
</tr>
<tr>
<td>WUA_06</td>
<td>If a Wallet Unit contains multiple WSCAs, it SHALL, internally and securely, keep track of which PIDs and attestations are bound to which WSCA.</td>
</tr>
<tr>
<td>WUA_07</td>
<td>A Wallet Unit SHALL present a WUA only as part of the issuance of a PID or an attestation.</td>
</tr>
<tr>
<td>WUA_08</td>
<td>The WUA SHALL enable PID Providers to request a Wallet Provider to revoke a Wallet Unit, in accordance with requirement WURevocation_11, by including an identifier for the Wallet Unit in the WUA. The Wallet Provider SHALL ensure that this Wallet Unit identifier does not enable tracking of the User. <em>Notes: - This is a legal requirement from [CIR 2024/2977]. See also <a href="../../../architecture-and-reference-framework-main/#6534-wallet-provider-issues-one-or-more-wallet-unit-attestations-to-the-wallet-unit">Section 6.5.3.4 of the ARF main document</a>. - The Wallet Unit identifier meant here can be the same as the one used for revoking the WUA, for instance a URI and index to an Attestation Status List (see <a href="#a237-topic-7---attestation-revocation-and-revocation-checking">Topic 7</a>).</em></td>
</tr>
</tbody>
</table>
<h6 id="b-wua-in-relation-cryptographic-keys">B.  WUA in relation Cryptographic Keys <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WUA_09</td>
<td>A WUA SHALL contain a public key, and the corresponding private key SHALL be generated by the WSCA/WSCD described in the WUA.</td>
</tr>
<tr>
<td>WUA_10</td>
<td>Empty (moved to <a href="#a2318-topic-18---combined-presentations-of-attributes">Topic 18</a>)</td>
</tr>
<tr>
<td>WUA_11</td>
<td>During PID or attestation issuance, the PID Provider or Attestation Provider SHALL verify that the WSCA/WSCD described in the WUA received from the Wallet Unit has proven possession of the private key corresponding to the public key in the WUA.</td>
</tr>
<tr>
<td>WUA_11a</td>
<td>During PID or attestation issuance, the PID Provider or Attestation Provider SHALL verify that a WSCA/WSCD has proven possession of the new PID or attestation private key.</td>
</tr>
<tr>
<td>WUA_11b</td>
<td>During PID or attestation issuance, the PID Provider or Attestation Provider SHOULD verify a proof of cryptographic binding generated by the WSCA/WSCD per requirement ACP_01, if present, to verify that the new PID or attestation private key is managed by the same WSCA/WSCD as the WUA private key. <em>Note: The three proofs mentioned in WUA_11, WUA_11a and WUA_11b MAY be implemented as a single cryptographic proof.</em></td>
</tr>
<tr>
<td>WUA_12</td>
<td>The Wallet Unit SHALL be able to prove that it possesses the private key corresponding to the public key in the WUA.</td>
</tr>
<tr>
<td>WUA_13</td>
<td>Empty</td>
</tr>
<tr>
<td>WUA_14</td>
<td>Empty (moved to <a href="#a2318-topic-18---combined-presentations-of-attributes">Topic 18</a>)</td>
</tr>
<tr>
<td>WUA_15</td>
<td>Empty</td>
</tr>
<tr>
<td>WUA_16</td>
<td>If a WSCA/WSCD is able to export a private key, the Wallet Provider SHALL specify this capability as an attribute in the WUA.</td>
</tr>
</tbody>
</table>
<h6 id="c-requirements-regarding-privacy">C.  Requirements regarding privacy <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WUA_17</td>
<td>A Wallet Provider SHALL consider all relevant factors, including offline usage, interoperability, and the risk of a WUA becoming a vector to track the User, when deciding on the validity period of a WUA. <em>Regarding interoperability, see ISSU_12c, which limits the validity period of PIDs issued based on the validity period of the WUA.</em></td>
</tr>
<tr>
<td>WUA_18</td>
<td>A Wallet Unit SHALL release a WUA only to a PID Provider or Attestation Provider, and not to a Relying Party or any other entity.</td>
</tr>
</tbody>
</table>
<h6 id="d-miscellaneous-requirements">D.  Miscellaneous requirements <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WUA_19</td>
<td>Empty</td>
</tr>
<tr>
<td>WUA_20</td>
<td>A Wallet Provider SHALL ensure that its Wallet Units comply with all relevant requirements specified in <a href="../../../technical-specifications/ts3-wallet-unit-attestation/">Technical Specification 3</a>.</td>
</tr>
<tr>
<td>WUA_20a</td>
<td>A PID Provider or Attestation Provider SHALL comply with all relevant requirements specified in <a href="../../../technical-specifications/ts3-wallet-unit-attestation/">Technical Specification 3</a>.</td>
</tr>
<tr>
<td>WUA_21</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<h4 id="a2310-topic-10-issuing-a-pid-or-attestation-to-a-wallet-unit">A.2.3.10 Topic 10 - Issuing a PID or attestation to a Wallet Unit</h4>
<h5 id="description_7">Description <!-- omit from toc --></h5>
<p>PID Providers and Attestation Providers issue PIDs and attestations to
Wallet Units. This Topic lists the high-level technical
requirements related to PID and attestation issuance.</p>
<p>This Topic also contains the high-level requirements for <a href="#a2323-topic-23---pid-issuance-and-qeaa-issuance">Topic 23</a>.</p>
<h5 id="hlrs_6">HLRs <!-- omit from toc --></h5>
<h6 id="a-generic-hlrs_1">A - Generic HLRs <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_01</td>
<td>Wallet Providers SHALL ensure that their Wallet Solution supports the OpenID4VCI protocol specified in [OpenID4VCI], as profiled by the 'OpenID for Verifiable Credential Issuance' profile specified in [HAIP], and with additions and changes as documented in this Annex (see e.g. this Topic and [<a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>]) and in future technical specifications created by or on behalf of the Commission.</td>
</tr>
<tr>
<td>ISSU_01a</td>
<td>PID Providers and Attestation Providers SHALL support the OpenID4VCI protocol specified in [OpenID4VCI], as profiled by the 'OpenID for Verifiable Credential Issuance' profile specified in [HAIP], and with additions and changes as documented in this Annex (see e.g. this Topic and [<a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>]) and in future technical specifications created by or on behalf of the Commission.</td>
</tr>
<tr>
<td>ISSU_02</td>
<td>Wallet Providers SHALL ensure that their Wallet Solution supports the attestation formats specified in ISO/IEC 18013-5, see [ISO18013-5], and in "SD-JWT-based Verifiable Credentials (SD-JWT VC)", see [SD-JWT-VC], with additions and changes as documented in this Annex and in future technical specifications created by or on behalf of the Commission.</td>
</tr>
<tr>
<td>ISSU_03</td>
<td>Wallet Units, PID Providers, and Attestation Providers SHALL support the [W3C Digital Credentials API]](<a href="https://wicg.github.io/digital-credentials/">https://wicg.github.io/digital-credentials/</a>) for issuance of PIDs and attestations, provided that a) this API is fully standardised, b) this API complies with the expectations outlined in <a href="../../../discussion-topics/f-digital-credential-api/#3">Chapter 3</a> of the Topic F discussion paper, and c) this API is broadly supported by relevant browsers and operating systems.</td>
</tr>
<tr>
<td>ISSU_04</td>
<td>The OpenID4VCI protocol referenced in requirement ISSU_01, or an EUDI Wallet-specific extension or profile thereof, SHALL enable PID Providers and Attestation Provider to issue to a Wallet Unit a batch of multiple PIDs or attestations that are simultaneously valid and contain the same attributes.</td>
</tr>
<tr>
<td>ISSU_05</td>
<td>A Wallet Unit SHALL support a process to activate a newly issued PID, in accordance with the requirements for LoA High in <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32015R1502">Commission Implementing Regulation (EU) 2015/1502</a> Section 2.2.2. The Wallet Unit SHALL NOT allow a User to use a non-activated PID. <em>Notes: - The goal of the activation process is to verify that the PID was delivered into the Wallet Unit and WSCA/WSCD of the User who is the subject of the PID. - This requirement is not applicable for QEAAs, PuB-EAAs or non-qualified EAAs, since these are not identity means in the sense of Commission Implementing Regulation (EU) 2015/1502.</em></td>
</tr>
<tr>
<td>ISSU_06</td>
<td>After a Wallet Unit receives a PID or an attestation from a PID Provider or Attestation Provider, it SHALL verify that the PID or attestation it received matches the PID or attestation requested by the Wallet Unit.</td>
</tr>
<tr>
<td>ISSU_07</td>
<td>After a Wallet Unit receives a PID from a PID Provider, it SHALL validate the signature of the PID using a trust anchor provided in a PID Provider Trusted List made available in accordance with <a href="#a2331-topic-31----notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">Topic 31</a>. <em>Note: This signature validation may not be useful in architectures where the Wallet Provider is also the PID Provider and the validation of the PID signature would be done by the same component (namely, a remote HSM) that created the signature. However, in such a situation, additional measures SHALL be taken to ensure that any errors in the PID issuance process will be detected.</em></td>
</tr>
<tr>
<td>ISSU_08</td>
<td>After a Wallet Unit receives a QEAA from a QEAA Provider, it SHALL validate the qualified signature of the QEAA in accordance with Art.32 of the [European Digital Identity Regulation]. For the verification, the Wallet Unit SHALL use a trust anchor provided in a QEAA Provider Trusted List made available in accordance with <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv%3AOJ.L_.2014.257.01.0073.01.ENG#d1e2162-73-1">Art. 22</a> of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ISSU_09</td>
<td>After a Wallet Unit receives a PuB-EAA from a PUB-EAA Provider, it SHALL validate the qualified signature of the PuB-EAA in accordance with Art.32 of the [European Digital Identity Regulation]. For that verification, the Wallet Unit SHALL use the public key provided in the qualified certificate of the QTSP supporting the qualified signature. The Wallet Unit SHALL also validate the qualified certificate of the QTSP using a trust anchor provided in a Trusted List made available in accordance with <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv%3AOJ.L_.2014.257.01.0073.01.ENG#d1e2162-73-1">Art. 22</a> of the [European Digital Identity Regulation]. Finally, the Wallet Unit SHALL also verify the certified attributes of the qualified certificate, as specified in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e3902-1-1">Article 45f</a>.</td>
</tr>
<tr>
<td>ISSU_10</td>
<td>After a Wallet Unit receives a non-qualified EAA from an EAA Provider, it SHALL validate the signature of the EAA using a trust anchor provided according to the mechanism(s) specified in the applicable Rulebook, see [<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>]. <em>Notes: - Requirements ISSU_07 to ISSU_10 are equivalent to requirements OIA_12 to OIA_15 in <a href="#a231-topic-1---accessing-online-services-with-a-wallet-unit">Topic 1</a>. These requirements imply that a Wallet Instance must be aware whether the attestation it is requesting from an issuer is a PID, a QEAA, a PuB-EAA, or a non-qualified EAA. These requirements also imply that the Wallet Unit must store trust anchors in such a way that, when it receives an issued attestation, it is able to distinguish between trust anchors usable either for PIDs, for QEAAs, for PuB-EAAs, or for non-qualified EAAs. - PID Providers, QEAA Providers, and PuB-EAA Providers are trusted by other actors in the EUDI Wallet ecosystem to not fraudulently issue attestations (or PIDs) that they are not legally allowed to issue. This trust is warranted since these kinds of providers operate within a regulated framework and are regularly audited. However, non-qualified EAA Providers are unregulated and may not be completely trustworthy. Therefore, before requesting an non-qualified attestation, a Wallet Unit may need to verify that the non-qualified EAA Provider is authorised or registered to issue this type of attestation. Mechanisms allowing to do this may be defined in the applicable Rulebook, see ARB_26.</em></td>
</tr>
<tr>
<td>ISSU_11</td>
<td>A Wallet Unit SHALL request the User's approval before storing a PID or attestation obtained from a PID Provider or Attestation Provider. When requesting approval, the Wallet Instance SHALL display the contents of the PID or attestation to the User. The Wallet Instance SHALL also inform the User about the identity of the PID Provider or Attestation Provider, using the subject information in the PID Provider's or Attestation Provider's access certificate.</td>
</tr>
<tr>
<td>ISSU_11b</td>
<td>In case one or more of the verifications in ISSU_06 - ISSU_11 fail, the Wallet Unit SHALL immediately delete the PID or attestation it received. The Wallet Instance SHALL notify the User about the fact that issuance of the PID or attestation was not successful, including the reason for this failure.</td>
</tr>
<tr>
<td>ISSU_12</td>
<td>A PID Provider or Attestation Provider SHALL offer its PIDs or attestations in all formats required in the PID Rulebook or the applicable Attestation Rulebook, see [<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>]. <em>Note: Examples include the mdoc format specified in [ISO/IEC 18013-5] and the SD-JWT VC-format specified in [SD-JWT VC].</em></td>
</tr>
<tr>
<td>ISSU_12a</td>
<td>A Wallet Provider SHALL ensure that, when a User instructs their Wallet Unit to request a PID or attestation from a PID Provider or Attestation Provider, the Wallet Unit requests that PID or attestation in all formats offered by the PID Provider or Attestation Provider. <em>Note: Examples include the mdoc format specified in [ISO/IEC 18013-5] and the SD-JWT VC-format specified in [SD-JWT VC].</em></td>
</tr>
<tr>
<td>ISSU_12b</td>
<td>During PID or attestation issuance, a WSCA/WSCD SHALL generate a new key pair for a new PID or attestation, on request of the PID Provider or Attestation Provider via the Wallet Instance. <em>Note: In case of synchronous issuing in a remote HSM architecture, re-use of an existing key pair for the new PID or attestation may be acceptable and it may not be necessary to generate a new key pair for each new PID or attestation.</em></td>
</tr>
<tr>
<td>ISSU_12c</td>
<td>The expiration date of a PID SHALL be no later than the expiration date of the WUA presented as part of the PID issuance process. <em>Note: This requirement is an implication of WURevocation_18 in <a href="#a2338-topic-38---wallet-unit-revocation">Topic 38</a>. If the PID would be valid for longer than the WUA, the PID Provider would not be able to use the revocation information in the WUA to verify the revocation status of the Wallet Unit.</em></td>
</tr>
<tr>
<td>ISSU_12d</td>
<td>If an Attestation Provider supports revocation chaining for its attestations per WURevocation_19 in <a href="#a2338-topic-38---wallet-unit-revocation">Topic 38</a>, the expiration date of an attestation SHALL be no later than the expiration date of the WUA presented as part of the attestation issuance process. <em>Note: See note in ISSU_12c.</em></td>
</tr>
</tbody>
</table>
<h6 id="b-hlrs-for-pid-issuance">B - HLRs for PID issuance <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_13</td>
<td>A Wallet Provider SHALL ensure that at least one PID Provider is willing to issue a PID complying with [PID Rulebook] to Users of the Wallet Units it provides.</td>
</tr>
<tr>
<td>ISSU_14</td>
<td>A PID Provider SHALL ensure that all PIDs it issues to Wallet Units comply with the requirements specified in [PID Rulebook].</td>
</tr>
<tr>
<td>ISSU_15</td>
<td>A PID Provider SHALL support the OpenID4VCI protocol referenced in ISSU_01 for issuing PIDs.</td>
</tr>
<tr>
<td>ISSU_16</td>
<td>Empty</td>
</tr>
<tr>
<td>ISSU_17</td>
<td>A PID Provider SHALL implement device binding for all PIDs it issues, meaning it SHALL ensure that a PID is cryptographically bound to a WSCA/WSCD included in the Wallet Unit, as specified in requirement WUA_11 in [<a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>]. <em>Notes: - Device binding is called 'mdoc authentication' in [ISO/IEC 18013-5] and 'key binding' in [SD-JWT-VC]. - Discussions on device binding are ongoing, in particular regarding whether non-device-bound PIDs or attestations should be supported by a Wallet Unit, and if so, what the requirements for this support should be.</em></td>
</tr>
<tr>
<td>ISSU_18</td>
<td>A PID Provider SHALL verify the identity of the subject of the PID in compliance with Level of Assurance (LoA) High requirements. <em>Note: These requirements will be determined by the relevant eID scheme.</em></td>
</tr>
<tr>
<td>ISSU_18a</td>
<td>A PID Provider SHALL ensure that the attributes attested in the PID issued are valid for the identified PID subject at any point of time of PID validity.</td>
</tr>
<tr>
<td>ISSU_19</td>
<td>For the verification of a WUA, a PID Provider SHALL accept the trust anchors in the Wallet Provider Trusted List it needs. <em>Notes: - The Wallet Provider Trusted List is explained in [<a href="#a2331-topic-31----notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">Topic 31</a>]. - It is not mandatory for a PID Provider to accept all Wallet Provider Trusted Lists, if there are multiple. This is because it is not mandatory for a PID Provider to accept all certified Wallet Solutions in the EUDI Wallet ecosystem. Each PID Provider will choose which Trusted Lists they need to subscribe to.</em></td>
</tr>
<tr>
<td>ISSU_19a</td>
<td>A PID Provider SHALL support at least one Wallet Solution, meaning that it is willing and able to issue a PID to a Wallet Unit on request of the User.</td>
</tr>
<tr>
<td>ISSU_20</td>
<td>To inform its potential PID subjects about the Wallet Solution(s) they can use for requesting a PID, a PID Provider SHALL publish a list of supported Wallet Solutions in such a way that it can be easily found, for example on the PID Provider's website.</td>
</tr>
<tr>
<td>ISSU_21</td>
<td>Before issuing a PID, a PID Provider SHALL verify that the Wallet Provider mentioned in the Wallet Unit's WUA is present in a Wallet Provider Trusted List. The PID Provider SHALL also authenticate and validate the WUA using the trust anchor(s) registered for the Wallet Provider in the Wallet Provider Trusted List. Moreover, it SHALL verify that the Wallet Units's WUA is not revoked. <em>Notes: - For the WUA, see [<a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>] and [<a href="#a2338-topic-38---wallet-unit-revocation">Topic 38</a>]. - <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX:32024R2977">CIR 2024/2977</a>, Article 3 (9), also allows "another authentication mechanism in accordance with an electronic identity scheme notified at assurance level high." However, the ARF does not further specify such other authentication mechanisms, which means that in general they will not be interoperable.</em></td>
</tr>
<tr>
<td>ISSU_22</td>
<td>A PID Provider SHALL include its PID Provider access certificate in its Issuer metadata used in the common OpenID4VCI protocol referenced in ISSU_01.</td>
</tr>
<tr>
<td>ISSU_22a</td>
<td>A PID Provider SHALL sign its metadata (as defined in OpenID4VCI) using the private key corresponding to its PID Provider access certificate.</td>
</tr>
<tr>
<td>ISSU_22b</td>
<td>The common OpenID4VCI protocol referenced in requirement ISSU_01, or an EUDI Wallet-specific extension or profile thereof, SHALL enable a PID Provider or Attestation Provider to include its access certificate in its Issuer metadata, according to requirement ISSU_22.</td>
</tr>
<tr>
<td>ISSU_23</td>
<td>For the verification of PID Provider access certificates, a Wallet Unit SHALL accept the trust anchors in the Trusted List(s) of Access Certificate Authorities it needs. <em>Notes: - Access Certificate Authority Trusted Lists are explained in [<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>]. -It is not mandatory for a Wallet Unit to accept all Access Certificate Authority Trusted Lists, if there are multiple. Wallet Providers will choose which Trusted Lists they need to subscribe to, for example depending on the Member State(s) they are operating in.</em></td>
</tr>
<tr>
<td>ISSU_23a</td>
<td>A Wallet Provider SHALL support at least one PID Provider, meaning that its Wallet Units SHALL be capable of requesting the issuance of a PID from these PID Provider(s), and that the Wallet Provider has agreed with the PID Provider(s) that the PID Provider(s) will process such a request according to the agreed rules and procedures.</td>
</tr>
<tr>
<td>ISSU_23b</td>
<td>Prior to or during installation of a Wallet Instance, the Wallet Provider SHALL notify the User about the PID Provider(s) that are supported by the Wallet Unit.</td>
</tr>
<tr>
<td>ISSU_24</td>
<td>A Wallet Unit SHALL authenticate and validate the PID Provider access certificate before requesting the issuance of a PID. The Wallet Unit SHALL verify that the access certificate is authentic and is valid at the time of validation, and that the issuer of the access certificate is a CA that is in a Access Certificate Authority Trusted List.</td>
</tr>
<tr>
<td>ISSU_24a</td>
<td>Before requesting the issuance of a PID, the Wallet Unit SHALL verify that the PID Provider is indeed a registered PID Provider. The Wallet Unit SHALL do so using information contained in the PID Provider registration certificate, if available. If the registration certificate is not available, the Wallet Unit SHALL use the URL of the Registrar's online service, contained in the PID Provider access certificate, to obtain the necessary information from the Registrar. If the registered information does not confirm that the PID Provider is indeed properly registered as a PID Provider, the Wallet Unit SHALL display a warning to the User, and SHALL NOT request the issuance of a PID.</td>
</tr>
</tbody>
</table>
<h6 id="c-hlrs-for-attestation-issuance">C - HLRs for Attestation Issuance <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_25</td>
<td>An Attestation Provider SHALL ensure all attestations issued to Wallet Units comply with the requirements specified in the applicable Rulebook, as described in [<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>].</td>
</tr>
<tr>
<td>ISSU_26</td>
<td>An Attestation Provider SHALL support the OpenID4VCI protocol referenced in ISSU_01 for issuing attestations.</td>
</tr>
<tr>
<td>ISSU_27</td>
<td>An Attestation Provider SHALL implement device binding for all attestations it issues, meaning it SHALL ensure that an attestation is cryptographically bound to a WSCA/WSCD included in the Wallet Unit, as specified in requirement WUA_11 in [<a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>]. <em>Notes: -Device binding is called 'mdoc authentication'  in [ISO/IEC 18013-5] and 'key binding' in [SD-JWT-VC]. - Discussions on device binding are ongoing, in particular regarding whether non-device-bound PIDs or attestations should be supported by a Wallet Unit, and if so, what the requirements for this support should be.</em></td>
</tr>
<tr>
<td>ISSU_27a</td>
<td>If the subject of the attestation is a natural person, an Attestation Provider SHALL verify the identity of the subject of the attestation, in compliance with applicable requirements and in accordance with relevant standards or Implementing Regulations. <em>Note: Not every attestation has a natural person as its subject. For example, a holiday voucher may be valid for any User that can present it to a Relying Party and therefore has no subject. This is comparable to the concept of a 'bearer token'.</em></td>
</tr>
<tr>
<td>ISSU_27b</td>
<td>If applicable, an Attestation Provider SHALL ensure that the attributes attested in the attestation issued are valid for the identified attestation subject.</td>
</tr>
<tr>
<td>ISSU_27c</td>
<td>The Attestation Provider SHALL verify that the User requesting the attestation has the right to receive it.</td>
</tr>
<tr>
<td>ISSU_28</td>
<td>For the verification of a WUA, an Attestation Provider SHALL accept the trust anchors in the Wallet Provider Trusted List. <em>Note: The Wallet Provider Trusted List is explained in [<a href="#a2331-topic-31----notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">Topic 31</a>].</em></td>
</tr>
<tr>
<td>ISSU_29</td>
<td>An Attestation Provider SHALL support all Wallet Solutions, except in case the attestation in question is a Strong User Authentication (SUA) attestation as meant in <a href="#a2320-topic-20---strong-user-authentication-for-electronic-payments">Topic 20</a> and the Wallet Provider does not support processing of the transactional data associated with the SUA attestation. Except for such cases, an Attestation Provider SHALL NOT discriminate between Wallet Solutions when processing a request for the issuance of an attestation.</td>
</tr>
<tr>
<td>ISSU_30</td>
<td>Before issuing an attestation, an Attestation Provider SHALL: - verify that the Wallet Provider mentioned in the Wallet Unit's WUA is present in the Wallet Provider Trusted List. - authenticate and validate the WUA using the trust anchor(s) registered for the Wallet Provider in the Wallet Provider Trusted List. - verify that the Wallet Unit's WUA is not revoked. <em>Note: For the WUA, see [<a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>] and [<a href="#a2338-topic-38---wallet-unit-revocation">Topic 38</a>].</em></td>
</tr>
<tr>
<td>ISSU_31</td>
<td>Empty</td>
</tr>
<tr>
<td>ISSU_32</td>
<td>An Attestation Provider SHALL include its Attestation Provider access certificate and registration certificate(s) in its Issuer metadata used in the common OpenID4VCI protocol referenced in ISSU_01.</td>
</tr>
<tr>
<td>ISSU_32a</td>
<td>An Attestation Provider SHALL sign its metadata (as defined in OpenID4VCI) using the private key corresponding to its Attestation Provider access certificate.</td>
</tr>
<tr>
<td>ISSU_33</td>
<td>For the verification of Attestation Provider access certificates, a Wallet Unit SHALL accept the trust anchors in all applicable Access Certificate Authority Trusted List(s). <em>Note: Access Certificate Authority Trusted Lists are explained in [<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>]. There may be separate Access Certificate Authority Trusted Lists for QEAA Providers, PuB-EAA Providers, and EAA Providers.</em></td>
</tr>
<tr>
<td>ISSU_33a</td>
<td>For the verification of Attestation Provider registration certificates, a Wallet Unit SHALL accept the trust anchors in all Trusted List(s) for Providers of registration certificates.</td>
</tr>
<tr>
<td>ISSU_33b</td>
<td>A Wallet Provider SHALL support all Attestation Providers, except possibly if the attestation in question is a Strong User Authentication (SUA) attestation as meant in <a href="#a2320-topic-20---strong-user-authentication-for-electronic-payments">Topic 20</a> and the Wallet Provider chooses to not support processing of the transactional data associated with that attestation. Except for such cases, Wallet Units SHALL be capable of requesting the issuance of a QEAA, PuB-EAA, or non-qualified EAA from all Attestation Providers at the User's request.</td>
</tr>
<tr>
<td>ISSU_34</td>
<td>A Wallet Unit SHALL authenticate and validate the Attestation Provider access certificate before requesting the issuance of an attestation. The Wallet Unit SHALL verify that the access certificate is authentic and is valid at the time of validation, and that the issuer of the access certificate is a CA that is in an Access Certificate Authority Trusted List, as documented in [<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>].</td>
</tr>
<tr>
<td>ISSU_34a</td>
<td>Before requesting the issuance of an attestation, the Wallet Unit SHALL verify that the Attestation Provider is a registered QEAA Provider, PuB-EAA Provider, or EAA Provider. The Wallet Unit SHALL also verify the Provider's entitlements, i.e., whether the Provider properly registered for the issuance of the type of attestation that the User wants to obtain. The Wallet Unit SHALL do these checks using information contained in the Attestation Provider registration certificate, if available. If the registration certificate is not available, the Wallet Unit SHALL use the URL of the Registrar's online service, contained in the Attestation Provider access certificate, to obtain such information. If the registered information does not confirm that the Provider is registered as a QEAA Provider, PuB-EAA Provider, or EAA Provider, or if the registered information does not confirm that the Provider registered for the relevant type of attestation, the Wallet Unit SHALL display a warning to the User, and SHALL NOT request the issuance of an attestation.</td>
</tr>
</tbody>
</table>
<h6 id="d-hlrs-for-privacy-risks-and-mitigation">D - HLRs for Privacy Risks and Mitigation <!-- omit from toc --></h6>
<p>These HLRs were added as a result of the discussions of Topic A,
Privacy risks and mitigation. For more background information on these
requirements, please refer to
<a href="../../../architecture-and-reference-framework-main/#7435-risks-and-mitigation-measures-related-to-user-privacy">Section 7.4.3.5 of the ARF main document</a> and to the <a href="../../../discussion-topics/a-privacy-risks-and-mitigations/">Discussion Paper for Topic A</a>.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_35</td>
<td>A PID Provider or Attestation Provider SHALL ensure that all unique elements in a PID or attestation have values that are unique across all PIDs or attestations issued by that Provider. This SHALL include at least a) the salt used for hashing every attribute, b) the hash values of all attributes, c) the attestation identifier or index used for revocation purposes (if applicable), d) the attestation public key used for device binding, and e) the value of the Attestation Provider signature.  <em>Notes: - The list of unique elements is based on [ISO/IEC 18013-5] and [SD-JWT VC]. - This requirement can be achieved, for example, by ensuring that salt values, indexes and attestation identifiers are pseudo-random numbers generated by a cryptographically secure pseudo-random number generator (CSPRNG).</em></td>
</tr>
<tr>
<td>ISSU_35a</td>
<td>A Wallet Provider SHALL ensure that all unique elements in a WUA have values that are unique across all WUAs issued by that Wallet Provider. This SHALL include at least a) the attestation identifier or index used for revocation purposes, b) the WUA public key used for device binding, and c) the value of the Wallet Provider signature.  <em>Note: The list of unique elements is based on <a href="../../../technical-specifications/ts3-wallet-unit-attestation/">Technical Specification 3</a>.</em></td>
</tr>
<tr>
<td>ISSU_35b</td>
<td>After issuing a PID, attestation, or WUA, a PID Provider, Attestation Provider or Wallet Provider SHALL discard the values of all unique elements, including at least the ones mentioned in requirement ISSU_35 or ISSU_35a (as applicable) above, as well as any timestamps, as soon as they are no longer needed. The Provider SHALL NOT communicate these values to any other party inside or outside the EUDI Wallet ecosystem.</td>
</tr>
<tr>
<td>ISSU_36</td>
<td>When issuing PIDs, attestations, or WUAs in a batch to a Wallet Unit, a PID Provider, Attestation Provider, or Wallet Provider SHALL ensure that the timestamps in these PIDs, attestations, or WUAs do not enable Relying Parties to conclude that they are part of the same batch (and therefore belong to the same User). <em>Note: This can be done, for example, by making timestamps sufficiently imprecise that a high number of batches, each issued to a different Wallet Unit, share the same timestamp values (herd privacy).</em></td>
</tr>
<tr>
<td>ISSU_37</td>
<td>A Wallet Provider SHALL ensure that its Wallet Solution supports the following methods for limiting the number of times a User can present the same PID or attestation to Relying Parties: Method A (Once-only attestations, as specified in requirement ISSU_43 - ISSU_47) and Method B (Limited-time attestations, as specified in requirement ISSU_48 - ISSU_50). In addition, a Wallet Provider MAY ensure that its Wallet Solution supports Method C (Rotating-batch attestations, as specified in requirement ISSU_51 - ISSU_54) or Method D (Per-Relying Party attestations, as specified in requirement ISSU_55 - ISSU_57). <em>Note: Wallet Solutions, PID Providers, Attestation Providers, and Wallet Providers are free to define and use other methods as well. However, such other methods are out of scope of the ARF.</em></td>
</tr>
<tr>
<td>ISSU_38</td>
<td>A PID Provider, Attestation Provider, or Wallet Provider SHALL have a policy describing which of the methods A, B, C, or D, it will use to limit the number of times a Wallet Unit may present a single PID, attestation, or WUA. For each supported method, the policy SHALL also specify how the values for respective parameters for that method, such as technical validity period and batch size, will be chosen. The goal of the policy SHALL be to ensure that the risk of linkability is mitigated to an acceptable level, given the (expected) usage of the PID, attestation, or WUA by the User. To determine what an acceptable level of risk is, the PID Provider, Attestation Provider, or Wallet Provider SHALL carry out a risk analysis regarding linkability. <em>Notes: If an Attestation Provider issues multiple attestation types, these requirements apply for each type of attestation separately.</em></td>
</tr>
<tr>
<td>ISSU_39</td>
<td>The Commission SHALL create or reference a profile or extension of the OpenID4VCI specification enabling a PID Provider, Attestation Provider, or Wallet Provider to indicate in their OpenID4VCI Issuer metadata which of the methods A, B, C, or D the Wallet Unit must use for the PID, attestation, or WUA issued. Indicated methods SHALL be ordered by preference. This profile or extension SHALL also enable the PID Provider, Attestation Provider, or Wallet Provider to set the value of parameters to be used by the Wallet Unit for each method (if applicable). <em>Note: For example, the parameters to be set for method A include the lower limit for unused attestations and the batch size to be requested.</em></td>
</tr>
<tr>
<td>ISSU_40</td>
<td>PID Providers, Attestation Providers, and Wallet Providers SHALL indicate in their OpenID4VCI Issuer metadata at least that either method A or method B must be used for a given type of PID, attestation, or WUA. PID Providers, Attestation Providers, and Wallet Providers MAY additionally indicate that it prefers using method C and/or method D over method A or method B. In such a case, a Wallet Unit supporting method C and/or method D SHALL use that method, while a Wallet Unit not supporting these methods SHALL use method A or method B, as applicable. <em>Example: An Attestation Provider indicates methods {D, C, A} in their metadata, in that order. A Wallet Unit that supports methods C and D (as well as A and B) then uses method D for this type of attestation. A Wallet Unit supporting methods A, B and C uses method C. A Wallet Unit supporting only methods A and B uses method A.</em></td>
</tr>
<tr>
<td>ISSU_41</td>
<td>To the maximum extent possible, Wallet Providers, PID Providers, and Attestation Providers SHALL ensure that Users do not notice which of the methods A, B, C, or D is used for their PIDs, attestations, or WUAs.</td>
</tr>
<tr>
<td>ISSU_42</td>
<td>To the maximum extent possible, Wallet Providers, PID Providers, and Attestation Providers SHALL ensure that no User action is needed for the re-issuance of WUAs, PIDs, or attestations. <em>Note: For the topic of re-issuance, see also the <a href="../../../discussion-topics/b-re-issuance-and-batch-issuance-of-pids-and-attestations/">Discussion Paper for Topic B</a>.</em></td>
</tr>
</tbody>
</table>
<h6 id="method-a-once-only-attestations">Method A: Once-only attestations <!-- omit from toc --></h6>
<p>The requirements in this subsection specify the Wallet Unit's behaviour when it
is using Method A for a given type of PID, attestation, or WUA. For more
information on this method, please refer to
<a href="../../../discussion-topics/a-privacy-risks-and-mitigations/#32-method-a-once-only-attestations">Section 3.2 of the Discussion Paper for Topic A</a>.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_43</td>
<td>The Wallet Unit SHALL request the PID Provider, Attestation Provider, or Wallet Provider to issue PIDs, attestations, or WUAs in batches to the Wallet Unit. All PIDs, attestations, or WUAs in a batch SHALL have the same attribute values and the same technical validity period.</td>
</tr>
<tr>
<td>ISSU_44</td>
<td>The Wallet Unit SHALL present each PID, attestation, or WUA only once to a Relying Party, except when it has fallen back to Method B as specified below, or to another available method.</td>
</tr>
<tr>
<td>ISSU_45</td>
<td>The Wallet Unit SHALL have a lower limit for the number of unused PIDs, attestations, or WUAs it holds, and SHALL request the issuance of a new batch when this limit is reached. During the first issuance of a new PID, attestation, or WUA, see requirement ISSU_39, the PID Provider, Attestation Provider or Wallet Provider SHALL inform the Wallet Unit about the value of the lower limit and the size of the batch to be requested.</td>
</tr>
<tr>
<td>ISSU_46</td>
<td>If the Wallet Unit must request a new batch of PIDs, attestations, or WUAs, but is not able to do so because it is offline, the Wallet Unit SHALL warn the User that they are about to lose the possibility to present this PID or attestation to a Relying Party (or request (re-)issuance of a PID or attestation, in case of the WUA) and request them to connect their device to the internet.</td>
</tr>
<tr>
<td>ISSU_47</td>
<td>If the Wallet Unit has run out of unused PIDs, attestations, or WUAs, but is not able to request a new batch because it is offline, it SHALL fall back to method B (see requirement 6), or another available method. This means that, when requested by a Relying Party or Attestation Provider, the Wallet Unit SHALL again present one of the already used PIDs, attestations or WUAs. The Wallet Unit SHALL return to using method A as soon as it is able to go online and request a new batch of PIDs, attestations, or WUAs.</td>
</tr>
</tbody>
</table>
<h6 id="method-b-limited-time-attestations">Method B: Limited-time attestations <!-- omit from toc --></h6>
<p>The requirements in this subsection specify the Wallet Unit's behaviour when it
is using Method B for a given type of PID, attestation, or WUA. See also
<a href="../../../discussion-topics/a-privacy-risks-and-mitigations/#33-method-b-limited-time-attestations">Section 3.3 of the Discussion Paper for Topic A</a>.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_48</td>
<td>The Wallet Unit SHALL request the PID Provider, Attestation Provider, or Wallet Provider to issue a single PID, attestation, or WUA to the Wallet Unit.</td>
</tr>
<tr>
<td>ISSU_49</td>
<td>The Wallet Unit SHALL present that PID, attestation, or WUA multiple times to the same Relying Party or Attestation Provider, or to different Relying Parties or Attestation Providers, when requested to do so.</td>
</tr>
<tr>
<td>ISSU_50</td>
<td>The Wallet Unit SHALL request the PID Provider, Attestation Provider, or Wallet Provider to re-issue a PID, attestation, or WUA some time before the one existing in the Wallet Unit expires. The PID Provider, Attestation Provider, or Wallet Provider SHALL inform the Wallet Unit about the moment at which the Wallet Unit must request the re-issuance of a PID, attestation, or WUA, relative to the expiration date of the existing one. <em>Note: It is the responsibility of the Relying Party receiving a PID or attestation (or the Attestation Provider receiving a WUA) to validate whether a presented PID, attestation, or WUA is temporally valid. A Wallet Unit is allowed to present a PID, attestation, or WUA even if its expiration date is in the past.</em></td>
</tr>
</tbody>
</table>
<h6 id="method-c-rotating-batch-attestations">Method C: Rotating-batch attestations <!-- omit from toc --></h6>
<p>The requirements in this subsection specify the Wallet Unit's behaviour when it
is using Method C for a given type of PID, attestation, or WUA. See also
<a href="../../../discussion-topics/a-privacy-risks-and-mitigations/#34-method-c-rotating-batch-attestations">Section 3.4 of the Discussion Paper for Topic A</a>.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_51</td>
<td>The Wallet Unit SHALL request the PID Provider, Attestation Provider, or Wallet Provider to issue PIDs, attestations, or WUAs in batches to the Wallet Unit. All PIDs, attestations, or WUAs in a batch SHALL have the same attribute values and the same technical validity period.</td>
</tr>
<tr>
<td>ISSU_52</td>
<td>When a presentation of attributes is requested by multiple Relying Parties, the Wallet Unit SHALL present each PID or attestation in a batch once, in a random order. Similarly, when a WUA is requested by multiple Attestation Providers, the Wallet Unit SHALL present each WUA in a batch once, in a random order.</td>
</tr>
<tr>
<td>ISSU_53</td>
<td>When all PIDs, attestations, or WUAs in a batch have been presented once, the Wallet Unit SHALL reset the batch, and start presenting each PID, attestation, or WUA in the batch again in a random order.</td>
</tr>
<tr>
<td>ISSU_54</td>
<td>The Wallet Unit SHALL request the PID Provider, Attestation Provider, or Wallet Provider to re-issue a batch of PIDs, attestations, or WUAs, some time before the batch in the Wallet Unit expires. The PID Provider, Attestation Provider, or Wallet Provider SHALL inform the Wallet Unit about the size of the batch and about the moment at which the Wallet Unit must request the re-issuance of a batch, relative to the expiration date of the existing one.</td>
</tr>
</tbody>
</table>
<h6 id="method-d-per-relying-party-attestations">Method D: Per-Relying Party attestations <!-- omit from toc --></h6>
<p>The requirements in this subsection specify the Wallet Unit's behaviour when it
is using Method D for a given type of PID, attestation, or WUA. See also
<a href="../../../discussion-topics/a-privacy-risks-and-mitigations/#35-method-d-per-relying-party-attestations">Section 3.5 of the Discussion Paper for Topic A</a>.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_55</td>
<td>The Wallet Unit SHALL present a different PID, attestation, or WUA to each different Relying Party or Attestation Provider upon their request. This means that it SHALL comply with Method A for such Relying Parties or Attestation Providers.</td>
</tr>
<tr>
<td>ISSU_56</td>
<td>In case a given Relying Party requests attributes from a given type of PID or attestation multiple times, the Wallet Unit MAY present the same PID or attestation to this Relying Party each time. If it does, it SHALL comply with Method B or Method C for such a Relying Party.</td>
</tr>
<tr>
<td>ISSU_56a</td>
<td>In case a given Attestation Provider requests a WUA multiple times, the Wallet Unit MAY present the same WUA to this Attestation Provider each time. If it does, it SHALL comply with Method B or Method C for such an Attestation Provider.</td>
</tr>
<tr>
<td>ISSU_57</td>
<td>The Wallet Unit SHALL keep track of which PID or attestation it has presented to which Relying Party, using the unique identifier from the respective access certificate, unless the Relying Party is an intermediary. If the Relying Party is an intermediary, the Wallet Unit SHALL use the unique identifier obtained from the registration certificate or from the extension of the presentation request meant in RPI_06. <em>Note: The Wallet Unit can see that a presentation request is from an intermediary either because this is indicated in the registration certificate or because the extension meant in RPI_06 and RPI_06a is present.</em></td>
</tr>
<tr>
<td>ISSU_57a</td>
<td>The Wallet Unit SHALL keep track of which WUA it has presented to which Attestation Provider, using the unique identifier obtained from the respective access certificate.</td>
</tr>
</tbody>
</table>
<h6 id="e-hlrs-for-re-issuance-and-batch-issuance-of-pids-attestations-and-wuas">E - HLRs for re-issuance and batch issuance of PIDs, attestations and WUAs <!-- omit from toc --></h6>
<p>These HLRs were added as a result of the discussions of Topic B,
re-issuance and batch issuance of PIDs, attestations and WUAs. For more background
information on these requirements, please refer to <a href="../../../architecture-and-reference-framework-main/#6627-batch-issuance">Sections 6.6.2.7</a>
and
<a href="../../../architecture-and-reference-framework-main/#6652-pid-or-attestation-re-issuance">6.6.5.2</a> of the ARF main document, and to the <a href="../../../discussion-topics/b-re-issuance-and-batch-issuance-of-pids-and-attestations/">Discussion Paper for Topic B</a>.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ISSU_58</td>
<td>A Wallet Unit SHALL give its User the option to manually initiate a re-issuance process for any of the PIDs or attestations in their Wallet Unit. <em>Note: This requirement does not apply for WUAs, since Users must not be involved in the management of WUAs.</em></td>
</tr>
<tr>
<td>ISSU_59</td>
<td>After a successful re-issuance, a Wallet Unit SHALL compare the attribute values of the re-issued PID or attestation with those of the existing PID or attestation, and SHALL notify the User in case of any differences. <em>Note: This requirement does not apply for WUAs, since Users must not be involved in the management of WUAs.</em></td>
</tr>
<tr>
<td>ISSU_60</td>
<td>A Wallet Unit SHALL gracefully handle situations in which re-issuance of a PID,  attestation, or WUA is refused by the PID Provider, Attestation Provider, or Wallet Provider,for example by attempting a retry after an appropriate delay.</td>
</tr>
<tr>
<td>ISSU_61</td>
<td>A Wallet Unit SHALL support PID or attestation first-time batch issuance with a single User authentication, regardless of the size of the batch. <em>Notes: - See also requirement WIAM_14. - This requirement does not apply for WUAs, since Users must not be involved in the management of WUAs.</em></td>
</tr>
<tr>
<td>ISSU_62</td>
<td>If a PID, attestation, or WUA was successfully re-issued because the value of one or more of its attributes was changed (including attributes being added or deleted), a Wallet Unit SHOULD delete the correct pre-existing PID, attestation, or WUA. <em>Notes: - It is up to the Wallet Unit, possibly using metadata provided by the PID Provider, Attestation Provider, or Wallet Provider using the [OpenID4VCI] protocol, to determine the PID, attestation, or WUA to be deleted. - Additionally, per requirement VCR_09, the PID Provider, Attestation Provider, or Wallet Provider revokes the pre-existing PID, attestation, or WUA.</em></td>
</tr>
<tr>
<td>ISSU_63</td>
<td>PID Providers, Attestation Providers, Wallet Providers, and Wallet Units SHALL support the features of [OpenID4VCI] enabling the re-issuance of PIDs, attestations, and WUAs.</td>
</tr>
<tr>
<td>ISSU_64</td>
<td>PID Providers, Attestation Providers, Wallet Providers, and Wallet Units SHALL support the features of [OpenID4VCI] enabling the batch issuance of PIDs, attestations, and WUAs.</td>
</tr>
<tr>
<td>ISSU_65</td>
<td>The common OpenID4VCI protocol referenced in requirement ISSU_01, or an EUDI Wallet-specific extension or profile thereof, SHALL enable a PID Provider, Attestation Provider or Wallet Provider to verify that a re-issued PID, attestation, or WUA is bound to the same WSCA/WSCD to which the existing PID, attestation, or WUA is bound. <em>Note: This can be done, for instance, by requiring that OAuth 2.0 Demonstrating Proof of Possession (DPoP) [RFC 9449] is used for each Refresh Token, and that the public key in the DPoP proof is identical to the public key in the existing PID, attestation, or WUA issued to the Wallet Unit previously.</em></td>
</tr>
</tbody>
</table>
<h4 id="a2311-topic-11-pseudonyms">A.2.3.11 Topic 11 - Pseudonyms</h4>
<h5 id="description_8">Description <!-- omit from toc --></h5>
<p>Wallet Units will support generating pseudonyms for Users in compliance with the
W3C WebAuthn API specification, <a href="https://www.w3.org/TR/2021/REC-webauthn-2-20210408/">W3C WebAuthn</a>. On a high level, this means that
the WSCA/WSCD in the Wallet Unit will be able to create key pairs. The public keys of
these pairs function as pseudonyms for the User. Only the User can use these
pseudonyms, since the WSCA/WSCD authenticates the User before allowing a pseudonym to
be used, see requirement WIAM_14. The Wallet Unit will keep an internal structure
to associate each pseudonym (public key) with a specific Relying Party, based on
the Relying Party unique identifier in the Relying Party Instance access
certificate mentioned in requirement Reg_32.</p>
<p>Pseudonyms were discussed with Member States in Topic E. These
discussions included the use cases for which Wallet Units must support
pseudonyms and the HLRs for the technical specification of how it must be
implemented. The below HRLs are the result of this discussion. For more
background information on these requirements, please refer to the <a href="../../../discussion-topics/e-pseudonyms-including-user-authentication-mechanism/">Discussion
Paper for Topic E</a>.</p>
<p><strong>NOTE: As specified in requirement PA_21, the Commission will create or reference a technical specification containing a profile or extension of the [W3C WebAuthn] specification. The HLRs below are in fact requirements to be fulfilled by this technical specification. Discussions on the pseudonyms are ongoing.</strong></p>
<h6 id="a-hlrs-related-to-use-cases">A. HLRs related to Use Cases <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PA_01</td>
<td>A Wallet Unit SHALL enable a User to generate a Pseudonym and register it at a Relying Party.</td>
</tr>
<tr>
<td>PA_02</td>
<td>A Wallet Unit SHALL enable a User to authenticate with a Pseudonym towards a Relying Party if the Wallet Unit was used previously to register the Pseudonym for the same Relying Party.</td>
</tr>
<tr>
<td>PA_03</td>
<td>A Wallet Unit SHALL be able to perform the actions specified in the above two requirements independently of whether the interaction with the Relying Party is initiated on the same device hosting the Wallet Instance or on a device different from the one hosting the Wallet Instance.</td>
</tr>
<tr>
<td>PA_04</td>
<td>A Wallet Unit SHALL enable the User to use multiple different Pseudonyms at a given Relying Party.</td>
</tr>
<tr>
<td>PA_05</td>
<td>A Wallet Unit SHOULD enable a User to freely choose a User alias for each Pseudonym registered at a Relying Party. Setting an alias SHOULD be optional for the User. The User SHOULD be able to change the alias for any Pseudonym.</td>
</tr>
<tr>
<td>PA_06</td>
<td>A Wallet Unit SHALL enable a User to choose which Pseudonym to authenticate with towards a Relying Party, if multiple Pseudonyms are registered for this Relying Party. The Wallet Unit SHOULD present the User with the aliases of the applicable Pseudonyms, if assigned, when making this choice.</td>
</tr>
<tr>
<td>PA_07</td>
<td>A Wallet Unit SHALL enable a User to delete a Pseudonym.</td>
</tr>
<tr>
<td>PA_08</td>
<td>A Wallet Unit SHALL enable the User to manage Pseudonyms within the Wallet Unit in a user-friendly and transparent manner.</td>
</tr>
<tr>
<td>PA_08a</td>
<td>A Wallet Unit SHALL log Pseudonym registration and presentation transactions as specified in <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>.</td>
</tr>
<tr>
<td>PA_09</td>
<td>A Wallet Unit SHALL enable the User to see all existing pseudonyms, including the associated Relying Party.</td>
</tr>
</tbody>
</table>
<h6 id="b-hlrs-related-to-relying-parties">B. HLRs related to Relying Parties <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PA_10</td>
<td>A Relying Party SHALL be able to verify that a User is registering a Pseudonym using a non-revoked Wallet Unit.</td>
</tr>
<tr>
<td>PA_11</td>
<td>A Relying Party SHALL be able to verify that a User is authenticating with a Pseudonym using a non-revoked Wallet Unit.</td>
</tr>
<tr>
<td>PA_12</td>
<td>If Wallet Unit is used to register a Pseudonym at a Relying Party in combination with a PID, attestation or WUA being presented to the same Relying Party, then this Relying Party SHALL be able to verify that the same User performed both actions.</td>
</tr>
<tr>
<td>PA_13</td>
<td>The Relying Party SHALL be able to validate that the pseudonym presented to them belongs to the User presenting it.</td>
</tr>
</tbody>
</table>
<h6 id="c-hlrs-related-to-privacy">C. HLRs related to privacy <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PA_14</td>
<td>A Wallet Unit SHALL store the information necessary for authenticating with a Pseudonym in its WSCA/WSCD.</td>
</tr>
<tr>
<td>PA_15</td>
<td>A Relying Party SHALL NOT be able to derive the User's true identity, or any data identifying the User, from the Pseudonym value received by the Relying Party.</td>
</tr>
<tr>
<td>PA_16</td>
<td>A Wallet Unit SHALL NOT reveal the same Pseudonym to different Relying Parties unless the User explicitly chooses otherwise.</td>
</tr>
<tr>
<td>PA_17</td>
<td>It SHALL NOT be possible to correlate Pseudonyms based on their values nor on other metadata sent by the Wallet Unit during registration and authentication, meaning that colluding Relying Parties SHALL NOT able to conclude that different Pseudonyms belong to the same User.</td>
</tr>
<tr>
<td>PA_18</td>
<td>The Wallet Unit SHALL ensure that Pseudonyms contain sufficient entropy to make the chance of colliding Pseudonyms (meaning two Users having the same Pseudonym value for the same Relying Party) negligible.</td>
</tr>
<tr>
<td>PA_19</td>
<td>A Wallet Unit SHALL NOT share the User's optionally assigned Pseudonym aliases with any Relying Party.</td>
</tr>
<tr>
<td>PA_20</td>
<td>The Wallet Unit SHALL verify the identity of a Relying Party when a User registers a Pseudonym or authenticates with a Pseudonym, provided the profile or extension of [W3C WebAuthn] meant in PA_21 enables the Wallet Unit to do this. In case the profile or extension does not enable this, the Wallet Unit SHALL trust the WebAuthn Client (i.e., the browser) to verify the Relying Party identity. <em>Notes: - [W3C WebAuthn] currently does not offer a way for an Authenticator (i.e., the Wallet Unit) to authenticate a Relying Party. Instead, the Client (i.e., the browser) will authenticate the Relying Party, using TLS.</em></td>
</tr>
</tbody>
</table>
<h6 id="d-hlrs-related-to-interoperability">D. HLRs related to interoperability <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PA_21</td>
<td>The Commission SHALL create or reference a technical specification containing a profile or extension of the [W3C WebAuthn] specification compliant with the HLRs specified in this Topic. This specification SHALL contain all details necessary for Wallet Units and Relying Parties to generate, register, and use Pseudonyms.</td>
</tr>
<tr>
<td>PA_22</td>
<td>Wallet Providers SHALL ensure that their Wallet Solution supports the [W3C WebAuthn] specification and the technical specification meant in requirement PA_21.</td>
</tr>
</tbody>
</table>
<h4 id="a2312-topic-12-attestation-rulebooks">A.2.3.12 Topic 12 - Attestation Rulebooks</h4>
<h5 id="description_9">Description <!-- omit from toc --></h5>
<p>Article 45e of the [European Digital Identity Regulation] sets up the legal
basis for the Commission to "where necessary, establish specifications and
procedures for the catalogue of attributes and schemes for the attestation of
attributes and verification procedures for qualified electronic attestations of
attributes". As described in <a href="../../../architecture-and-reference-framework-main/#56-catalogues">Section 5.6 of the ARF main document</a>, these 'schemes for the
attestation of attributes' will be described in so-called Attestation Rulebooks.
A separate Rulebook will be created for each type of attestation. This Topic
describes the high-level requirements for the Attestation Rulebooks that will
specify the details of new types of attestations.</p>
<p>Attestation Rulebooks will be written by Attribute Schema Providers, a role
which can be assumed by different types of organisation. The goal of this Topic
is to ensure that all Rulebooks that will be written in the future will contain
the same type of information and the same level of detail, such that all
attestations are interoperable.</p>
<p>Attestation Rulebooks may be registered and published in a publicly accessible
catalogue, as described in <a href="#a2325-topic-25---unified-definition-and-controlled-vocabularies-for-attributes">Topic 25</a>.</p>
<h5 id="hlrs_7">HLRs <!-- omit from toc --></h5>
<h6 id="a-requirements-regarding-attestation-formats">A. Requirements regarding attestation formats <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ARB_01</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA or a PuB-EAA SHALL specify that one or more of the following two common format(s) must be used for these attestations: - The format specified in ISO/IEC 18013-5, see [ISO18013-5]. - The format specified in "SD-JWT-based Verifiable Credentials (SD-JWT VC)", see [SD-JWT-VC].</td>
</tr>
<tr>
<td>ARB_01a</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHALL specify that one or more of the following three common format(s) must be used for these attestations: - The format specified in ISO/IEC 18013-5, see [ISO18013-5]. - The format specified in "SD-JWT-based Verifiable Credentials (SD-JWT VC)", see [SD-JWT-VC]. - The format specified in "W3C Verifiable Credentials Data Model", see [W3C VCDM v2.0].</td>
</tr>
<tr>
<td>ARB_01b</td>
<td>The Schema Provider for an Attestation Rulebook describing attestations using the format specified in [SD-JWT VC] SHALL ensure that these attestations comply with the 'SD-JWT VCs' profile specified in [HAIP].</td>
</tr>
<tr>
<td>ARB_02</td>
<td>The Schema Provider for an Attestation Rulebook SHALL analyse whether it must be possible for a User to present that type of attestation when the Wallet Unit and the Relying Party are in proximity and attestations are presented without using the internet. If so, the Attestation Rulebook SHALL specify that the attestations must be issued in the ISO/IEC 18013-5-compliant mdoc format. <em>Note: In theory, it is possible to use SD-JWT VC-compliant attestations in proximity use cases. In practice, however, the only protocol available to request and release SD-JWT VC-compliant attestations between a Wallet Unit and a Relying Party Instance is OpenID4VP. That protocol cannot be used without internet connectivity.</em></td>
</tr>
<tr>
<td>ARB_03</td>
<td>The Schema Provider for an Attestation Rulebook MAY specify in the Attestation Rulebook that that type of attestation must be issued in the [SD-JWT VC]-compliant format, provided the [SD-JWT VC] specification has been approved by an EU standardisation body or by the European Digital Identity Cooperation Group established pursuant to <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e4536-1-1">Article 46e</a>(1) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_04</td>
<td>If an Attestation Rulebook specifies that a type of attestation can be issued in a format compliant with [W3C VCDM v2.0], the Schema Provider for that Attestation Rulebook SHALL ensure the Rulebook references one or more documents specifying in detail how a Relying Party can request attributes from a such an attestation, and how a User can selectively disclose attributes from such an attestation. Moreover, these referenced documents SHALL be approved by an EU standardisation body or by the European Digital Identity Cooperation Group established pursuant to <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e4536-1-1">Article 46e</a>(1) of the [European Digital Identity Regulation].</td>
</tr>
</tbody>
</table>
<h6 id="b-requirements-regarding-attestation-types">B. Requirements regarding attestation types <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ARB_05</td>
<td>The Schema Provider for an Attestation Rulebook SHALL specify a value for the attestation type, which SHALL be unique within the scope of the EUDI Wallet ecosystem. <em>Notes: - In ISO/IEC 18013-5, the attestation type is called 'document type' and is included as a "docType" key-value pair in both the mdoc request and the mdoc response. Also, a method for generating unique attestation type values is recommended. - In OpenID4VP, the attestation type is included in the "id" property of an Input Descriptor in a Presentation Request. - In [SD-JWT VC], the attestation type is called 'SD-JWT VC type' and is included as a 'vct' claim in the SD-JWT VC.</em></td>
</tr>
</tbody>
</table>
<h6 id="c-requirements-regarding-attestation-attribute-schemas">C. Requirements regarding attestation attribute schemas <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ARB_06</td>
<td>The Schema Provider for an Attestation Rulebook SHALL define all attributes that an attestation of that type may contain. This definition SHALL first describe the semantics of each attribute in an encoding-independent manner and SHALL subsequently for each attribute specify an ISO/IEC 18013-5-compliant format, an SD-JWT VC-compliant format, or both, as needed given the choices made according to ARB_01 - ARB_04.</td>
</tr>
<tr>
<td>ARB_06a</td>
<td>For ISO/IEC 1803-5-compliant attestations, the Attestation Rulebook SHALL define each attribute within an attribute namespace. An attribute namespace SHALL fully define the identifier, the syntax, and the semantics of each attribute within that namespace. An attribute namespace SHALL have an identifier that is unique within the scope of the EUDI Wallet ecosystem, and each attribute identifier SHALL be unique within that namespace. <em>Note: In ISO/IEC 18013-5, namespaces are discussed and a method for generating unique namespace identifiers is recommended.</em></td>
</tr>
<tr>
<td>ARB_06b</td>
<td>For [SD-JWT VC]-compliant attestations, the Schema Provider for the Attestation Rulebook SHALL ensure that each claim name is either included in the IANA registry for JWT claims, or is a Public Name as defined in [RFC 7519]. <em>Note: [SD-JWT VC] does not discuss how to avoid conflicting claim names. Since SD-JWTs are a special kind of JWTs, the methods specified in RFC 7519 are applicable.</em></td>
</tr>
<tr>
<td>ARB_07</td>
<td>When determining the attributes to be included in a new attestation type, the Schema Provider for the applicable Attestation Rulebook SHOULD consider referring to attributes that are already included in the catalogue specified in <a href="#a2325-topic-25---unified-definition-and-controlled-vocabularies-for-attributes">Topic 25</a> + <a href="#a2326-topic-26---catalogue-of-attestations">26</a>, rather than unnecessarily re-defining all attributes within a new namespace.</td>
</tr>
<tr>
<td>ARB_08</td>
<td>The Schema Provider for an Attestation Rulebook SHOULD, when specifying a new attribute, take into consideration existing conventions for attribute identifier values and attribute syntaxes. <em>Note: These conventions may depend on the format of the attestation, i.e., CBOR for ISO/IEC 18013-5-compliant attestations or JSON for SD-JWT VC-compliant attestations.</em></td>
</tr>
<tr>
<td>ARB_09</td>
<td>The Schema Provider for an Attestation Rulebook SHALL specify, for each attribute in the attestation, whether the presence of that attribute is mandatory, optional, or conditional.</td>
</tr>
<tr>
<td>ARB_10</td>
<td>The Schema Provider for an Attestation Rulebook for an ISO/IEC 18013-5 compliant attestation MAY define a domestic namespace to specify attributes that are specific to that Rulebook and are not included in the applicable EU-wide or sectoral namespace. All requirements for namespaces in this Topic also apply for domestic namespaces.</td>
</tr>
<tr>
<td>ARB_11</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA or a PuB-EAA SHALL include in the Rulebook an attribute as meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point a) and <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-56-1">Annex VII</a> point a) of the [European Digital Identity Regulation]. This attribute SHALL reference the technical specification meant in ARB_25.</td>
</tr>
<tr>
<td>ARB_12</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHOULD include an attribute in the Rulebook indicating that the attestation is an EAA. This attribute SHALL reference the technical specification meant in ARB_25.</td>
</tr>
<tr>
<td>ARB_13</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA SHALL include in the Rulebook one or more attributes or metadata representing the set of data meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point b) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_14</td>
<td>The Schema Provider for an attestation Rulebook describing a type of attestation that is a PuB-EAA SHALL include in the Rulebook one or more attributes or metadata representing the set of data meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-56-1">Annex VII</a> point b) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_15</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHOULD include in the Rulebook one or more attributes or metadata representing the set of data meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point b) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_16</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA or a PuB-EAA SHALL include in the Rulebook one or more attributes representing the set of data meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point c) or <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e46-55-1">Annex VII</a> point c) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_17</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHOULD include in the Rulebook one or more attributes representing the set of data meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point c) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_18</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA or a PuB-EAA SHALL include in the Rulebook one or more attributes or metadata representing the set of data meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point e) or <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-56-1">Annex VII</a> point e) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_19</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHOULD include in the Rulebook one or more attributes representing the set of data meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point e) of the [European Digital Identity Regulation].</td>
</tr>
<tr>
<td>ARB_20</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA or a PuB-EAA SHALL include in the Rulebook one or more attributes or metadata representing the location meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point h) or <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-56-1">Annex VII</a> point h) of the [European Digital Identity Regulation]. For a QEAA, this location SHALL indicate at least the URL at which a machine-readable version of the trust anchor to be used for verifying the QEAA can be found or looked up. For a PuB-EAA, this location SHALL indicate at least the URL at which a machine-readable version of the qualified certificate that signed the PuB-EAA can be found or looked up.</td>
</tr>
<tr>
<td>ARB_21</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHOULD include in the Rulebook one or more attributes or metadata representing the location at which a machine-readable version of the trust anchor to be used for verifying the EAA can be found or looked up.<em>Note: What this location indicates precisely is dependent on the nature of the mechanism used for distributing trust anchors; see requirement ARB_26.</em></td>
</tr>
</tbody>
</table>
<h6 id="d-miscellaneous-requirements_1">D. Miscellaneous requirements <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ARB_22</td>
<td>The Schema Provider for an Attestation Rulebook SHALL specify all technical details necessary to ensure interoperability, security, and privacy of that attestation. <em>Note: An Attestation Rulebook may also specify requirements regarding how the Wallet Unit must display the attestation and the attributes in it to the User.</em></td>
</tr>
<tr>
<td>ARB_23</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA or a PuB-EAA SHALL specify which of the revocation mechanisms specified in <a href="#a237-topic-7---attestation-revocation-and-revocation-checking">Topic 7</a> SHALL be supported by that attestation.</td>
</tr>
<tr>
<td>ARB_24</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHALL specify whether that type of EAA must be revocable. If an EAA type must be revocable, the relevant Rulebook SHALL determine which of the revocation mechanisms specified in <a href="#a237-topic-7---attestation-revocation-and-revocation-checking">Topic 7</a> SHALL be supported by that attestation.</td>
</tr>
<tr>
<td>ARB_25</td>
<td>The Commission SHALL take measures to ensure that the following information is included in a technical specification: - The identifier of the attribute containing the indication meant in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-54-1">Annex V</a> point a) and <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e40-56-1">Annex VII</a> point a). - The syntax and semantics of this attribute in case the attestation is a QEAA, in case it is PuB-EAA, and in case it is a non-qualified EAA.</td>
</tr>
<tr>
<td>ARB_26</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a non-qualified EAA SHOULD define in the Rulebook: - mechanisms allowing a Wallet Unit to verify that the EAA Provider is authorised or registered to issue this type of EAA. - mechanisms allowing a Relying Party to obtain, in a trustworthy manner, the trust anchor(s) of the EAA Providers issuing this type of EAA.</td>
</tr>
<tr>
<td>ARB_27</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA, PuB-EAA, or non-qualified EAA SHOULD specify in the Rulebook whether a Relying Party receiving the attestation must request and verify a PID and verify the cryptographic binding between the PID and the attestation. <em>Note: Relying Parties can only do so in a trustworthy manner if Wallet Units are able to provide a proof of cryptographic binding showing that the private keys of the attestation and the PID are stored in the same WSCD, in accordance with the requirements in <a href="#a2318-topic-18---combined-presentations-of-attributes">Topic 18</a>.</em></td>
</tr>
<tr>
<td>ARB_28</td>
<td>An Attribute Schema Provider SHOULD specify an attribute in an Attestation Rulebook that indicates whether the Attestation Provider during attestation issuance requested a cryptographic binding (as specified in <a href="#a2318-topic-18---combined-presentations-of-attributes">Topic 18</a>) between the new attestation and an existing PID or attestation. If present in a Rulebook, the identifier for this attribute SHALL be "cryptographically_bound_to", and its contents SHALL be an attestation type or vct (see ARB_05). <em>Note: The meaning of this attribute, if present, is "This attestation is cryptographically bound to one or more attestations of the given attestation type or vct on this Wallet Unit." If a Relying Party receives this attribute from a Wallet Unit, it can subsequently request the Wallet Unit to send a proof of cryptographic binding between the attestation and an attestation indicated in the "cryptographically_bound_to" attribute.</em></td>
</tr>
<tr>
<td>ARB_29</td>
<td>The Schema Provider for an Attestation Rulebook describing a type of attestation that is a QEAA, PuB-EAA, or non-qualified EAA SHOULD ensure that the structure and contents of the Attestation Rulebook follow the descriptions in the <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-attestation-rulebooks-catalog/blob/main/template/attestation-rulebook-template.md">Attestation Rulebook template</a>.</td>
</tr>
</tbody>
</table>
<h4 id="a2313-topic-13-developing-a-wallet-unit-architecture-based-on-secure-element">A.2.3.13 Topic 13 - Developing a Wallet Unit architecture based on Secure Element</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a2314-topic-14-developing-a-wallet-unit-architecture-based-on-external-token">A.2.3.14 Topic 14 - Developing a Wallet Unit architecture based on External Token</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a2315-topic-15-developing-a-wallet-unit-architecture-based-on-remote-hsm">A.2.3.15 Topic 15 - Developing a Wallet Unit architecture based on Remote HSM</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a2316-topic-16-signing-documents-with-a-wallet-unit">A.2.3.16 Topic 16 - Signing documents with a Wallet Unit</h4>
<h5 id="description_10">Description <!-- omit from toc --></h5>
<p>A Wallet Unit SHALL enable its User to create qualified electronic
signatures or seals. This goal can be reached by using signature or seal
creation capabilities of the Wallet Unit as a part of a local QSCD,
or by using a remote QSCD managed by a QTSP.</p>
<p>This Topic contains high-level requirements related to the creation of
Qualified Electronic Signatures using a Wallet Unit.</p>
<h5 id="hlrs_8">HLRs <!-- omit from toc --></h5>
<h6 id="a-requirement-for-wallet-providers">A. Requirement for Wallet Providers <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>QES_01</td>
<td>Wallet Providers SHALL ensure that each User has the possibility to receive a qualified certificate for Qualified Electronic Signatures, bound to a QSCD, that is either local, external, or remotely managed in relation to the Wallet Instance.</td>
</tr>
<tr>
<td>QES_02</td>
<td>Wallet Providers SHALL ensure that each User who is a natural person has, at least for non-professional purposes, free-of-charge access to a Signature Creation Application which allows the creation of free-of-charge Qualified Electronic Signatures using the certificates referred to in QES_01. Wallet Providers SHALL ensure that: - The Signature Creation Application SHALL, as a minimum, be capable of signing or sealing User-provided data and Relying Party-provided data. - The Signature Creation Application SHALL be implemented as part of a Wallet Solution or external to it (by providers of trust services or by Relying Parties). - The Signature Creation Application SHALL be able to generate signatures or seals in formats compliant with at least the mandatory formats referred to in QES_08. <em>Notes: - Signature Creation Application (SCA): see definition in the ETSI TS 119 432 standard. - If the SCA is external to the Wallet Solution, it may be for example a separate mobile application, or be hosted remotely, for instance by the QTSP or by a Relying Party.</em></td>
</tr>
<tr>
<td>QES_03</td>
<td>For the use of the qualified certificate referred to in QES_01, Wallet Providers SHALL ensure that a Wallet Unit implements secure authentication of the User, as well as signature or seal invocation capabilities, as a part of a local, external or remote QSCD.</td>
</tr>
<tr>
<td>QES_04</td>
<td>Wallet Providers SHALL enable their Wallet Units to interface with QSCDs using protocols and interfaces necessary for the implementation of secure User authentication and signature or seal functionality. <em>Note: In a Relying Party-centric flow, the remote QTSP will likely be selected by the Relying Party, which implies the QSCD is managed by the remote QTSP. In a Wallet Unit-driven flow, the User should be able to choose the QSCD.</em></td>
</tr>
<tr>
<td>QES_05</td>
<td>Wallet Providers SHALL enable their Wallet Units to be used for User enrolment to a remote QES Provider (i.e., a QTSP offering remote QES), except where the Wallet Unit interfaces with local or external QSCDs.</td>
</tr>
<tr>
<td>QES_06</td>
<td>Wallet Providers SHALL ensure that their Wallet Solution supports at least one of the following options for remote QES signature creation: - remote QES creation through secure authentication to a QTSP signature web portal, - remote QES creation channelled by the Wallet Unit, - remote QES creation channelled by a Relying Party.</td>
</tr>
<tr>
<td>QES_07</td>
<td>Wallet Providers SHALL ensure that, where a Signature Creation Application relies on a remote Qualified Signature Creation Device and where it is integrated into a Wallet Instance, it supports the Cloud Signature Consortium API Specification 2.0 [CSC API].</td>
</tr>
<tr>
<td>QES_08</td>
<td>Wallet Providers SHALL ensure that their Wallet Units are able to create signatures or seals in accordance with the mandatory PAdES format as specified in ETSI EN 319 142-1 V1.1.1 (2016-04). In addition, Wallet Providers SHOULD ensure that their Wallet Units are able to create signatures or seals in accordance with the following formats: - XAdES as specified in ETSI EN 319 132-1 V1.2.1 (2022-02), - JAdES as specified in ETSI TS 119 182-1 V1.2.1 (2024-07), - CAdES as specified in ETSI EN 3191 22-1 V1.3.1 (2023-06), and - ASiC as specified in ETSI EN 319 162-1 V1.1.1 (2016-04) and ETSI EN 319 162-2 V1.1.1 (2016-04).</td>
</tr>
<tr>
<td>QES_09</td>
<td>Empty</td>
</tr>
<tr>
<td>QES_10</td>
<td>Wallet Providers SHALL ensure that, where the Signature Creation Application is implemented as part of the Wallet Unit and is used to generate signatures or seals of the representation of the document or data to be signed or sealed, the Wallet Unit presents the representation of the document or data to be signed or sealed to the User.</td>
</tr>
<tr>
<td>QES_11</td>
<td>Wallet Providers SHALL ensure that, where the Signature Creation Application is implemented as part of the Wallet Unit, a Wallet Unit computes the hash or digest of the document or data to be signed through a Signature Create Application component.</td>
</tr>
<tr>
<td>QES_12</td>
<td>Wallet Providers SHALL ensure that a Wallet Unit is able to create the signature value of the document or data to be signed either using a local or a remote signing application. <em>Note: a local signing application is on-device. It may either be embedded in the Wallet Unit or be an external application.</em></td>
</tr>
<tr>
<td>QES_13</td>
<td>Wallet Providers SHALL ensure that a Wallet Unit provides a log of transactions related to qualified electronic signatures or seals generated by or through the Wallet Unit, allowing the User to view the history of previously signed data or documents, according to requirement DASH_04 in <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>. <em>Note: If the signature is generated by a remote Signature Creation Application, the Wallet is at minimum used to authenticate the User to the remote QTSP and to obtain the User's consent for the usage of the private signing key. The logs then record information about these processes.</em></td>
</tr>
<tr>
<td>QES_14</td>
<td>Wallet Providers SHALL ensure that the User will be able to explicitly authorise the creation of a qualified electronic signature or seal through their Wallet Unit.</td>
</tr>
<tr>
<td>QES_15</td>
<td>Wallet Providers SHALL ensure that a Wallet Unit can verify, in remote signature creation scenarios, that the qualified electronic signature or seal creation device is part of a qualified service, which is carried out by a qualified trust service provider.</td>
</tr>
<tr>
<td>QES_16</td>
<td>Wallet Providers SHOULD ensure that a Wallet Unit supports multiple-signing scenarios where multiple signatories are required to sign the same document or data.</td>
</tr>
<tr>
<td>QES_17</td>
<td>Wallet Providers SHALL ensure that Wallet Units provide a signature creation confirmation upon the creation of a qualified electronic signature, informing the User about the outcome of the signature creation process. <em>Note: See also QES_17a.</em></td>
</tr>
<tr>
<td>QES_17a</td>
<td>If the Signature Creation Application is external to the Wallet Unit, after the User authorises the usage of the private signing key, the Signature Creation Application SHALL return the outcome of the signature creation process to the Wallet Unit.</td>
</tr>
<tr>
<td>QES_18</td>
<td>Wallet Providers SHALL configure at least one default qualified signing service in the Wallet Unit.</td>
</tr>
<tr>
<td>QES_19</td>
<td>Wallet Providers SHALL ensure that, where the Signature Creation Application is implemented as part of the Wallet Unit, a Wallet Unit supports ETSI TS 119 101 (Electronic Signatures and Infrastructures (ESI); Policy and security requirements for applications for signature creation and signature validation) when using signing keys managed by the QSCD, whether locally, externally, or remotely in relation to the Wallet Instance.</td>
</tr>
<tr>
<td>QES_20</td>
<td>Empty</td>
</tr>
<tr>
<td>QES_21</td>
<td>Empty</td>
</tr>
<tr>
<td>QES_22</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<h6 id="b-requirements-for-qtsps">B. Requirements for QTSPs <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>QES_23</td>
<td>QTSPs providing the remote QES part of a Wallet Solution SHALL support: 1. ETSI TS 119 431-1 (Electronic Signatures and Infrastructures (ESI); Policy and security requirements for trust service providers; Part 1: TSP service components operating a remote QSCD / SCDev), 2. ETSI TS 119 431-2 (Electronic Signatures and Infrastructures (ESI); Policy and security requirements for trust service providers; Part 2: TSP service components supporting AdES digital signature creation), 3. ETSI TS 119 432 (Electronic Signatures and Infrastructures (ESI); Protocols for remote digital signature creation). Wallet Providers and QTSPs providing the remote QES part of a Wallet Solution SHALL comply with Sole Control Assurance Level (SCAL) 2 as defined in CEN EN 419 241-1 (Trustworthy Systems Supporting Server Signing - Part 1: General System Security Requirements).</td>
</tr>
<tr>
<td>QES_24</td>
<td>QTSPs providing the Signature Creation Application as part of the remote QES part of a Wallet Solution SHALL support ETSI TS 119 101 (Electronic Signatures and Infrastructures (ESI); Policy and security requirements for applications for signature creation and signature validation).</td>
</tr>
</tbody>
</table>
<h6 id="c-requirements-for-relying-parties">C. Requirements for Relying Parties <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>QES_24a</td>
<td>Relying Parties providing the Signature Creation Application in a Relying Party-centric flow SHALL support ETSI TS 119 101 (Electronic Signatures and Infrastructures (ESI); Policy and security requirements for applications for signature creation and signature validation).</td>
</tr>
</tbody>
</table>
<h6 id="d-requirements-for-the-commission">D. Requirements for the Commission <!-- omit from toc --></h6>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>QES_25</td>
<td>Empty</td>
</tr>
<tr>
<td>QES_26</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<h4 id="a2317-topic-17-identity-matching">A.2.3.17 Topic 17 - Identity matching</h4>
<h5 id="description_11">Description <!-- omit from toc --></h5>
<p>Users would like to use their PID in their Wallet Unit to access their existing
online account(s), even if their PID attribute values are not exactly the same
as those in their account(s). Users regularly need to log in to cross-border
services offered by public sector bodies. Identity matching enables them to use
their Wallet Unit to do so.</p>
<h5 id="hlrs_9">HLRs <!-- omit from toc --></h5>
<p>There are no HLRs for this Topic.</p>
<h4 id="a2318-topic-18-combined-presentations-of-attributes">A.2.3.18 Topic 18 - Combined presentations of attributes</h4>
<h5 id="description_12">Description <!-- omit from toc --></h5>
<p><strong>Note: The text in this section and the high-level requirements in the next section were adapted from the <a href="../../../discussion-topics/k-combined-presentation-of-attestations/">Discussion Paper for Topic K</a>. All high-level requirements were changed compared to the situation prior to integration of Topic K.</strong></p>
<p>The concept of <em>combined presentation</em> refers to a process where a Relying Party
requests multiple attributes concerning a single User, drawn from separate
attestations (e.g., PID and/or (Q)EAAs), and receives a consolidated response.
The key functional goal is to enable the Relying Party to verify that all
presented attributes pertain to the same User, without compromising trust,
privacy, or data integrity.</p>
<p>A combined presentation of attributes, when designed with privacy in mind,
becomes a powerful tool for protecting individuals from unnecessary exposure.
Rather than relying on full identification for every transaction, we can instead
implement solutions that enable Users to prove only what is strictly necessary 
without revealing who they are.  This aligns directly with the commitments laid
out in the [European Digital Identity Regulation]: access to digital services
must be privacy-protective by design (recital 4), supported by privacy-enhancing
technologies (recital 14), and uphold the principle of unobservability (recital
32).</p>
<p>In this light, Article 5a(16)(b) provides a clear obligation: when attributes
are presented together, this must be done in a way that avoids unnecessary
identification of the User.  Instead, a privacy-preserving combined presentation
of attributes opens the door to new possibilities. It enables the transition of
many real-world processes  currently performed under full identification  into
more private digital equivalents.</p>
<p>Consider, for example, eligibility checks for educational programs. A student
should be able to prove they reside in a particular city and have qualifying
grades <em>without revealing their name, gender, or exact address</em>. The same logic
applies more broadly: renting a car or a bicycle, or purchasing restricted goods
like alcohol, often requires only proof of eligibility  but not a proof of
identity. With the right cryptographic mechanisms in place, we can minimize data
exposure while maintaining trust in the presented attributes</p>
<p>This Topic describes high-level requirements for such a Cryptographic Binding of Attestations scheme. For more information, also see <a href="../../../architecture-and-reference-framework-main/#66310-relying-party-instance-verifies-combined-presentation-of-attributes">Section 6.6.3.10</a>.</p>
<h5 id="hlrs_10">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ACP_01</td>
<td>A Cryptographic Binding of Attestations scheme SHALL enable a WSCA/WSCD to prove that it manages two or more private keys, paired with two or more public keys provided to it by the Wallet Unit. <em>Notes: -These public keys may be included in WUAs, PIDs, attestations, or pseudonyms. - The proof may be transitive, so a proof that two keys are stored/managed in the same WSCA/WSCD may be done by proving these keys relate to each other via a third key (also stored in the WSCA/WSCD).</em></td>
</tr>
<tr>
<td>ACP_02</td>
<td>A Cryptographic Binding of Attestations scheme SHALL rely solely on algorithms standardised by a standardisation organisation recognised by the Commission or in a standard recognised by the Commission.</td>
</tr>
<tr>
<td>ACP_03</td>
<td>A Cryptographic Binding of Attestations scheme SHOULD be implemented using a Zero-Knowledge Proof mechanism that satisfies the requirements specified in <a href="#a2353-topic-53-zero-knowledge-proofs">Topic 53</a>.</td>
</tr>
<tr>
<td>ACP_04</td>
<td>A Cryptographic Binding of Attestations scheme SHALL be compatible with the requirements for attestation issuance in this document, in particular <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>, as well as with requirements for both remote and proximity presentation flows in this document, in particular <a href="#a231-topic-1---accessing-online-services-with-a-wallet-unit">Topic 1</a> and <a href="#a2324-topic-24---user-identification-in-proximity-scenarios">Topic 24</a>.</td>
</tr>
<tr>
<td>ACP_05</td>
<td>A Cryptographic Binding of Attestations scheme SHALL enable an Attestation Provider, during the issuance of an attestation, to request and obtain proof that the private key for the new attestation is managed by the same WSCA/WSCD as the private key of a PID or another attestation already existing on the Wallet Unit. <em>Note: ACP_05 and ACP_06 may require an addition to the common OpenID4VCI protocol referenced in requirement ISSU_01, or an extension or profile thereof.</em></td>
</tr>
<tr>
<td>ACP_06</td>
<td>A Cryptographic Binding of Attestations scheme SHALL enable a PID Provider or Attestation Provider, during the issuance of a PID or attestation, to request and obtain proof that the private key for the new PID or attestation is managed by the same WSCA/WSCD as the private key of the WUA received.</td>
</tr>
<tr>
<td>ACP_07</td>
<td>Before making a request according to ACP_05, an Attestation Provider SHALL verify that the new attestation indeed belongs to the User of the existing PID or attestation.</td>
</tr>
</tbody>
</table>
<p>Also see requirements ARB_27 and ARB_28 in <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>.</p>
<h4 id="a2319-topic-19-user-navigation-requirements-dashboard-logs-for-transparency">A.2.3.19 Topic 19 - User navigation requirements (Dashboard logs for transparency)</h4>
<h5 id="description_13">Description <!-- omit from toc --></h5>
<p>In this use case, the User is accessing a dashboard of the
Wallet Unit, which provides a record of all transactions executed through the
Wallet Unit. The User is concerned about data privacy, and thus the
function of a dashboard ensures a higher degree of transparency, privacy
and control of the User over their personal data.</p>
<p>This Topic lists high-level requirements related to the functions
of such a dashboard.  </p>
<h5 id="hlrs_11">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>DASH_01</td>
<td>A Wallet Provider SHALL enable a User to access a user-friendly dashboard functionality in their Wallet Unit.</td>
</tr>
<tr>
<td>DASH_02</td>
<td>The Wallet Unit SHALL log all transactions executed through the Wallet Unit, including any transactions that were not completed successfully. This log SHALL include all types of transaction executed through the Wallet Unit: a) PID or attestation issuance and re-issuance transactions, b) PID or attestation presentation transactions , c) Wallet-to-Wallet transactions, (see <a href="#a2330-topic-30---interaction-between-wallet-units">Topic 30</a>, d) pseudonym registration or presentation transactions, e) signature or seal creation transactions (see <a href="#a2316-topic-16---signing-documents-with-a-wallet-unit">Topic 16</a>), f) data deletion requests sent to a Relying Party (see <a href="#a2348-topic-48---blueprint-for-requesting-data-deletion-to-relying-parties">Topic 48</a>), g) reports sent to a Data Protection Authority (see <a href="#a2350-topic-50---blueprint-to-report-unlawful-or-suspicious-request-of-data">Topic 50</a>), h) PID or attestation deletions by the User. <em>Note: For the data to be logged for a data deletion request to a Relying Party or a report sent to a DPA, see Topic 48 and Topic 50, respectively. For other types of transaction, the data to be logged is specified in the requirements in this Topic.</em></td>
</tr>
<tr>
<td>DASH_02a</td>
<td>The Wallet Unit SHALL retain transactions in the log at least for the minimum retention period specified in applicable legislation. If the Wallet Unit must delete transactions from the log, for instance because of size limitations, the Wallet Unit SHALL notify the User via the dashboard before doing so, indicating the potential consequences for the User's data protection rights, and SHALL instruct the User how to export the transactions that are about to be deleted; see DASH_07.</td>
</tr>
<tr>
<td>DASH_02b</td>
<td>The dashboard SHALL include a functionality to display to the User an overview of all transactions in the log.</td>
</tr>
<tr>
<td>DASH_02c</td>
<td>The Commission SHALL establish a technical specification for the common format of the transaction log, including measures to ensure and/or verify its confidentiality, integrity, and authenticity.</td>
</tr>
<tr>
<td>DASH_03</td>
<td>For a PID or attestation presentation transaction executed through the Wallet Unit, the log SHALL contain at least: a) the date and time of the transaction, b) the name and unique identifier of the corresponding Relying Party, and the Member State in which that Relying Party is established, c) the name, contact details (if available), and unique identifier of the intermediary, if an intermediary is involved in the transaction, d) the attestation type(s) and the identifier(s) of the attribute(s) that were requested, as well as those that were presented, e) in the case of non-completed transactions, the reason for such non-completion, f) the URL of the associated Registrar's online service,  <em>Note: this URL can be retrieved from the access certificate.</em> g) the  web form URL (if available), e-mail address (if available), and telephone number (if available) provided by the Relying Party for sending data deletion requests, see requirement RPRC_03d in <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>, h) the web form URL (if available), e-mail address (if available), and telephone number (if available) provided by the Data Protection Authority supervising the Relying Party for reporting suspicious attribute presentation requests, see requirement RPRC_03e in <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>. i) information on the intended use and/or URL to the privacy policy, as registered by the Relying Party at the competent Registrar (if available). <em>Note: The information in points g), h), and i) may be retrieved from the registration certificate or from the Registrar's online service (see <a href="./#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>).</em></td>
</tr>
<tr>
<td>DASH_03a</td>
<td>For a PID or attestation presentation transaction or a Wallet-to-Wallet transaction executed through the Wallet Unit, the log SHALL NOT contain the value of any attributes presented or the value of any transactional data included in the presentation request.</td>
</tr>
<tr>
<td>DASH_03b</td>
<td>For a Wallet-to-Wallet transaction executed through the Wallet Unit, the log SHALL contain at least: a) the date and time of the transaction, b) the role of the Wallet Unit (Holder Wallet Unit or Verifier Wallet Unit), c) the attestation type(s) and the identifier(s) of the attribute(s) that were requested, as well as those that were presented, d) in the case of non-completed transactions, the reason for such non-completion.</td>
</tr>
<tr>
<td>DASH_03c</td>
<td>For a pseudonym registration or presentation transaction executed through the Wallet Unit, the log SHALL contain at least: a) the date and time of the transaction, b) identifying information about the Relying Party, if known to the Wallet Unit, c) whether it is a pseudonym registration or pseudonym presentation transaction, d) in the case of non-completed transactions, the reason for such non-completion. <em>Note: Regarding point b), see PA_20 in <a href="#a2311-topic-11---pseudonyms">Topic 11</a>.</em></td>
</tr>
<tr>
<td>DASH_04</td>
<td>For a signature or seal creation transaction executed through the Wallet Unit, the log SHALL contain at least: a) the date and time of the transaction, b) the document or data signed or sealed (if available to the Wallet Unit), c) in the case of non-completed transactions, the reason for such non-completion.</td>
</tr>
<tr>
<td>DASH_05</td>
<td>For a PID or attestation issuance or re-issuance transaction executed through the Wallet Unit, the log SHALL contain at least: a) the date and time of the transaction, b) the name, contact details (if available), and unique identifier of the corresponding PID Provider or Attestation Provider, c) the attestation type requested, as well as the attestation type issued, d) the number of attestations requested and issued (i.e., the size of the batch in case of batch issuance). d) in the case of non-completed transactions, the reason for such non-completion. e) for a re-issuance transaction, whether it was triggered by the User or by the Wallet Unit without involvement of the User, f) the URL of the associated Registrar's online service. <em>Note: this URL can be retrieved from the access certificate.</em></td>
</tr>
<tr>
<td>DASH_05a</td>
<td>For the deletion of a PID or attestation by the User, the log SHALL contain at least: a) the date and time of the deletion event, b) the attestation type of the deleted PID or attestation. c) The name and unique identifier of the corresponding PID Provider or Attestation Provider. <em>Note: This requirement is not about deletion of transactions from the log, as per DASH_06a.</em></td>
</tr>
<tr>
<td>DASH_06</td>
<td>The Wallet Provider SHALL ensure the confidentiality, integrity, and authenticity of all transactions included in the log.</td>
</tr>
<tr>
<td>DASH_06a</td>
<td>Via the dashboard, the Wallet Unit SHALL enable the User to delete any transaction in the log. Before deleting any transactions, the Wallet Unit SHALL indicate to the User the potential consequences for the User's data protection rights. <em>Note: This requirement applies even in case the minimum retention period specified in applicable legislation (see DASH_02a) is not yet over.</em></td>
</tr>
<tr>
<td>DASH_06b</td>
<td>The Wallet Unit SHALL ensure that no entity other than the User can delete transactions from the log, except possibly for the reason mentioned in DASH_02a.</td>
</tr>
<tr>
<td>DASH_07</td>
<td>The dashboard SHALL allow the User to export the details of one or more transactions in the log to a file, using the common format specified according to DASH_02c, while ensuring their confidentiality, authenticity and integrity. The file SHALL be stored in an external storage or remote storage location of the User's choice, from among the storage options supported by the Wallet Unit and SHALL use the common format and security measures specified according to DASH_02c.</td>
</tr>
<tr>
<td>DASH_08</td>
<td>For a natural-person User, a Wallet Instance SHALL provide a User interface.</td>
</tr>
<tr>
<td>DASH_09</td>
<td>The User interface referred to in DASH_08 SHALL provide a view with -  the EU Digital Identity Wallet Trust Mark, - accompanying general information on the certification of Wallet Solutions, - links to the certification status information as defined in the <a href="../../../technical-specifications/ts1-eudi-wallet-trust-mark/">Technical Specification 1</a>.</td>
</tr>
<tr>
<td>DASH_09a</td>
<td>Positioning of the view meant in DASH_09 in the Wallet UI navigation SHALL follow design guidelines provided by the European Commission.</td>
</tr>
<tr>
<td>DASH_09b</td>
<td>Wallet Providers and Wallet Units SHALL comply with all relevant requirements in <a href="../../../technical-specifications/ts1-eudi-wallet-trust-mark/">Technical Specification 1</a> for the EUDI Wallet Trust Mark.</td>
</tr>
<tr>
<td>DASH_10</td>
<td>Empty. <em>Note: See requirement WIAM_12a in <a href="#a2340-topic-40---wallet-instance-installation-and-wallet-unit-activation-and-management">Topic 40</a>.</em></td>
</tr>
<tr>
<td>DASH_11</td>
<td>A Wallet Unit issued to a legal person SHALL allow the legal person to interact with the Wallet Unit in the appropriate interface provided by the Wallet Provider.</td>
</tr>
<tr>
<td>DASH_12</td>
<td>The User interface referred to in DASH_08 SHALL enable the User, for each presentation transaction in the dashboard, to easily request the Relying Party to delete any or all attributes presented to it in that transaction, or to send a report about that particular transaction to a DPA.</td>
</tr>
</tbody>
</table>
<h4 id="a2320-topic-20-strong-user-authentication-for-electronic-payments">A.2.3.20 Topic 20 - Strong User authentication for electronic payments</h4>
<h5 id="description_14">Description <!-- omit from toc --></h5>
<p>Note: The description in this section was adapted from the
<a href="../../../discussion-topics/w-transactional-data-for-payments-and-other-use-cases/">Discussion Paper for Topic W</a>.
The high-level requirements in the next section were taken from this paper as
well.</p>
<p>The [European Digital Identity Regulation] requires Wallet Units to provide a
functionality of strong User authentication (SUA), among others in the context
of payments.</p>
<p>In general, the life cycle of a Wallet Unit in the role of an authenticator for
strong User authentication comprises the following phases:</p>
<ul>
<li><strong>Registration</strong>: The User registers the Wallet Unit as an authenticator for a
service. This process includes:<ul>
<li>User identification and authentication, for example by presenting a PID,</li>
<li>User consent for the registration,</li>
<li>Linking a Wallet Unit with the service and a User account in that service.
  This happens by issuing a dedicated SUA attestation to the Wallet Unit,
  containing User attributes relevant for the service. The issuance process
  for this SUA attestation complies with all requirements for attestation
  issuance in this ARF. Like any other attestation, the SUA attestation
  contains a public key, and the associated private key is stored in a WSCA.</li>
</ul>
</li>
<li><strong>Strong User Authentication</strong>: A Relying Party sends a presentation request
to the Wallet Unit to request relevant attributes from the SUA attestation. This
presentation request includes transactional data. In the context of electronic
payments, the transactional data will include at least the payment amount and
the payee. After presenting the data to the User and obtaining the User's
consent, the Wallet Unit signs the transactional data. It does so by including
(a representation of) the transactional data in the signature creation process
used for device binding. Note that the syntax and semantics of the transactional
data, as well as rules for how the data must be presented to the User and how
the data will be prepared for inclusion in the device binding signature, will be
defined in the Attestation Rulebook for the SUA attestation.</li>
<li><strong>De-registration</strong>: Unlinking the Wallet Unit from the service and/or the
User's account in that service. This will involve deletion or revocation of the
SUA attestation.</li>
</ul>
<p>Note transactional data must be processed in a way that in general might be
different for each service.</p>
<h5 id="hlrs_12">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>SUA_01</td>
<td>The Wallet Units SHALL be able to process the transactional data included in a presentation request for that an attestation, according to all requirements in the associated Attestation Rulebook.</td>
</tr>
<tr>
<td>SUA_02</td>
<td>The Attestation Rulebook (see <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a> of a SUA attestation SHALL specify the syntax and semantics of the transactional data associated with that attestation, as well as all necessary requirements for Wallet Units to process that transactional data, at least regarding a) displaying the data to the User when obtaining consent for signing the data, b) processing (e.g., hashing) the data for inclusion in the device binding signature, and c) the scope of information to be logged about a SUA attestation presentation transaction by a Wallet Unit.</td>
</tr>
<tr>
<td>SUA_03</td>
<td>The Attestation Provider of a SUA attestation SHALL NOT issue such an attestation to a Wallet Unit that does not comply with all relevant requirements in the Attestation Rulebook for that attestation.</td>
</tr>
<tr>
<td>SUA_04</td>
<td>In the response to a presentation request that includes transactional data, a Wallet Unit SHALL include (a representation of) that data, according to requirements included in the Attestation Rulebook or in information provided to the Wallet Unit in the presentation request. In the latter case, the rules to interpret such information SHALL be included in the Attestation Rulebook. <em>Note: This requirement, as well as SUA_05, only applies if the requested SUA attestation is present on the Wallet Unit and if the User consents to signing the transactional data and presenting the requested attributes.</em></td>
</tr>
<tr>
<td>SUA_05</td>
<td>The Wallet Unit SHALL include (a representation of) the transactional data received in a presentation request in the signature creation process used for device binding, using the private key of the requested SUA attestation, using the mechanisms provided for key binding in [SD-JWT-VC] and mdoc authentication in [ISO/IEC 18013-5], and complying with the applicable requirements in the Attestation Rulebook, see SUA_02 b). <em>Notes: - The resulting signature value constitutes a proof of transaction and fulfils the requirement of the authentication code required in [PSD2]. - See also requirement OIA_02 in <a href="#a231-topic-1---accessing-online-services-with-a-wallet-unit">Topic 1</a>.</em></td>
</tr>
<tr>
<td>SUA_06</td>
<td>The Wallet Unit SHALL be able to adapt the dialogue message(s) displayed to the User (like font size and colour, background colour, text position, labels in the buttons to 'approve' or 'reject' a transaction), according to requirements in an Attestation Rulebook or in information provided to the Wallet Unit in the presentation request. In the latter case, the rules to interpret such information SHALL be included in the Attestation Rulebook.</td>
</tr>
</tbody>
</table>
<h4 id="a2321-topic-21-diplomas-within-the-eudi-wallet-ecosystem">A.2.3.21 Topic 21 - Diplomas within the EUDI Wallet ecosystem</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a2322-topic-22-digital-travel-credentials-within-the-eudi-wallet-ecosystem">A.2.3.22 Topic 22 - Digital Travel Credentials within the EUDI Wallet ecosystem</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a2323-topic-23-pid-issuance-and-qeaa-issuance">A.2.3.23 Topic 23 - PID issuance and (Q)EAA issuance</h4>
<h5 id="description_15">Description <!-- omit from toc --></h5>
<p>See <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>.</p>
<h5 id="hlrs_13">HLRs <!-- omit from toc --></h5>
<p>See <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>.</p>
<h4 id="a2324-topic-24-user-identification-in-proximity-scenarios">A.2.3.24 Topic 24 - User identification in proximity scenarios</h4>
<h5 id="description_16">Description <!-- omit from toc --></h5>
<p>In this use case, the User is using their Wallet Unit for identification
purposes in proximity scenarios. As explained in <a href="../../../architecture-and-reference-framework-main/#442-proximity-presentation-flows">Section 4.4.2 of the ARF main document</a>, in a
proximity flow, the User and their Wallet Instance are physically near the
Relying Part Instance. PIDs and attestations are exchanged using proximity
technology (e.g., NFC, Bluetooth) between the Wallet Unit and the Relying Party
Instance. Note that this definition does not imply that a Wallet Unit and a
Relying Party have to use proximity technologies if they are close together.
They are free to use a remote flow (according to <a href="#a231-topic-1---accessing-online-services-with-a-wallet-unit">Topic 1</a>).
However, there may be situations where either the Wallet Unit or the Relying
Party Instance does not have an internet connection. In such cases, they must be
able to use a proximity flow, if they are close together.</p>
<p>The User is concerned
about sharing personal data in proximity, while the User's objectives
include identifying themselves to services requiring User identification
and maintaining control over their personal data sharing.</p>
<p>This topic lists high-level requirements related to User
identification in proximity use cases where Users utilise their Wallet Units.</p>
<h5 id="hlrs_14">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ProxId_01</td>
<td>To enable identification using proximity flows, Wallet Units SHALL support device retrieval as specified in ISO/IEC 18013-5 for presenting PID or attestation attributes. Wallet Units SHALL comply with the requirements for mDLs and mdocs ISO/IEC 18013-5. <em>Note: Nominally, ISO/IEC 18013-5 is intended only for mDLs and mDL readers. The corresponding standard for mobile documents in general (including Wallet Units with the EUDI Wallet ecosystem) will be ISO/IEC 23220-4, which is based on ISO/IEC 18013-5. However, the latter standard is not finished yet and therefore cannot be referenced at the moment. To guarantee interoperability between Wallet Units and Relying Party Instances in proximity scenarios, it is necessary to make choices from among the possibilities specified in ISO/IEC 18013-5. Making the same choices as for mDLs ensure this.</em></td>
</tr>
<tr>
<td>ProxId_01a</td>
<td>If a Relying Party supports using proximity flows, its Relying Party Instances SHALL support device retrieval as specified in ISO/IEC 18013-5 for requesting PID or attestation attributes. Such Relying Party Instances SHALL comply with the requirements for mDL readers and mdoc readers in ISO/IEC 18013-5. <em>Note: See note to ProxId_01. Support for proximity flows by Relying Parties is not mandatory.</em></td>
</tr>
<tr>
<td>ProxId_02</td>
<td>Wallet Units, PID Providers, Attestation Providers, Wallet Providers, and Relying Parties SHALL NOT support server retrieval as specified in ISO/IEC 18013-5 for requesting and presenting PID or attestation attributes. <em>Note: Using server retrieval, a Relying Party would request User attributes directly from a PID Provider or Attestation Provider, after having received an authentication and/or authorisation token from the User's Wallet Unit.</em></td>
</tr>
<tr>
<td>ProxId_03</td>
<td>A Wallet Unit SHALL present the presentation request and the identity of the Relying Party to the User when processing the request.</td>
</tr>
<tr>
<td>ProxId_04</td>
<td>A Wallet Unit SHALL request its User to approve the presentation of attributes from their Wallet Unit for proximity identification before presenting them to the Relying Party.</td>
</tr>
<tr>
<td>ProxId_05</td>
<td>A Wallet Unit SHALL transmit the requested User attributes to the requesting Relying Party Instance securely in accordance with ISO/IEC 18013-5 for proximity flows.</td>
</tr>
<tr>
<td>ProxId_06</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<h4 id="a2325-topic-25-unified-definition-and-controlled-vocabularies-for-attributes">A.2.3.25 Topic 25 - Unified definition and controlled vocabularies for attributes</h4>
<h5 id="description_17">Description <!-- omit from toc --></h5>
<p><a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a> describes the
high-level requirements (HLR) for the Rulebooks that will
specify the details of new types of attestations, including QEAAs, PuB-EAAs, and
non-qualified EAAs. This Topic already touched and defined high-level requirements
regarding the catalogue for Attestation Rulebooks.</p>
<p>The following main concepts were defined in
<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>
and developed in the current version of this Topic:</p>
<ul>
<li>Attestation Rulebooks for QEAAs and PuB-EAAs used within the EUDI Wallet
ecosystem may be registered and published in a publicly accessible catalogue.</li>
<li>The Attestation Rulebook catalogue may also include Attestation Rulebooks for
non-qualified EAAs.</li>
<li>The Commission will take measures to establish and maintain the Attestation
Rulebooks catalogue.</li>
<li>The Attestation Rulebooks catalogue will enable mainly Relying Parties, but
also other actors in the EUDI Wallet ecosystem, to know which attestation types
exist, and what is the identifier, syntax, and semantics of each attribute in a
type of attestation.</li>
</ul>
<p>The following points are emphasised:</p>
<ul>
<li>Registration of an Attestation Rulebook in the attestation catalogue is not mandatory.</li>
<li>Registration in the Attestation Rulebook catalogue does not create any
obligation of acceptance of the attestation by any Relying Party, nor does it
necessarily imply cross-border recognition of that attestation.</li>
<li>The Attestation Rulebooks catalogue can be hosted in the same environment as
the catalogue of attributes.</li>
</ul>
<h5 id="hlrs_15">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>CAT_01</td>
<td>The Commission SHALL establish a catalogue of attributes used within the EUDI Wallet ecosystem. <em>Note: The catalogue of attributes does not need to be a separate catalogue, but could be combined with the Attestation Rulebooks catalogue mentioned in CAT_05.</em></td>
</tr>
<tr>
<td>CAT_01a</td>
<td>The Commission SHALL enable any entity to request the registration in the catalogue of one or more attribute(s) of an attestation used within the EUDI Wallet ecosystem.</td>
</tr>
<tr>
<td>CAT_01b</td>
<td>The Schema Provider for an Attestation Rulebook that is a QEAA or PuB-EAA SHOULD request the registration of all attributes in that QEAA or PuB-EAA in the catalogue of attributes. The Schema Provider for an Attestation Rulebook that is a non-qualified EAA MAY request the registration of the attributes in that EAA in the catalogue.</td>
</tr>
<tr>
<td>CAT_02</td>
<td>Empty</td>
</tr>
<tr>
<td>CAT_03</td>
<td>The Commission SHALL make the catalogue of attributes publicly available and machine-readable. <em>Note: The requirement for availability implies setting up the required means for high availability and avoiding a single point of failure.</em></td>
</tr>
<tr>
<td>CAT_03b</td>
<td>The Commission SHALL consider the following semantic artifacts for inclusion in the catalogue of attributes: - <a href="https://interoperable-europe.ec.europa.eu/collection/isa-action-201612-semantic-interoperability-representation-powers-and-mandates-0/solution/representation-powers-and-mandates-ontology">Representation Powers and Mandates (RPaM) Ontology</a>, - <a href="https://www.de4a.eu/semper">SEMPER | DE4A</a>, - <a href="https://interoperable-europe.ec.europa.eu/collection/semic-support-centre/core-vocabularies#What%20are%20the%20Core%20Vocabularies">SEMIC Core Vocabularies</a>, - <a href="https://www.iana.org/assignments/jwt/jwt.xhtml">IANA Registry for JSON Web Token Claims</a> (for JSON-based attributes only), - <a href="https://www.iso.org/standard/86782.html">ISO/IEC 23220-2</a> (for CBOR-based attributes only).</td>
</tr>
<tr>
<td>CAT_04</td>
<td>The Commission SHALL make publicly available the existence and maintenance of the catalogue of attributes mentioned in CAT_01, including processes to propose the registration to public and private parties, allowing to register attributes, and conditions for updating and/or removing attributes. These processes SHALL include archiving and logging changes of the history of the catalogue of attributes in an appropriate way, including versioning. <em>Note: There are layers on top of the attributes that need maintenance as well. So, maintenance in this case is more generic and encompasses more than just the attribute itself.</em></td>
</tr>
</tbody>
</table>
<h4 id="a2326-topic-26-catalogue-of-attestations">A.2.3.26 Topic 26 - Catalogue of attestations</h4>
<h5 id="description_18">Description <!-- omit from toc --></h5>
<p>See <a href="#a2325-topic-25---unified-definition-and-controlled-vocabularies-for-attributes">Topic 25</a>.</p>
<h5 id="hlrs_16">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>CAT_05</td>
<td>The Commission SHALL establish a catalogue of Attestation Rulebooks used within the EUDI Wallet ecosystem. <em>Note: For Attestation Rulebooks, see Topic 12.</em></td>
</tr>
<tr>
<td>CAT_05a</td>
<td>The Commission SHALL enable any entity to register an Attestation Rulebook used within the EUDI Wallet ecosystem.</td>
</tr>
<tr>
<td>CAT_05b</td>
<td>The Schema Provider for an Attestation Rulebook that is a QEAA or PuB-EAA SHOULD register its Rulebook in the catalogue of Attestation Rulebooks. The Schema Provider for an Attestation Rulebook that is a non-qualified EAA MAY register its Rulebook.</td>
</tr>
<tr>
<td>CAT_06</td>
<td>The Commission SHALL make the catalogue publicly available and machine-readable, by hosting the catalogue, or parts of it, including an e-discovery mechanism and/or by referencing to other catalogues. <em>Note: The requirement for availability implies setting up the required means for high availability and avoiding a single point of failure.</em></td>
</tr>
<tr>
<td>CAT_07</td>
<td>The Commission SHALL enable a self-registration process of Attestation Rulebooks, without pre-approval by the registry, for both public and private entities.</td>
</tr>
<tr>
<td>CAT_08</td>
<td>Empty</td>
</tr>
<tr>
<td>CAT_09</td>
<td>The Commission SHALL make publicly available the existence and maintenance of the Attestation Rulebooks catalogue mentioned in CAT_01, including processes to propose the registration to public and private parties, allowing to register an Attestation Rulebook, and conditions for updating and/or removing Attestation Rulebooks. These processes SHALL include archiving and logging changes of the history of the Attestation Rulebooks catalogue in an appropriate way, including versioning.</td>
</tr>
<tr>
<td>CAT_10</td>
<td>The body registering an Attestation Rulebook SHALL include a unique reference to this body and the way to contact it, or how to find information for doing so. <em>Notes: - Topic 12 describes an option for Member State-specific (i.e., domestic) Rulebooks, extending a EU-wide Rulebook. - Rulebooks may also be shared between interested parties in an out-of-band manner.</em></td>
</tr>
<tr>
<td>CAT_11</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<h4 id="a2327-topic-27-registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">A.2.3.27 Topic 27 - Registration of PID Providers, Providers of QEAAs, PuB-EAAs, and non-qualified EAAs, and Relying Parties</h4>
<h5 id="description_19">Description <!-- omit from toc --></h5>
<p>PID Providers, QEAA Providers, PuB-EAA Providers, non-qualified EAA Providers
and Relying Parties register with a Registrar in their Member State. The
main goal of the registration process is for the Registrar registering relevant information about the entity, and make this information available online to interested parties. In addition, the entity will receive an access
certificate that Wallet Units can use to authenticate them. Finally, the entity receives a registration certificate containing the registered information, if the Registrar has a policy of issuing registration certificates.</p>
<p>This Topic specifies high-level requirements related to the registration of the
above mentioned entities.</p>
<h5 id="hlrs_17">HLRs <!-- omit from toc --></h5>
<p>A. <em>General requirements for Member State registration processes</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_01</td>
<td>Member States SHALL provide processes and mechanisms for PID Providers, QEAA Providers, PuB-EAA Providers, non-qualified EAA Providers, and Relying Parties to register in a registry. <em>Note: Member States may choose to implement a single registry for all these roles, or a separate registry for each of these roles.</em></td>
</tr>
<tr>
<td>Reg_01a</td>
<td>Member States SHALL register a common set of data about a) PID Providers, b) QEAA Providers, c) PuB-EAA Providers, d) non-qualified EAA Providers. and e) Relying Parties, according to the relevant requirements in <a href="../../../technical-specifications/ts6-common-set-of-rp-information-to-be-registered/">Technical Specification 6</a>. <em>Note: For PID Providers, QEAA Providers, PuB-EAA Providers, and non-qualified EAA Providers, the common set of data specified in [Technical Specification 6] include the attestation type(s) that the provider intends to issue to Wallet Units.</em></td>
</tr>
<tr>
<td>Reg_01b</td>
<td>Empty</td>
</tr>
<tr>
<td>Reg_02</td>
<td>Member States SHALL make publicly available all necessary details and documentation about the registration processes for their registry.</td>
</tr>
<tr>
<td>Reg_03</td>
<td>Member States SHALL publish the registry entries online, in a sealed or signed machine-readable common format suitable for automated processing, according to the relevant requirements in <a href="../../../technical-specifications/ts5-common-formats-and-api-for-rp-registration-information/">Technical Specification 5</a>, for the purpose of transparency to Users and other stakeholders.</td>
</tr>
<tr>
<td>Reg_04</td>
<td>Member States SHALL make the registry entries available online, in a human-readable format. The website used for this purpose SHALL use a secure channel protecting the authenticity and integrity of the information in the registry during transport. Member States SHALL NOT require authentication or prior registration and authorisation of any person wishing to retrieve the information in the registry.</td>
</tr>
<tr>
<td>Reg_05</td>
<td>Empty</td>
</tr>
<tr>
<td>Reg_06</td>
<td>Member States SHALL support the common API specified in <a href="../../../technical-specifications/ts5-common-formats-and-api-for-rp-registration-information/">Technical Specification 5</a> for to enable automated retrieval of registry entries from the Member States' registries. <em>Note: [Technical Specification 5] specifies the use of a secure channel protecting the authenticity and integrity of the information in the registry during transport, and does not require authentication or prior registration and authorisation of any entity wishing to retrieve the information in the registry.</em></td>
</tr>
<tr>
<td>Reg_07</td>
<td>Empty</td>
</tr>
<tr>
<td>Reg_08</td>
<td>Empty</td>
</tr>
<tr>
<td>Reg_09</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<p>B. <em>General requirements for the issuance of access certificates</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_10</td>
<td>A Member State SHALL ensure that an Access Certificate Authority notified according to [<a href="#a2331-topic-31----notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">Topic 31</a>] issues an access certificate to all PID Providers, QEAA Providers, PuB-EAA Providers, non-qualified EAA Providers, and Relying Parties registered in one of the Member State's registries.</td>
</tr>
<tr>
<td>Reg_11</td>
<td>A Member State SHALL ensure that the issuance process of access certificates by their notified Access Certificate Authority(s) complies with a common Certificate Policy for Access Certificate Authority.</td>
</tr>
<tr>
<td>Reg_12</td>
<td>The Commission SHALL provide technical specifications establishing the common Access Certificate Authority Certificate Policy mentioned in Reg_11.</td>
</tr>
<tr>
<td>Reg_13</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that an Access Certificate Authority logs all issued certificates for Certificate Transparency (CT). <em>Note: This requirement is still under discussion and might be changed or removed in a future version of this ARF.</em></td>
</tr>
<tr>
<td>Reg_14</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that an Access Certificate Authority provides one or more method(s) to revoke the access certificates it issued.</td>
</tr>
<tr>
<td>Reg_15</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL include a policy for revocation, which SHALL require that an Access Certificate Authority revokes an access certificate at least when: - the certificate subject which is a Relying Party is suspended or cancelled by the respective Registrar, - the certificate subject which is a PID Provider, QEAA Provider, PuB-EAA Provider, or non-qualified EAA Provider is suspended or cancelled by the respective Registrar, - on request of the certificate subject, or - on request of a competent national authority.</td>
</tr>
<tr>
<td>Reg_16</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL specify the profile of access certificates in detail.</td>
</tr>
<tr>
<td>Reg_17</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that an access certificate indicates whether its subject is a PID Provider, a QEAA Provider, a PuB-EAA Provider, a non-qualified EAA Provider, or a Relying Party Instance.</td>
</tr>
<tr>
<td>Reg_18</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL define the minimum change history information to be stored for resolving possible disputes regarding registration.</td>
</tr>
</tbody>
</table>
<p>C. <em>Requirements for the registration of PID Providers</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_19</td>
<td>A Member State SHALL approve a PID Provider according to a well-defined policy before including it in its PID Provider Registry. To that end, a Member State SHALL define specific vetting processes and rules of acceptance for inclusion of PID Providers in its Registry.</td>
</tr>
<tr>
<td>Reg_20</td>
<td>A Member State SHALL identify PID Providers at a level of confidence proportionate to the risk arising from the potential harm a fraudulent PID Provider could cause to Users and other stakeholders in the EUDI Wallet ecosystem.</td>
</tr>
<tr>
<td>Reg_20a</td>
<td>A Registrar SHALL provide a method to suspend or cancel a registered PID Provider.</td>
</tr>
<tr>
<td>Reg_20b</td>
<td>A Registrar SHALL have a policy for the suspension or cancellation of a registered PID Provider, which SHALL specify that a PID Provider is suspended or cancelled at least on request of the PID Provider or of a competent national authority.</td>
</tr>
</tbody>
</table>
<p>D. <em>Requirements for the registration of Attestation Providers</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_21</td>
<td>A Member State SHALL approve an Attestation Provider according to a well-defined policy before including it in its Attestation Provider Registry. To that end, a Member State SHALL define specific vetting processes and rules of acceptance for inclusion of Attestation Providers in its Registry. These processes and rules SHOULD consider any relevant differences between QEAA Providers, PuB-EAA Providers, and non-qualified EAA Providers.</td>
</tr>
<tr>
<td>Reg_22</td>
<td>A Member State SHALL identify Attestation Providers (i.e., QEAA Providers, PuB-EAA Providers and non-qualified EAA Providers) at a level of confidence proportionate to the risk arising from the potential harm a fraudulent Attestation Provider could cause to Users and other stakeholders in the EUDI Wallet ecosystem.</td>
</tr>
<tr>
<td>Reg_22a</td>
<td>A Registrar SHALL provide a method to suspend or cancel a registered Attestation Provider.</td>
</tr>
<tr>
<td>Reg_22b</td>
<td>A Registrar SHALL have a policy for the suspension or cancellation of a registered Attestation Provider, which SHALL specify that an Attestation Provider is suspended or cancelled at least on request of the PID Provider or of a competent national authority.</td>
</tr>
</tbody>
</table>
<p>E. <em>Requirements for the registration of Relying Parties</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_23</td>
<td>The Commission SHALL establish a technical specification for a common set of Relying Party information to be registered in Member State registries. This set SHALL include at least the information defined in [European Digital Identity Regulation] <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e1776-1-1">article 5b</a> 2 (c).</td>
</tr>
<tr>
<td>Reg_24</td>
<td>A Member State SHALL enable a Relying Party to register remotely, using an API or user interface.</td>
</tr>
<tr>
<td>Reg_25</td>
<td>A Member State SHALL identify a Relying Party at a level of confidence proportionate to the risk arising from the potential harm a fraudulent Relying Party could cause to Users and other stakeholders in the EUDI Wallet ecosystem.</td>
</tr>
<tr>
<td>Reg_26</td>
<td>A Member State SHALL enable a Relying Party to update the information registered on it using a process comparable to the original registration process, and using the API or user interface mentioned in Reg_24.</td>
</tr>
<tr>
<td>Reg_27</td>
<td>Relying Parties SHALL make any updates necessary to ensure the continued correctness of the registered information without undue delay.</td>
</tr>
<tr>
<td>Reg_28</td>
<td>A Member State's Registry SHALL log all changes made on the information regarding a Relying Party, including at least initial registration, updates, deletion of information, and suspension or cancellation.</td>
</tr>
<tr>
<td>Reg_29</td>
<td>A Registrar SHALL have a policy for the cancellation of a registered Relying Party, which SHALL specify that a Relying Party is cancelled at least on request of the Relying Party or of a competent national authority.</td>
</tr>
<tr>
<td>Reg_30</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<p>F. <em>Requirements for the issuance of Relying Party Instance access certificates</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_31</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that a Relying Party Instance access certificate contains a name for the Relying Party, in a format suitable for presenting to a User. <em>Note: A Wallet Unit needs such a name when requesting User approval according to [<a href="#a236-topic-6---relying-party-authentication-and-user-approval">Topic 6</a>].</em></td>
</tr>
<tr>
<td>Reg_32</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that a Relying Party Instance access certificate contains an EU-wide unique identifier for the Relying Party, and SHALL specify a method for deriving such identifiers. <em>Notes: - The Wallet Instance needs such an identifier at least to send a report of suspicious Relying Party presentation requests to a data protection authority according to <a href="#a2350-topic-50---blueprint-to-report-unlawful-or-suspicious-request-of-data">Topic 50</a>. - The EU-wide unique identifier could, for example, be a composition of a unique identifier of the Registrar, defined in the policy, and a unique identifier for the Relying Party allocated by this Registrar. - This Relying Party identifier is identical in all Relying Party Instance access certificates issued to a given Relying Party.</em></td>
</tr>
</tbody>
</table>
<h4 id="a2328-topic-28-wallet-unit-for-legal-persons">A.2.3.28 Topic 28 - Wallet Unit for legal persons</h4>
<p>Note to this Topic: Legal-person PIDs and Wallet Units for legal persons were
added to the list of topics to be discussed with Member States in the future.</p>
<h5 id="description_20">Description <!-- omit from toc --></h5>
<p>This topic is focused on identifying high-level requirements for a legal-person
Wallet Unit. All core capabilities of a Wallet Unit for a natural person are
available for a legal person. There are some differences between a natural and
legal person that accordingly leads to different requirements for issuing
legal-person PIDs and the Wallet Units containing legal-person PIDs.</p>
<p>Notes:</p>
<ul>
<li>A legal-person PID is issued under an eID scheme.</li>
<li>A legal-person PID is described in a legal-person PID Rulebook,
 which is different from the natural-person PID Rulebook in [PID
 Rulebook]. A legal-person PID has a different attestation type than
 a natural-person PID, and also contains different attributes. For
 example, date of birth or age are not relevant information for legal
 persons. Specifying a different Rulebook for legal-person PIDs
 allows Relying Parties and other Wallet Units to request
 these attributes.  </li>
<li>A legal-person Wallet Solution may be implemented in the same
 manner as a natural-person Wallet Solution, meaning chiefly that it
 is implemented on a mobile device operated by a single User, who is
 a natural person. However, a legal-person Wallet Solution may
 also be implemented as a server-based (web-based) application. In
 the latter case, a Wallet Unit can be used either by one or more
 natural persons appointed by the legal person, or by information
 systems of the legal persons that give an Wallet Unit
 commands in accordance with rules defined by the legal person.</li>
</ul>
<h5 id="hlrs_18">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>LP_01</td>
<td>The Commission SHALL develop a Legal-person PID Rulebook to specify the attribute scheme and other technical details applicable for legal-person PIDs.</td>
</tr>
<tr>
<td>LP_02</td>
<td>The attestation type of a legal-person PID SHALL be different from the attestation type of a natural person PID. <em>Note: See [<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>] for an explanation of the concept of attestation type.</em></td>
</tr>
<tr>
<td>LP_03</td>
<td>A legal-person PID SHALL comply with all requirements in the Legal-person PID Rulebook mentioned in LP_02.</td>
</tr>
</tbody>
</table>
<h4 id="a2329-topic-29-representation-paradigm">A.2.3.29 Topic 29 - Representation paradigm</h4>
<h5 id="description_21">Description <!-- omit from toc --></h5>
<p><strong>Note: The description of this Topic, as well as the High-Level Requirements in it, were developed in the <a href="../../../discussion-topics/i-natural-person-representing-another-natural-person/">Discussion Paper for Topic I</a>. Please see that paper for more information.</strong></p>
<p>Based on the [European Digital Identity Regulation], it should be possible to issue a dedicated representation attestation for a natural person to a representative, in accordance with applicable national and European legislation. For certain use cases (e.g., parent-child relationships), the Attestation Provider of such attestations will be able to retrieve the relevant information from authentic sources at the national level. In other cases (e.g., power of attorney), the represented natural person may be required to explicitly authorize the representative.</p>
<p>Representation attestations for a natural person issued to a representative have a distinct attestation type. The Attestation Rulebook describing this attestation type shall specify the nature of the representation and shall clearly define the operations that the representative is authorized to perform, thereby restricting the scope of their authority.</p>
<p>Furthermore, this representation attestation type (like any other attestation type, see <a href="#a237-topic-7---attestation-revocation-and-revocation-checking">Topic 7</a>) is either short-lived or revocable. In the case of revocable attestations, all entities that, according to applicable law, are entitled to revoke them have the capability to request the Attestation Provider to do so. It is emphasized that the high-level requirements concerning attestation revocation, as defined in <a href="#a237-topic-7---attestation-revocation-and-revocation-checking">Topic 7</a>, also apply to this attestation type.</p>
<p>A User holding a representation attestation is able to represent another natural person when interacting with a Relying Party. The Relying Party is always aware that it is interacting with a legal representative or agent. This is ensured by the fact that the corresponding Wallet Unit presents an attestation having a distinct type, specifically for representation attestations.</p>
<h5 id="hlrs_19">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RP_01</td>
<td>The Commission SHALL create an Attestation Rulebook for representation attestations issued to a natural person representing another natural person. The Rulebook SHALL specify the unique attestation type of these representation attestations. The Rulebook SHALL also specify attributes used for defining a validity period, the nature of the representation, and the operations the representative is authorised to perform, thereby limiting the scope of its authorisation.</td>
</tr>
<tr>
<td>RP_02</td>
<td>An Attestation Provider issuing representation attestations to a natural person representing another natural person SHALL ensure that either the attestations are short-lived or that all entities which, according to applicable law, must have the ability to request revocation of such attestations, are able to do so.</td>
</tr>
</tbody>
</table>
<h4 id="a2330-topic-30-interaction-between-wallet-units">A.2.3.30 Topic 30 - Interaction between Wallet Units</h4>
<h5 id="description_22">Description <!-- omit from toc --></h5>
<p>A User can request another User to present an attestation, where
both Users use their Wallet Unit. This can be done only when their devices are close
together (that is, in physical proximity). In this context, the requesting Wallet Unit is called the Verifier Wallet Unit, and the presenting Wallet Unit is called the Holder Wallet Unit. The User of a Holder Wallet Unit is called a Holder, and the User of a Verifier Wallet Unit is called a Verifier.</p>
<p>This Topic lists the high-level requirements related to the interaction between
two Wallet Units. These are based on the <a href="../../../discussion-topics/j-wallet-to-wallet-interactions/">Discussion Paper for Topic J</a> and on subsequent discussions in the context of <a href="../../../technical-specifications/ts9-wallet-to-wallet-interactions/">Technical Specification 9</a>. For a generic discussion of this topic, please refer to <a href="../../../architecture-and-reference-framework-main/#664-pid-or-attestation-presentation-to-another-wallet-unit">Section 6.4</a> of the ARF main document.</p>
<h5 id="hlrs_20">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>W2W_01</td>
<td>A Wallet Unit SHALL be able to act as a Holder Wallet Unit, in accordance with all requirements in this Topic.</td>
</tr>
<tr>
<td>W2W_02</td>
<td>When acting as a Holder Wallet Unit, if there is a contradiction between a requirement for Holder Wallet Units in this Topic and any requirement for Wallet Units in other Topics in this document, the requirement in this Topic SHALL take precedence. However, when acting as a Holder Wallet Unit, a Wallet Unit SHALL comply with all requirements for Wallet Units in other Topics in this document that do not contradict any requirement in this Topic.</td>
</tr>
<tr>
<td>W2W_03</td>
<td>A Wallet Unit SHALL be able to act as a Verifier Wallet Unit, in accordance with all requirements in this Topic.</td>
</tr>
<tr>
<td>W2W_04</td>
<td>When acting as a Verifier Wallet Unit, a Wallet Unit SHALL NOT comply with any requirement for Wallet Units in other Topics in this document.</td>
</tr>
<tr>
<td>W2W_05</td>
<td>A Wallet Unit SHALL act as a Holder Wallet Unit only if the User selects a 'Holder Wallet Unit mode'. If the User closes the Wallet Unit, or after a period of non-activity, the Wallet Unit SHALL return to 'normal' mode.</td>
</tr>
<tr>
<td>W2W_06</td>
<td>When entering the Holder Wallet Unit mode, a Wallet Unit SHALL inform its User that this mode should only be used for interactions with natural persons using a Wallet Unit, and that the User should not proceed if they are in fact interacting with a Relying Party.</td>
</tr>
<tr>
<td>W2W_07</td>
<td>A Wallet Unit SHALL act as a Verifier Wallet Unit only if the User selects a 'Verifier Wallet Unit mode'. If the User closes the Wallet Unit, or after a period of non-activity, the Wallet Unit SHALL return to 'normal' mode.</td>
</tr>
<tr>
<td>W2W_08</td>
<td>A Verifier Wallet Unit and a Holder Wallet Unit SHALL support attestation presentation only in proximity, meaning they SHALL support only [ISO/IEC 18013-5] to communicate.</td>
</tr>
<tr>
<td>W2W_09</td>
<td>Holder Wallet Units SHALL comply with the requirements for mDLs and for mdocs in ISO/IEC 18013-5, unless specified differently in <a href="../../../technical-specifications/ts9-wallet-to-wallet-interactions/">Technical Specification 9</a>.</td>
</tr>
<tr>
<td>W2W_10</td>
<td>Verifier Wallet Units SHALL comply with the requirements for mDL readers and for mdoc readers in ISO/IEC 18013-5, unless specified differently in <a href="../../../technical-specifications/ts9-wallet-to-wallet-interactions/">Technical Specification 9</a>.</td>
</tr>
<tr>
<td>W2W_11</td>
<td>A Holder Wallet Unit SHOULD provide the Holder, through a user-friendly UI, with the option to inform the Verifier Wallet Unit about the attributes which the Verifier should include in the presentation request, by sending a presentation offer. If the Holder creates a presentation offer, the Holder Wallet Unit SHALL transfer it to the Verifier Wallet Unit as specified in <a href="../../../technical-specifications/ts9-wallet-to-wallet-interactions/">Technical Specification 9</a>. <em>Note: This will use an extension of the device engagement structure specified in ISO/IEC 18013-5.</em></td>
</tr>
<tr>
<td>W2W_12</td>
<td>A Holder Wallet Unit SHALL recommend the Holder to create a presentation offer, as this will increase the chance of success of the use case.</td>
</tr>
<tr>
<td>W2W_13</td>
<td>A Verifier Wallet Unit SHALL provide the Verifier, through a user-friendly UI, with the possibility to select the attributes that will be included in the presentation request.</td>
</tr>
<tr>
<td>W2W_14</td>
<td>For the purposes of W2W_07, if the Verifier Wallet Unit received a presentation offer, it SHALL present this offer to the Verifier, and enable the Verifier to include one or more of the attributes in the offer into the presentation request. However, the Verifier Wallet Unit SHALL NOT allow the Verifier to include any attribute not present in the offer.</td>
</tr>
<tr>
<td>W2W_15</td>
<td>For the purposes of W2W_07, if the Verifier Wallet Unit did not receive a presentation offer, it SHALL present the Verifier with a list of attributes that can be included in the presentation request. The Verifier Wallet Unit MAY ask the Verifier some questions about the purpose of the use case to narrow down the list.</td>
</tr>
<tr>
<td>W2W_16</td>
<td>A Verifier Wallet Unit SHALL authenticate the Verifier according to WIAM_15 and SHALL obtain the User's approval prior to sending a presentation request to a Holder Wallet Unit.</td>
</tr>
<tr>
<td>W2W_17</td>
<td>A Verifier Wallet Unit SHALL implement measures to limit the number of presentation requests it can send per unit of time, to prevent abuse of the Wallet-to-Wallet functionality by Relying Parties. The limitation strategy, for instance exponential backoff time between subsequent presentation requests or hard limits for the number of requests, SHALL be decided by the Wallet Provider, based on applicable requirements in <a href="../../../technical-specifications/ts9-wallet-to-wallet-interactions/">Technical Specification 9</a>.</td>
</tr>
<tr>
<td>W2W_18</td>
<td>When receiving a presentation request, a Holder Wallet Unit SHOULD verify the validity of the Verifier Wallet Unit before presenting a received request to the Holder, provided <a href="../../../technical-specifications/ts9-wallet-to-wallet-interactions/">Technical Specification 9</a> specifies a suitable mechanism for doing so.</td>
</tr>
<tr>
<td>W2W_19</td>
<td>When receiving a presentation response, a Verifier Wallet SHALL verify the received attestation according to requirements OIA_12 - OIA_15 in <a href="#a231-topic-1---accessing-online-services-with-a-wallet-unit">Topic 1</a>.</td>
</tr>
<tr>
<td>W2W_20</td>
<td>A Verifier Wallet Unit SHALL display all verified attributes to the Verifier.</td>
</tr>
<tr>
<td>W2W_21</td>
<td>A Verifier Wallet Unit SHALL NOT persistently store any attestations or attributes received. A Verifier Wallet Unit SHOULD minimize the time the received presentation is stored in memory. A Verifier Wallet Unit SHALL comply with OIA_16 in <a href="#a231-topic-1---accessing-online-services-with-a-wallet-unit">Topic 1</a>.</td>
</tr>
<tr>
<td>W2W_22</td>
<td>Wallet Providers SHOULD take measures to prevent a User from taking screenshots while their Wallet Unit is acting as a Verifier Wallet Unit.</td>
</tr>
</tbody>
</table>
<h4 id="a2331-topic-31-notification-and-publication-of-pid-provider-wallet-provider-attestation-provider-access-certificate-authority-and-provider-of-registration-certificates">A.2.3.31 Topic 31 -  Notification and publication of PID Provider, Wallet Provider, Attestation Provider, Access Certificate Authority, and Provider of registration certificates</h4>
<h5 id="description_23">Description <!-- omit from toc --></h5>
<p>PID Providers, PuB-EAA Providers, Wallet Providers, Access Certificate
Authorities, and Providers of registration certificates must be notified by a Member State to the Commission. As part of the
notification process, the trust anchors of these parties must be included in a Trusted List. A trust anchor is the combination of a public key and an
identifier for the associated entity. Trust anchors are required for the
verification of the signatures of PIDs, attestations, WUAs, access
certificates and registration certificates that are issued by these parties.</p>
<p>Note: Notification does not apply to QEAA Providers and (non-qualified) EAA Providers, as explained in Sections D and F below, respectively.</p>
<p>This Topic contains High-Level Requirements for the notification of these
parties by Member States, and for the publication of the notified information by the Commission.</p>
<h5 id="hlrs_21">HLRs <!-- omit from toc --></h5>
<p>A. Generic requirements for notification</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>GenNot_01</td>
<td>Member States SHALL notify all PID Providers, PuB-EAA Providers, Wallet Providers, Access Certificate Authorities, and Providers of registration certificates to the European Commission, according all relevant requirements in <a href="../../../technical-specifications/ts2-notification-publication-provider-information/">Technical Specification 2</a>.</td>
</tr>
<tr>
<td>GenNot_02</td>
<td>As part of [Technical Specification 2] referred to in GenNot_01, the European Commission SHALL establish standard operating procedures for the notification of a PID Provider, PuB-EAA Provider, Wallet Provider, Access Certificate Authority, or Provider of registration certificates to the Commission. <em>Note: The outcome of the notification procedure is the publication of the information notified by the Member State according to <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e1347-1-1">Article 5a</a> (18) in a machine and human readable manner using the common system mentioned in Section H, TLPub_01.</em></td>
</tr>
<tr>
<td>GenNot_03</td>
<td>The common system mentioned in GenNot_01 SHALL enable: - A secure notification channel between Member States and the Commission for all notifications. - A notification, verification, and publication process and associated validation steps (with follow-up and monitoring) at the Commission side. - Collected data to be processed, consolidated, signed or sealed, and published in both a machine-processable Trusted List and in a human-readable format, manually and/or automatically using e.g. a web service and/or API.</td>
</tr>
<tr>
<td>GenNot_04</td>
<td>As regard to GenNot_03, second bullet, the Commission SHALL verify whether the notified data is complete and meets the technical specifications, while the Member States SHALL be responsible for the correctness of the notified information.</td>
</tr>
<tr>
<td>GenNot_05</td>
<td>As part of the specifications referred to in GenNot_01, the European Commission SHALL establish standard operating procedures for the suspension or cancellation of a PID Provider, PuB-EAA Provider, Wallet Provider, Access Certificate Authority, or Provider of registration certificates. These operating procedures SHALL include unambiguous conditions for suspension or cancellation. As an outcome of the suspension or cancellation procedure, the status of the suspended or cancelled PID Provider, PuB-EAA Provider, Wallet Provider, Access Certificate Authority or Provider of registration certificates in the Trusted List SHALL be changed to Invalid.</td>
</tr>
</tbody>
</table>
<p>B. Requirements for the notification of PID Providers</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PPNot_01</td>
<td>The European Commission SHALL establish technical specifications for the common set of information to be notified about PID Providers.</td>
</tr>
<tr>
<td>PPNot_02</td>
<td>The common set of information to be notified about a PID Provider SHALL include at least: 1. Identification data: i. MS/Country of establishment, ii. Name as registered in an official record, iii. Where applicable: a. A business registration number from an official record, b. Identification data from that official record. 2. PID Provider trust anchors, i.e., public keys and name as per point 1) ii) above, supporting the authentication of PIDs issued by the PID Provider, 3. Trust anchors of Access Certificate Authorities for PID Providers, i.e., public keys and CA name, supporting the authentication of the PID Provider by Wallet Units at the service supply point(s) listed per point 4. below. 4. Service supply point(s), i.e., the URL(s) at which a Wallet Unit can start the process of requesting and obtaining a PID. <em>Notes: - Relating to point 3. above: PID Provider Access Certificate Authority trust anchors are notified separately from the Access Certificate Authority for Relying Parties (see Section G below), since PID Providers are -legally speaking- not Relying Parties. - For the concept of an Access Certificate Authority, see also [<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>] and <a href="../../../architecture-and-reference-framework-main/#632-pid-provider-or-attestation-provider-registration-and-notification">Section 6.3.2 of the ARF main document</a>.</em></td>
</tr>
<tr>
<td>PPNot_03</td>
<td>PID Providers SHALL ensure that all PIDs they issue can be authenticated using the PID Provider trust anchors notified to the Commission.</td>
</tr>
<tr>
<td>PPNot_04</td>
<td>PID Providers SHALL ensure that their PID Provider access certificates can be authenticated using the applicable Access Certificate Authority trust anchors notified to the Commission. <em>Note: [<a href="#a236-topic-6---relying-party-authentication-and-user-approval">Topic 6</a>] describes how access certificates will be used.</em></td>
</tr>
<tr>
<td>PPNot_05</td>
<td>PID Provider trust anchors SHALL be accepted because of their secure notification by the Member States to the Commission and by their publication in the corresponding Commission-compiled PID Provider Trusted List which is sealed by the Commission.</td>
</tr>
<tr>
<td>PPNot_06</td>
<td>Access Certificate Authority trust anchors SHALL be accepted because of their secure notification by the Member States to the Commission and by their publication in the corresponding Commission-compiled Access Certificate Authority Trusted List which is signed or sealed by the Commission.</td>
</tr>
<tr>
<td>PPNot_07</td>
<td>The format of the PID Provider Trusted List SHALL comply with ETSI TS 119 612 v2.1.1 or with a suitable profile similarly derived from ETSI TS 102 231.</td>
</tr>
</tbody>
</table>
<p>C. Requirements for the notification of Wallet Providers</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WPNot_01</td>
<td>The European Commission SHALL establish technical specifications for the common set of information to be notified about Wallet Providers.</td>
</tr>
<tr>
<td>WPNot_02</td>
<td>The common set of information to be notified about a Wallet Provider SHALL include: 1. Identification data: i. MS/Country of establishment, ii. Name as registered in an official record, iii. Where applicable: a. Business registration number from an official record, and b. Identification data from the official record. 2. Wallet Provider trust anchors, i.e., public keys and name as per point 1. b. above, supporting the authentication of Wallet Unit Attestations issued by the Wallet Provider. <em>Notes: - See [<a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a>] and [<a href="#a2338-topic-38---wallet-unit-revocation">Topic 38</a>] for the definition of the WUA. - A Wallet Provider does not need an access certificate to interact with Wallet Units.</em></td>
</tr>
<tr>
<td>WPNot_03</td>
<td>Wallet Providers SHALL ensure that all WUAs they issue can be authenticated using the trust anchors notified to the Commission.</td>
</tr>
<tr>
<td>WPNot_04</td>
<td>Wallet Provider trust anchors SHALL be accepted because of their secure notification by the Member States to the Commission and by their publication in the corresponding Commission-compiled Wallet Provider Trusted List which is sealed by the Commission.</td>
</tr>
<tr>
<td>WPNot_05</td>
<td>The format of the Wallet Provider Trusted List SHALL comply with ETSI TS 119 612 v2.1.1 or with a suitable profile similarly derived from ETSI TS 102 231.</td>
</tr>
<tr>
<td>WPNot_06</td>
<td>If a Wallet Provider is cancelled (see requirement GenNot_05 above), that Wallet Provider SHALL immediately revoke all of its valid WUAs, in accordance with the requirements in <a href="#a2338-topic-38---wallet-unit-revocation">Topic 38</a>. If a Wallet Provider is suspended, that Wallet Provider and the Member State SHALL agree on the necessary precautionary measures that need to be taken, which MAY include the immediate revocation of all or some of its valid WUAs.</td>
</tr>
</tbody>
</table>
<p>D. Requirements for the notification of QEAA Providers</p>
<p>There is no notification of QEAA Provider foreseen by the [European Digital
Identity Regulation], except for establishing the <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=uriserv%3AOJ.L_.2014.257.01.0073.01.ENG#d1e2162-73-1">Art. 22</a>
Trusted List once a qualified status is granted. QTSPs issuing QEAAs to Wallet
Units SHALL abide by the Implementing Act to be adopted under <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e3849-1-1">Art. 45d</a>(5).</p>
<p>E. Requirements for the notification of PuB-EAA Providers</p>
<p>This notification is pursuant to
<a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e3902-1-1">Art.45f</a>(3)
and to the implementing acts to be adopted pursuant to
<a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e3902-1-1">Art.45f</a>(7).
It should be noted that the purpose of this notification is mainly to the
attention of QTSPs issuing qualified certificates for electronic signatures or
seals to those public sector bodies referred to in <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e739-1-1">Article
3</a>,
point (46), and identified as the issuer in the PuB-EAA. The Trusted List
compiled by the Commission is deemed to be a constitutive list of such
<a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e739-1-1">Art.3</a>(46)
bodies recognised for issuing PUB-EAAs. Consequently, QTSPs are expected to
verify such lists prior to issuing a qualified certificate to any entity
claiming to be a
<a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e739-1-1">Art.3</a>(46)
body.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PuBPNot_01</td>
<td>The European Commission SHALL establish technical specifications for the common set of information to be notified about PuB-EAA Providers.</td>
</tr>
<tr>
<td>PuBPNot_02</td>
<td>The common set of information to be notified by Member States about PuB-EAA Providers SHALL include at least: 1. Identification data: i. MS/Country of establishment, ii. Name as registered in an official record, iii. Where applicable: a. Registration number as in official record, and b. Official record identification data. iv. Identification data of the Union or national law under which a. Either the PuB-EAA Provider is established as the responsible body for the Authentic Source based on which the electronic attestation of attributes is issued, or b. The PuB-EAA Provider is the body designated to act on behalf of the responsible body referred to in point 1. iv. a. v.The conformity assessment report issued by a conformity assessment body, confirming that the requirements set out in paragraphs 1, 2 and 6 of <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e3902-1-1">Article 45f</a> are met. 2. Service supply point(s), i.e., the URL(s) at which a Wallet Unit can start the process of requesting and obtaining a PuB-EAA from the PuB-EAA Provider.</td>
</tr>
<tr>
<td>PuBPNot_03</td>
<td>The format of the PuB-EAA Provider Trusted List SHALL comply with ETSI TS 119 612 v2.1.1 or with a suitable profile similarly derived from ETSI TS 102 231.</td>
</tr>
</tbody>
</table>
<p>F. Requirements for the notification of non-qualified EAA Providers</p>
<p>There is no notification of non-qualified EAA Providers foreseen by the
[European Digital Identity Regulation]. As stated in [<a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>],
the Schema Provider for an Attestation Rulebook describing a type of attestation
that is an EAA defines in the Rulebook the mechanisms allowing a Relying Party
to obtain, in a trustworthy manner, the trust anchor(s) of EAA Providers issuing
this type of EAA.</p>
<p>G. Requirements for the notification of Access Certificate Authorities and Providers of registration certificates</p>
<p>Access Certificate Authorities (CA) are responsible for
signing access certificates they issue to PID Providers, QEAA Providers, PuB-EAA Providers,
and non-qualified EAA Providers, as well as to Relying Parties. For more information about Access Certificate Authorities, see [<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>].</p>
<p>Providers of registration certificates are responsible for signing registration certificates they issue to PID Providers, QEAA Providers, PuB-EAA Providers, and non-qualified EAA Providers, as well as to Relying Parties. For more information about Access Certificate Authorities, see [<a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>].</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPACANot_01</td>
<td>The European Commission SHALL establish technical specifications for the common set of information to be notified about Access Certificate Authorities and Providers of registration certificates.</td>
</tr>
<tr>
<td>RPACANot_02</td>
<td>The common set of information to be notified about an Access Certificate Authority or a Provider of registration certificates SHALL include: 1. Identification data: i) Member State or country of establishment, ii) Name as registered in an official record, iii) Where applicable: - A business registration number from an official record, - Identification data from that official record. 2. Trust anchors of the Access Certificate Authority or Provider of registration certificates, i.e., public keys and name as per point 1) ii), supporting the authentication of Relying Parties, PID Providers, QEAA Providers, PuB-EAA Providers, and non-qualified EAA Providers by Wallet Units.</td>
</tr>
<tr>
<td>RPACANot_03</td>
<td>Relying Parties, PID Providers, QEAA Providers, PuB-EAA Providers, and non-qualified EAA Providers SHALL ensure that their access certificates can be authenticated using the trust anchors of an Access Certificate Authority notified to the Commission.</td>
</tr>
<tr>
<td>RPACANot_03a</td>
<td>Relying Parties, PID Providers, QEAA Providers, PuB-EAA Providers, and non-qualified EAA Providers SHALL ensure that their registration certificates, if issued to them, can be authenticated using the trust anchors of a Provider of registration certificates notified to the Commission.</td>
</tr>
<tr>
<td>RPACANot_04</td>
<td>The trust anchors of Access Certificate Authorities and Providers of registration certificates SHALL be accepted because of their secure notification by the Member States to the Commission and by their publication in the corresponding Commission-compiled Trusted Lists, which are signed or sealed by the Commission.</td>
</tr>
<tr>
<td>RPACANot_05</td>
<td>The format of the Trusted Lists mentioned in RPACANot_04 SHALL comply with ETSI TS 119 612 v2.1.1 or with a suitable profile similarly derived from ETSI TS 102 231.</td>
</tr>
<tr>
<td>RPACANot_06</td>
<td>If an Access Certificate Authority is suspended or cancelled (see requirement GenNot_05 above), that Access Certificate Authority SHALL immediately revoke all of its temporally valid access certificates. <em>Note: This implies that if an intermediary obtained its access certificates from an Access Certificate Authority that is suspended or cancelled, any intermediated Relying Parties depending on that intermediary will not be able to request attributes from Wallet Units, even though it has valid registration certificates. Such an intermediated Relying Party will either have to transit to another intermediary (which has access certificates issued by an active Access Certification Authority) or wait until the original intermediary obtains new access certificates either from another Access CA or from the original one, once that CA can continue its operations.</em></td>
</tr>
<tr>
<td>RPACANot_07</td>
<td>If a Provider of registration certificates is suspended or cancelled (see requirement GenNot_05 above), that Provider SHALL immediately revoke all of its valid registration certificates (if any). Moreover, the corresponding Registrar SHALL prohibit all access to the registry entries published online per Reg_03 and Reg_04.</td>
</tr>
</tbody>
</table>
<p>H. Requirements for the publication of Trusted Lists compiled by the
 Commission</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>TLPub_01</td>
<td>The European Commission SHALL establish technical specifications for the system enabling the publication by the Commission of the information notified by the Member States regarding PID Providers, Wallet Providers, PuB-EAA Providers, Access Certificate Authorities, and Providers of registration certificates.</td>
</tr>
<tr>
<td>TLPub_02</td>
<td>The European Commission SHALL establish technical specifications for the set of information to be published about PID Providers, Wallet Providers, PuB-EAA Providers, Access Certificate Authorities and Providers of registration certificates, based on the information notified by the Member States. <em>Note: The information to be published MAY be different from the information to be notified per requirements PPNot_01, WPNot_01, PuBPNot_01, and RPACANot_01 above, respectively.</em></td>
</tr>
<tr>
<td>TLPub_03</td>
<td>The publication of the information referred to in TLPub_01 SHALL take place over a secure channel protecting the authenticity and integrity of the published information.</td>
</tr>
<tr>
<td>TLPub_04</td>
<td>The technical system mentioned in TLPub_01 SHALL NOT require authentication or prior registration and authorisation of any entity wishing to retrieve the published information.</td>
</tr>
<tr>
<td>TLPub_05</td>
<td>The information referred to in TLPub_01 SHALL be published in an electronically signed or sealed form that is suitable for automated processing, and in a human-readable format, e.g., through introspection and display facilities, over an authenticated channel.</td>
</tr>
<tr>
<td>TLPub_06</td>
<td>The Commission SHALL publish in the OJEU the locations of the Trusted Lists for PID Providers, Wallet Providers, PuB-EAA Providers, Access Certificate Authorities, and Providers of registration certificates.</td>
</tr>
<tr>
<td>TLPub_07</td>
<td>The Commission SHALL publish in the OJEU the trust anchors to be used for verifying the signature or seal mentioned in TLPub_05.</td>
</tr>
<tr>
<td>TLPub_08</td>
<td>As part of the specifications referred to in TLPub_01, the European Commission SHALL establish technical specifications for ensuring the availability and authenticity of the full history regarding the information notified about PID Providers, Wallet Providers, PuB-EAA Providers, Access Certificate Authorities, and Providers of registration certificates.</td>
</tr>
</tbody>
</table>
<h4 id="a2332-topic-32-pid-interoperability">A.2.3.32 Topic 32 - PID interoperability</h4>
<p>See <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>.</p>
<h4 id="a2333-topic-33-wallet-unit-backup-and-restore">A.2.3.33 Topic 33 - Wallet Unit backup and restore</h4>
<h5 id="description_24">Description <!-- omit from toc --></h5>
<p>Backup and restore functionality is needed in case the User has lost access to
their current Wallet Unit, for example in case of loss, theft, or breakdown. It
is also needed if the User wants to start using another Wallet Unit, for example
because they have bought a new device, need to factory-reset their existing
device, or want to migrate to another Wallet Solution. In all of these cases,
the User wants to restore the PIDs and attestations in their existing Wallet
Unit on their new Wallet Unit, with as minimal an effort as possible.</p>
<p>The [European Digital Identity Regulation] does not contain a requirement
mandating backup and restore functionality in the Wallet. However, Wallet
Providers should implement backup and restore functionality nevertheless,
because it will be expected by Users. In fact, the requirements in <a href="#a2334-topic-34---migrate-to-a-different-wallet-solution">Topic 34</a>
also ensure the possibility of backup and restore.</p>
<h5 id="hlrs_22">HLRs <!-- omit from toc --></h5>
<p>There are no specific requirements in this Topic.</p>
<h4 id="a2334-topic-34-migrate-to-a-different-wallet-solution">A.2.3.34 Topic 34 - Migrate to a different Wallet Solution</h4>
<h5 id="description_25">Description <!-- omit from toc --></h5>
<p>Article 5a 4 (g) of the [European Digital Identity Regulation] ensures the
User's rights to data portability. Data portability means that a User can
migrate to a different Wallet Solution. The User installs an instance of the new
Wallet Solution, and then wants to restore the PIDs and attestations in their
existing Wallet Unit to their new Wallet Unit. This should be possible with as
minimal an effort as possible, and independent of whether the User still has
access to their existing Wallet Unit.</p>
<p>The solution described in this Topic is to introduce a Migration Object in each
Wallet Unit. This object is a list of PIDs and attestations contained in the
Wallet Unit, together with the information needed to request (re-)issuance of
that PID or attestation. In addition, the Migration Object also contains the transaction log kept by the Wallet Unit, see <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>. Note that the Migration Object does not contain any
private keys of PIDs or attestations. In most security
architectures for a Wallet Solution described in <a href="../../../architecture-and-reference-framework-main/#45-wscd-architecture-types">Section 4.5 of the ARF main document</a>, this is
impossible, since the WSCA/WSCD that contains these private keys does not allow
their extraction under any circumstances. An exception may be architectures in
which attestation private keys are managed in a remote HSM and the migration is
to a new Wallet Unit of the same Wallet Provider. However, in such cases,
restoring functionality of the PIDs and attestations in a new Wallet Unit does
not necessitate that private keys must be exported to another HSM. Rather, it
implies the User must be able to authenticate towards the existing HSM from the
new Wallet Unit, and be recognised as an existing User.</p>
<p>The fact that the Migration Object does not contain private keys means that PIDs
and attestations cannot be backed up and restored from the object in such a way
that they are usable in a new Wallet Unit without involvement of the PID
Provider or Attestation Provider. Instead, the User must ask the respective PID
Provider(s) or Attestation Provider(s) to issue the PID(s) or attestation(s) existing on the User's old Wallet Unit once again to the new Wallet Unit. The only function of the Migration Object is to simplify
this process by listing the PIDs and attestations present in the existing Wallet
Unit, together with the information needed by the new Wallet Unit to start the
issuance process.</p>
<p>The Migration Object does not contain attribute values or attribute identifiers,
as that data is considered sensitive and is not useful anyway because of the
limitations explained above. Instead, the object contains a list of
attestation types and the related Attestation Providers. However, even this
limited information may be considered sensitive in some cases. Therefore, the
Migration Object is stored in such a way that its confidentiality is ensured and
that it can be used only by the User.</p>
<h5 id="hlrs_23">HLRs <!-- omit from toc --></h5>
<p>A. Back-up requirements</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Mig_01</td>
<td>A Wallet Unit SHALL include and keep up-to-date a Migration Object, containing the following information: - The contents of the log for all transactions executed through the Wallet Unit, as listed in requirement DASH_02. - A list of PIDs and attestations, except Wallet Unit Attestations, present in the Wallet Unit, according to the requirements in this Topic.</td>
</tr>
<tr>
<td>Mig_02</td>
<td>The Commission SHALL define a technical specification of the Migration Object.</td>
</tr>
<tr>
<td>Mig_03</td>
<td>For each PID or attestation that is issued to it, a Wallet Unit SHALL add to the Migration Object all data necessary to request issuance of that PID or attestation once again. This SHALL include at least the attestation type and the PID Provider or Attestation Provider that issued the PID or attestation, as well as their service supply points. However, the Migration Object SHALL NOT contain attribute identifiers or attribute values, and SHALL NOT contain any private keys of the PID or attestation.</td>
</tr>
<tr>
<td>Mig_03a</td>
<td>If the User deletes a PID or attestation from their Wallet Unit, the Wallet Unit SHALL delete the corresponding entry from the Migration Object.</td>
</tr>
<tr>
<td>Mig_04</td>
<td>The Wallet Unit SHALL store the Migration Object in an external storage or remote storage location of the User's choice, from among the storage options supported by the Wallet Unit, in such a way that the User can still retrieve the object from a new Wallet Unit in case the existing Wallet Unit becomes unavailable. <em>Notes: - It is up to the Wallet Provider to decide which external storage options or remote storage locations the Wallet Unit supports for storing the Migration Object. - The new Wallet Unit may be either an instance of the same Wallet Solution as the old one, or an instance of a different Wallet Solution.</em></td>
</tr>
<tr>
<td>Mig_05</td>
<td>The Wallet Unit SHALL store the Migration Object in such a way that its confidentiality, integrity, and authenticity is protected and that it is protected against use by others than the User. <em>Note: This could be done, for example, by using password-based cryptography to encrypt the object.</em></td>
</tr>
</tbody>
</table>
<p>B. Restore Requirements</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Mig_06</td>
<td>Directly after installation of a new Wallet Instance, the Wallet Instance SHALL enable the User to import a Migration Object from an external storage or remote storage location indicated by the User, from among the storage options supported by the Wallet Unit.</td>
</tr>
<tr>
<td>Mig_07</td>
<td>When importing a Migration Object, for each PID and attestation listed in the Migration Object, the Wallet Unit SHALL enable the User to select that PID or attestation. When selected, the Wallet Unit SHALL request the respective PID Provider or Attestation Provider to re-issue that PID or attestation. If the Migration Object lists a PID, the PID SHALL be the first to be restored.</td>
</tr>
<tr>
<td>Mig_07a</td>
<td>When importing a Migration Object, the Wallet Unit SHALL ask the User whether they want to restore the log from the Migration Object. When the User agrees, the Wallet Unit SHALL restore the log, and SHALL append future transactions to this log according to the requirements in <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>.</td>
</tr>
<tr>
<td>Mig_08</td>
<td>Empty</td>
</tr>
<tr>
<td>Mig_09</td>
<td>Empty</td>
</tr>
<tr>
<td>Mig_10</td>
<td>Empty</td>
</tr>
<tr>
<td>Mig_11</td>
<td>The processes and interfaces used for issuance of a PID or attestation as part of a migration process SHALL be the same as those used for a 'normal' issuance process, as specified in <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>.</td>
</tr>
<tr>
<td>Mig_12</td>
<td>Empty</td>
</tr>
<tr>
<td>Mig_13</td>
<td>Empty</td>
</tr>
<tr>
<td>Mig_14</td>
<td>Empty</td>
</tr>
<tr>
<td>Mig_15</td>
<td>Empty</td>
</tr>
<tr>
<td>Mig_16</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<h4 id="a2335-topic-35-pid-issuance-service-blueprint">A.2.3.35 Topic 35 - PID issuance service blueprint</h4>
<h5 id="description_26">Description <!-- omit from toc --></h5>
<p>This Topic analyses the User journeys for PID issuance to a Wallet
Unit. This Topic focuses on natural persons only.</p>
<h5 id="hlrs_24">HLRs <!-- omit from toc --></h5>
<p>No HLRs are present for this Topic. Note that issuance of PID is discussed in <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>; relevant HLRs can be found there.</p>
<h4 id="a2336-topic-36-risk-analysis-of-the-wallet-usage">A.2.3.36 Topic 36 - Risk Analysis of the Wallet usage</h4>
<p>There are no HLRs for this Topic.</p>
<h4 id="a2337-topic-37-qes-remote-signing-technical-requirements">A.2.3.37 Topic 37 - QES -- Remote Signing - Technical Requirements</h4>
<p>See <a href="#a2316-topic-16---signing-documents-with-a-wallet-unit">Topic 16</a>.</p>
<h4 id="a2338-topic-38-wallet-unit-revocation">A.2.3.38 Topic 38 - Wallet Unit revocation</h4>
<h5 id="description_27">Description <!-- omit from toc --></h5>
<p>This Topic discusses Wallet Unit revocation. In particular, it answers the
following questions: - How can a Wallet Provider revoke a Wallet Unit? - During
issuance of an attestation, how can an Attestation Provider verify whether a
Wallet Unit has been revoked? - When requesting attributes from an attestation, how
can a Relying Party verify whether a Wallet Unit has been revoked?</p>
<p>Related to the last question, [CIR 2024/2977], Article 5, 4.(b) says "Where
providers of person identification data revoke person identification data issued
to wallet units, they shall do so (...) where the wallet unit attestation to
which the person identification data was issued to has been revoked". This
implies that if a Relying Party verifies that a PID it obtained from a Wallet
Unit is valid (i.e., not revoked), it can trust that the Wallet Unit is also
valid. Consequently, there is no need for a separate mechanism that would allow
the Relying Party to verify the revocation status of a Wallet Unit directly with
the Wallet Provider. Although the CIR requires this mechanism only for PIDs,
other Attestation Providers may similarly revoke an attestation if the Wallet
Unit on which it resides is revoked. Note that if an Attestation Provider does
not support this, a Relying Party obtaining an attestation from a Wallet Unit
has no way of knowing whether the Wallet Unit is revoked. Depending on the value
of the attestation, this risk may be acceptable for the Relying Party.</p>
<p>In case of a security issue, Article 5e of the [European Digital Identity
Regulation] requires Wallet Providers to first suspend a Wallet Unit and to
revoke it only if the issue cannot be solved within three months. However, the
suspension of a Wallet Unit is an administrative process, which does not imply
that the WUAs of that Wallet Unit need to be suspended, as opposed to being
revoked. Instead, if the Wallet Provider administratively suspends a Wallet
Unit, it will immediate revoke all corresponding WUAs. If (within three months)
the situation is remedied and the Wallet Unit can be re-instated, the Wallet
Provider will issue one or more new WUAs to the Wallet Unit.</p>
<h5 id="hlrs_25">HLRs <!-- omit from toc --></h5>
<p>A. Issuing a Wallet Unit Attestation</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WURevocation_01</td>
<td>To enable a PID Provider or an Attestation Provider to verify the authenticity and the revocation status of a Wallet Unit it is interacting with, a Wallet Provider SHALL issue one or more Wallet Unit Attestations to the Wallet Unit, as specified in Topic 9. <em>Note: The first of these WUAs will be issued during the activation phase of a Wallet Unit. During the lifetime of the Wallet Unit, the Wallet Provider will re-issue WUAs as needed.</em></td>
</tr>
<tr>
<td>WURevocation_02</td>
<td>During the lifetime of the Wallet Unit, the Wallet Provider SHALL ensure that the Wallet Unit at all times is in possession of at least one valid WUA.</td>
</tr>
<tr>
<td>WURevocation_03</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_04</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_05</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<p>A. Revoking a Wallet Unit</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WURevocation_06</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_07</td>
<td>A Wallet Provider SHALL be able to revoke a Wallet Unit by revoking its WUA(s), as specified in [<a href="#a237-topic-7---attestation-revocation-and-revocation-checking">Topic 7</a>].*</td>
</tr>
<tr>
<td>WURevocation_08</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_09</td>
<td>During the lifetime of a Wallet Unit, the Wallet Provider SHALL regularly verify that the security of the Wallet Unit is not breached or compromised. If the Wallet Provider detects a security breach or compromise, the Wallet Provider SHALL analyse its cause(s) and impact(s). If the breach or compromise affects the trustworthiness or reliability of the Wallet Unit, the Wallet Provider SHALL administratively revoke or suspend the Wallet Unit and SHALL immediately revoke the corresponding WUA(s). The Wallet Provider SHALL do so at least in the following circumstances: - If the security of the Wallet Unit, or the security of the mobile device and OS on which the corresponding Wallet Instance is installed, or the security of a WSCA/WSCD it uses for managing cryptographic keys and sensitive data, is breached or compromised in a manner that affects its trustworthiness or reliability. - If the security of the Wallet Solution is breached or compromised in a manner that affects the trustworthiness or reliability of all corresponding Wallet Units. - If the security of the common authentication and data protection mechanisms used by the Wallet Unit is breached or compromised in a manner that affects their trustworthiness or reliability. - If the security of the electronic identification scheme under which the Wallet Unit is provided is breached or compromised in a manner that affects its trustworthiness or reliability.</td>
</tr>
<tr>
<td>WURevocation_9b</td>
<td>If within three months from an administrative suspension of a Wallet Unit the security breach or compromise is remedied, the Wallet Provider SHALL issue one or more WUAs to the Wallet Unit, such that the User can again use it.</td>
</tr>
<tr>
<td>WURevocation_10</td>
<td>A Wallet Provider SHALL revoke a Wallet Unit upon the explicit request of the User registered during the Wallet Unit activation process, see <a href="#a2340-topic-40---wallet-instance-installation-and-wallet-unit-activation-and-management">Topic 40</a>. To do so, the Wallet Provider SHALL revoke all valid WUA(s) for that Wallet Unit. The Wallet Provider SHALL authenticate the User before accepting a request to revoke the Wallet Unit.</td>
</tr>
<tr>
<td>WURevocation_11</td>
<td>A Wallet Provider SHALL revoke a Wallet Unit upon the explicit request of a PID Provider, in case the natural person using the Wallet Unit has died or the legal person using the Wallet Unit has ceased operations. To do so, the Wallet Provider SHALL revoke all valid WUA(s) for that Wallet Unit. To identify the Wallet Unit that is to be revoked, the PID Provider SHALL use a Wallet Unit identifier provided by the Wallet Provider in the WUA during PID issuance. <em>Note: See the notes to WUA_08.</em></td>
</tr>
<tr>
<td>WURevocation_12</td>
<td>Before revoking a Wallet Unit per WURevocation_11, the Wallet Provider SHALL verify that the party requesting revocation is indeed a valid PID Provider listed in the Trusted List of PID Providers.</td>
</tr>
<tr>
<td>WURevocation_13</td>
<td>Before requesting a Wallet Provider to revoke a Wallet Unit per WURevocation_11, the PID Provider SHALL ensure that the revocation does not harm the interests of any of the stakeholders. The PID Provider SHALL have (and follow) a documented policy to ensure that this is the case.</td>
</tr>
</tbody>
</table>
<p>B. Informing the User</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WURevocation_14</td>
<td>A Wallet Provider SHALL inform a User without delay, and within 24 hours at most, in case the Wallet Provider decided to revoke the User's Wallet Unit. The Wallet Provider SHALL also inform the User about the reason(s) for the revocation. This information SHALL be understandable for the general public. It SHALL include (a reference to) technical details about any security breach if applicable.</td>
</tr>
<tr>
<td>WURevocation_15</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_16</td>
<td>To inform a User about the revocation of their Wallet Unit, the Wallet Provider SHALL use a communication channel that is independent of the Wallet Unit. In addition, the Wallet Provider MAY use the Wallet Unit itself to inform the User.</td>
</tr>
</tbody>
</table>
<p>C. Verifying the revocation status of a Wallet Unit</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WURevocation_17</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_18</td>
<td>A PID Provider issuing revocable PIDs SHALL, for each of its valid PIDs, regularly verify whether the Wallet Provider revoked the Wallet Unit on which that PID is residing, using the revocation information in the WUA it received during issuance of that PID. If it turns out that the Wallet Unit is revoked, the PID Provider SHALL immediately revoke the respective PID in accordance with all requirements in [<a href="#a237-topic-7---attestation-revocation-and-revocation-checking">Topic 7</a>]. <em>Notes: - This is a consequence of the legal requirement in [CIR 2024/2977], Article 5, 4.(b). - See <a href="../../../technical-specifications/ts3-wallet-unit-attestation/">Technical Specification 3</a> for how the PID Provider can do this verification. - The reverse is not true: When a PID is revoked, this does not imply that the Wallet Unit on which it is residing should also be revoked. Instead, the Wallet Unit moves to the Operational state. See <a href="../../../architecture-and-reference-framework-main/#463-wallet-unit">ARF main document Section 4.6.3</a>.</em></td>
</tr>
<tr>
<td>WURevocation_19</td>
<td>An Attestation Provider issuing revocable attestations MAY decide to  revoke an attestation if the Wallet Provider revoked the Wallet Unit on which that attestation is residing, in the same manner as described in WURevocation_18. An Attestation Provider SHALL publish its policy in this regard. <em>Note: Publishing its policy regarding revocation allows a Relying Party to decide if it can put sufficient trust in the attestations issued by that Attestation Provider.</em></td>
</tr>
<tr>
<td>WURevocation_19a</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_19b</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_20</td>
<td>Empty</td>
</tr>
<tr>
<td>WURevocation_21</td>
<td>Empty</td>
</tr>
</tbody>
</table>
<h4 id="a2339-topic-39-wallet-to-wallet-technical-topic">A.2.3.39 Topic 39 - Wallet to wallet technical Topic</h4>
<p>See <a href="#a2330-topic-30---interaction-between-wallet-units">Topic 30</a>.</p>
<h4 id="a2340-topic-40-wallet-instance-installation-and-wallet-unit-activation-and-management">A.2.3.40 Topic 40 - Wallet Instance installation and Wallet Unit activation and management</h4>
<h5 id="description_28">Description <!-- omit from toc --></h5>
<p>This Topic discusses requirements related to the installation of a Wallet
Instance by the User, the subsequent activation of the Wallet Unit by the User
and the Wallet Provider, and the management of the Wallet Unit throughout its
lifetime.</p>
<h5 id="a-hlrs-for-wallet-instance-installation">A - HLRs for Wallet Instance installation <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WIAM_01</td>
<td>To ensure that the User can trust the Wallet Solution, a Wallet Provider SHOULD make its certified Wallet Solution available for installation only via the official app store of the relevant operating system (e.g., Android, iOS). <em>Note: This allows the operating system of the device to perform relevant checks regarding the authenticity of the Wallet Unit.</em></td>
</tr>
<tr>
<td>WIAM_02</td>
<td>If a Wallet Provider makes its certified Wallet Solution available for installation through other means than the official OS app store, it SHALL implement a mechanism allowing the User to verify the authenticity of the Wallet Unit. Moreover, it SHALL provide clear instructions to the User on how to install the Wallet Instance, including at least: - instructions on the verification of the authenticity of the Wallet Instance to be installed, - instructions on bypassing of any operating system limitations on side-loading of apps, if applicable, and ensuring that these limitations are restored after the Wallet Instance has been installed. <em>Note: This requirement also applies for the installation of a Wallet Instance on a User device that is not a mobile device, and for which no official operating system app store may exist.</em></td>
</tr>
</tbody>
</table>
<h5 id="b-hlrs-for-wallet-unit-activation">B - HLRs for Wallet Unit activation <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WIAM_03</td>
<td>A Wallet Provider SHALL ensure that a Wallet Instance starts a process to activate the new Wallet Unit with the Wallet Provider immediately after installation or when the User first opens the Wallet Instance. The Wallet Provider SHALL ensure that the Wallet Instance starts this process only with a secure backend of the Wallet Provider.</td>
</tr>
<tr>
<td>WIAM_04</td>
<td>During the activation process of a new Wallet Unit, the Wallet Provider SHALL verify that the new Wallet Instance is a genuine instance of its Wallet Solution.</td>
</tr>
<tr>
<td>WIAM_05</td>
<td>During the activation process of a new Wallet Unit, the Wallet Provider SHALL process information about the User device and the available WSCAs and WSCDs, as far as necessary to issue a Wallet Unit Attestation to the Wallet Unit conform all requirements in <a href="#a239-topic-9---wallet-unit-attestation">Topic 9</a> section A. The Wallet Provider MAY process additional information necessary for managing the Wallet Unit, but it SHALL NOT process more information than it reasonably needs for legitimate purposes. The Wallet Provider SHALL request User consent (through the Wallet Instance) for all information and data it will process, both during activation and throughout the lifetime of the Wallet Unit. The Wallet Provider SHALL inform the User about the purposes of data processing, in accordance with the General Data Protection Regulation.</td>
</tr>
<tr>
<td>WIAM_06</td>
<td>The Wallet Provider SHALL request the User, through the new Wallet Instance, to set up a User account at the Wallet Provider. The Wallet Provider SHALL explain to the User that this is necessary to enable the User to request revocation of the Wallet Unit in case of theft or loss. The Wallet Provider SHALL register one or more User authentication methods that the Wallet Provider will use to authenticate the User in the future. These methods SHALL be independent of the Wallet Unit and the User device. The Wallet Provider SHALL allow the User to register using an alias instead of true identity data. The Wallet Provider SHALL NOT use any registered User data for purposes other than User authentication, unless the User gives explicit consent to do so. The Wallet Provider SHALL register the relationship between the Wallet Unit and the corresponding User account.</td>
</tr>
<tr>
<td>WIAM_07</td>
<td>A Wallet Provider SHALL activate a new Wallet Unit before a User can use it to have issued an PID or attestation. <em>Note: The WUA is issued as part of the activation.</em></td>
</tr>
<tr>
<td>WIAM_08</td>
<td>A Wallet Provider SHALL only activate a new Wallet Unit if it has verified that: - The Wallet Unit includes at least one WSCA/WSCD that is certified to be compliant with applicable requirements in this Topic, for Level of Assurance High in <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32015R1502">Commission Implementing Regulation (EU) 2015/1502</a> section 2.2.1. In addition, the Wallet Unit MAY include one or more other WSCAs, which SHALL be certified to be compliant with applicable requirements for Level of Assurance Substantial or High. - The private key corresponding to the public key in the WUA (see WUA_09) is protected by the respective WSCA/WSCD under control of the User.</td>
</tr>
<tr>
<td>WIAM_09</td>
<td>If a WSCA/WSCD contains cryptographic keys related to multiple Wallet Units, the Wallet Provider SHALL ensure that a Wallet Unit can only access keys that are related to that Wallet Unit.</td>
</tr>
<tr>
<td>WIAM_10</td>
<td>During the activation process of a new Wallet Unit, a Wallet Provider SHALL create and sign at least one Wallet Unit Attestation, and issue them to the Wallet Unit.</td>
</tr>
<tr>
<td>WIAM_10a</td>
<td>During the activation process of a new Wallet Unit, the Wallet Provider SHALL offer the User a means to verify the formal certification information of their Wallet Solution.</td>
</tr>
</tbody>
</table>
<h5 id="c-hlrs-for-wallet-unit-management">C - HLRs for Wallet Unit management <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WIAM_11</td>
<td>During the lifetime of the Wallet Unit, the Wallet Provider SHALL update the Wallet Unit as necessary to ensure its continued security and functionality.</td>
</tr>
<tr>
<td>WIAM_12</td>
<td>All communication between the Wallet Provider and the Wallet Unit SHALL be mutually authenticated and SHOULD be encrypted.</td>
</tr>
<tr>
<td>WIAM_12a</td>
<td>The Wallet Unit SHALL ensure that the Wallet Provider cannot access the contents of the Wallet Unit, in particular to learn a) which attestations are present on the Wallet Unit, b) the status of these attestations, c) the value of attributes in these attestations, and d) the contents of the Wallet Unit log meant in DASH_02.</td>
</tr>
<tr>
<td>WIAM_13</td>
<td>If the User uninstalls the Wallet Unit, the Wallet Unit SHALL ensure that all cryptographic key material in the WSCA(s) related to the Wallet Unit is securely destroyed. This includes all keys of the WUAs, PIDs and attestations stored in the Wallet Unit. <em>Note: Key deletion is a cryptographic key operation and requires User authentication, as specified in requirement WIAM_14.</em></td>
</tr>
<tr>
<td>WIAM_13a</td>
<td>If a Wallet Unit supports the [W3C Digital Credentials API] and the User uninstalls the Wallet Unit, the Wallet Unit SHALL disclose the fact that it no longer stores any PID(s) or attestation(s) to the Digital Credentials API framework.</td>
</tr>
<tr>
<td>WIAM_14</td>
<td>A WSCA/WSCD SHALL authenticate the User before performing any cryptographic operation involving a private or secret key of a Wallet Unit (i.e., a WUA key) or a private or secret key of a PID or an attestation stored in a Wallet Unit. For a PID key (which is part of the EUDI Wallet eID means), this WSCA/WSCD SHALL be certified to be compliant with applicable requirements for Level of Assurance High in Commission Implementing Regulation (EU) 2015/1502 section 2.2.1. <em>Note: Many actions of the Wallet Unit, such as processing a Relying Party presentation request and presenting an attestation, require multiple cryptographic operations, for example ephemeral key generation followed by key agreement and presentation signing and encryption. This requirement does not imply that a separate User authentication is necessary before each of these operations. Rather, a successful User authentication will be valid for all cryptographic operations necessary for a Wallet Unit action. It is up to the Wallet Provider to determine what constitutes a 'Wallet Unit action', finding a balance between security (more User authentications) and User convenience (fewer User authentications). During certification of the Wallet Solution, it will be verified that the solution provides an adequate level of security.</em></td>
</tr>
<tr>
<td>WIAM_15</td>
<td>Before performing any operation, a Wallet Unit SHALL authenticate the User. The Wallet Unit SHALL use the OS-level authentication mechanism according to WIAM_15a, unless this is technically impossible (for instance on some legacy devices), or the User prefers to use a Wallet Unit-specific PIN implemented by the Wallet Unit itself, as specified in WIAM_15b.</td>
</tr>
<tr>
<td>WIAM_15a</td>
<td>In order to ensure that operating system-level authentication can be used and is sufficiently secure, during installation of the Wallet Unit, the Wallet Unit SHALL enforce the activation of an OS-level User authentication mechanism with adequate security policies.</td>
</tr>
<tr>
<td>WIAM_15b</td>
<td>During installation of the Wallet Unit, the Wallet Unit SHALL enable the User to indicate if they want to use a Wallet Unit-specific PIN for User authentication, or use the OS-level User authentication mechanism. The Wallet Unit SHALL enable the User to change this preference during the lifetime of the Wallet Unit.</td>
</tr>
<tr>
<td>WIAM_16</td>
<td>For User authentication according to WIAM_15, a Wallet Unit SHALL implement an idle timeout, after which User authentication SHALL again be required. The Wallet Unit SHOULD provide the User with the option to set the idle timeout to a duration shorter than the default timeout.</td>
</tr>
<tr>
<td>WIAM_17</td>
<td>A WSCA/WSCD SHALL be able to authenticate a User in accordance with the requirements in <a href="https://eur-lex.europa.eu/legal-content/EN/TXT/?uri=CELEX%3A32015R1502">Commission Implementing Regulation (EU) 2015/1502</a> section 2.2.1.</td>
</tr>
<tr>
<td>WIAM_18</td>
<td>A WSCA/WSCD SHALL be able to generate a new key pair on request of the Wallet Provider via the Wallet Instance.</td>
</tr>
<tr>
<td>WIAM_19</td>
<td>A WSCA/WSCD SHALL be able to prove possession of the private key corresponding to a public key on request of a Wallet Instance, for example by signing a challenge with that private key.</td>
</tr>
<tr>
<td>WIAM_20</td>
<td>A WSCA/WSCD SHALL protect a private key it generated during the entire lifetime of the key. This protection SHALL at least imply that the WSCA/WSCD prevents the private key from being extracted in the clear. If a WSCA/WSCD is able to export a private key in encrypted format, the resulting level of protection SHALL be equivalent to the protection level of the private key when stored in the WSCA.</td>
</tr>
<tr>
<td>WIAM_21</td>
<td>Whenever the WSCA/WSCD successfully authenticated the User according to WIAM_14, the Wallet Unit SHOULD check if there are any PIDs or attestations on the Wallet Unit that cannot be presented any longer to Relying Parties, for example because they have expired or because a once-only attestation (see <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>, section D, method A) was presented to a Relying Party already. The Wallet Unit SHOULD then request the WSCA/WSCD to destroy all cryptographic key material related to these PIDs or attestations. <em>Note: The reason for this recommendation is that probably, Wallet Providers will want to prevent an accumulation of unused private keys in the WSCA/WSCD, given that such devices typically do not have much storage space. However, deletion of private keys (and potentially other key material) is a cryptographic key operation and cannot be done without User authentication; see WIAM_14. At the same time, for usability reasons the User must not be involved in such 'cleaning up' processes, see also ISSU_42. The recommended solution is to take advantage of a User authentication event to also carry out any necessary cleaning operations.</em></td>
</tr>
</tbody>
</table>
<h5 id="d-hlrs-for-wallet-unit-accessibility">D - HLRs for Wallet Unit accessibility <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>WIAM_21</td>
<td>Wallet Providers SHALL ensure that their Wallet Units comply with requirements and standards outlined in <a href="http://data.europa.eu/eli/dir/2016/2102/oj">Directive 2016/2012 on the accessibility of websites and mobile applications of public sector bodies</a>, including European Standard EN 301 549 V1.1.2 (2015-04).</td>
</tr>
<tr>
<td>WIAM_22</td>
<td>Wallet Providers SHALL ensure that their Wallet Units comply with accessibility requirements for products and services established under <a href="http://data.europa.eu/eli/dir/2019/882/oj">Directive (EU) 2019/882</a>.</td>
</tr>
</tbody>
</table>
<h4 id="a2341-topic-41-minimum-requirements-on-pub-eaas-rulebooks">A.2.3.41 Topic 41 - Minimum requirements on PuB-EAAs rulebooks</h4>
<p>See <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>.</p>
<h4 id="a2342-topic-42-requirements-for-qtsps-to-access-authentic-sources">A.2.3.42 Topic 42 - Requirements for QTSPs to access Authentic Sources</h4>
<h5 id="description_29">Description <!-- omit from toc --></h5>
<p>This Topic discusses the ability of QTSPs issuing electronic attestations of
attributes to verify those attributes by electronic means at the request
of the User, wherever those attributes rely on Authentic Sources within
the public sector.  </p>
<h5 id="hlrs_26">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>QTSPAS_01</td>
<td>In accordance with technical specifications referred to in QTSPAS_07, Member States SHALL define: - discovery mechanisms that enable QTSPs to request information about Authentic Sources or designated intermediaries recognised at the national level. This includes information regarding the attributes of a natural or legal person for which the Authentic Source or designated intermediary is considered a primary source, or for which it is recognised as authentic in accordance with Union law or national law, including administrative practices. - procedures for QTSPs to request the verification of attributes from Authentic Sources.</td>
</tr>
<tr>
<td>QTSPAS_02</td>
<td>An Authentic Source in the public sector, or its designated intermediary, SHALL implement an interface complying with the technical specification mentioned in QTSPAS_07 for receiving verification requests and sending responses. For each received request, the Authentic Source SHALL - identify and authenticate the requestor in such a way that it can subsequently determine whether the requestor is a QTSP issuing qualified electronic attestation of attributes, for example by means of a lookup in the QTSP Trusted List. - authenticate the User and obtain their approval, if it is legally obliged to do so, in addition to the User authentication and approval already performed by the QTSP according to QTSPAS_08. - verify whether the attribute values claimed by the QTSP match the values held by the Authentic Source; and, finally, - respond with one of the following for each attribute: +'match', if the attribute value held for this User by the Authentic Source is identical to the value claimed by the QTSP, + 'no match', if the attribute value held for this User by the Authentic Source is not identical to the value claimed by the QTSP, including if the Authentic Source is the authentic source for this attribute but does not hold a value for this User, +'unknown', if the Authentic Source is not the authentic source for this attribute.</td>
</tr>
<tr>
<td>QTSPAS_03</td>
<td>An Authentic Source or designated intermediary SHALL respond to a verification request for attributes by any QTSP issuing qualified electronic attestation of attributes.</td>
</tr>
<tr>
<td>QTSPAS_04</td>
<td>An Authentic Source or designated intermediary SHALL implement the technical specifications mentioned in QTSPAS_01, so that the QTSP will receive the result of the verification of the requested attributes as described in QTSPAS_02. If the verification is deferred, the response to the QTSP SHALL include the maximum time that it will take to verify the requested attributes, and a unique identifier that the QTSP SHALL use to obtain the result of the verification.</td>
</tr>
<tr>
<td>QTSPAS_05</td>
<td>A QTSP SHALL send an attribute verification request directly to the Authentic Source or designated intermediary recognised at national level, after discovering it using the mechanisms mentioned in QTSPAS_01.</td>
</tr>
<tr>
<td>QTSPAS_06</td>
<td>Member States SHALL specify the processes and mechanisms to designate the Authentic Sources or intermediaries recognised at national level in accordance with Union or national law, allowing these Authentic Sources or intermediaries to verify the attributes presented to them by QTSPs.</td>
</tr>
<tr>
<td>QTSPAS_07</td>
<td>The Commission SHALL publish, in cooperation with the European Digital Identity Cooperation Group, a technical specification, referring to applicable standards, specifications and procedures, that will cover at least the attributes specified in Annex VI, wherever those attributes rely on Authentic Sources within the public sector, for which Member States must ensure that measures are taken to allow qualified providers of electronic attestations of attributes to verify by electronic means, at the request of the User, their authenticity against the relevant authentic source.</td>
</tr>
<tr>
<td>QTSPAS_07a</td>
<td>The standards and procedures mentioned in QTSPAS_07 SHOULD, whenever possible, be aligned and compatible with those used for the platforms implementing the Once Only Technical System (OOTS). <em>Note: There is a clear synergy of both of these data exchange approaches. In fact, the national OOTS node would be a candidate for acting as an intermediary between QTSPs issuing QEAAs and the Authentic Sources.</em></td>
</tr>
<tr>
<td>QTSPAS_08</td>
<td>A QTSP SHALL obtain approval from the User to verify the authenticity of the attributes, before requesting the verification of those attributes by the relevant Authentic Source or designated intermediary.</td>
</tr>
</tbody>
</table>
<h4 id="a2343-topic-43-embedded-disclosure-policies">A.2.3.43 Topic 43 - Embedded disclosure policies</h4>
<h5 id="description_30">Description <!-- omit from toc --></h5>
<p>This topic is focused on identifying high-level requirements for disclosure
policies which may be embedded in an attestation. Such a policy may be created
by the Attestation Provider, and allows the Wallet Unit, using data obtained
from the Relying Party, to determine whether the Attestation Provider agrees
with releasing attributes from the attestation to the Relying Party. Note that
an embedded disclosure policy, if present, is applicable for any attribute in
the attestation.</p>
<p>Note that embedded disclosure policies do not apply to Wallet-to-Wallet interactions as described in <a href="#a2330-topic-30---interaction-between-wallet-units">Topic 30</a>, because a requesting Wallet Unit is not registered and therefore no authenticated information is available to evaluate an embedded disclosure policy.</p>
<h5 id="hlrs_27">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>EDP_01</td>
<td>A Wallet Unit SHALL enable an Attestation Provider to optionally express an embedded disclosure policy for a QEAA, PuB-EAA, or non-qualified EAA. <em>Note: The [European Digital Identity Regulation] does not contain a requirement for PIDs to be able to contain an embedded disclosure policy.</em></td>
</tr>
<tr>
<td>EDP_02</td>
<td>A Wallet Unit SHALL support embedded disclosure policies implementing the 'Authorised relying parties only policy' described in Annex III of Implementing Regulation (EU) 2024/2979. If present, such an embedded disclosure policy SHALL contain a list of EU-wide unique identifiers of Relying Parties, as specified in Reg_32. The Wallet Unit SHALL retrieve the Relying Party identifier from the access certificate presented by the Relying Party, and compare it to the list of authorised identifiers in the policy, unless the Relying Party is an intermediary. If the Relying Party is an intermediary, the Wallet Unit SHALL retrieve the unique identifier of the intermediated Relying Party from the presentation request or from the Registrar's online service (as applicable) and compare this identifier to the list of authorised identifiers in the policy. <em>Note: See RPI_07 for how the Wallet Unit can see if the Relying Party is an intermediary.</em></td>
</tr>
<tr>
<td>EDP_03</td>
<td>A Wallet Unit SHALL support embedded disclosure policies implementing the 'Specific root of trust' policy described in Annex III of Implementing Regulation (EU) 2024/2979. If present, such an embedded disclosure policy SHALL contain a list of root or intermediate certificates used for signing Relying Party access certificates. The Wallet Unit SHALL compare the certificate chain that was used to sign the access certificate provided by the Relying Party to the list of authorised root or intermediate certificates in the policy, unless the Relying Party is an intermediary. If the Relying Party is an intermediary, the Wallet Unit SHALL retrieve the root certificate of the Provider of registration certificates of the intermediated Relying Party from the presentation request or from the Registrar's online service (as applicable) and compare this certificate to the list of authorised certificates in the policy. <em>Note: See RPI_07 for how the Wallet Unit can see if the Relying Party is an intermediary.</em></td>
</tr>
<tr>
<td>EDP_04</td>
<td>Empty</td>
</tr>
<tr>
<td>EDP_05</td>
<td>An embedded disclosure policy SHOULD contain a link to a website of the Attestation Provider explaining the disclosure policy in layman's terms. If this is the case, the Wallet Unit SHALL display the link to the User and allow them to navigate to that website.</td>
</tr>
<tr>
<td>EDP_06</td>
<td>The Wallet Unit SHALL evaluate an embedded disclosure policy in conjunction with the information received from the requesting Relying Party, in order to determine if the Relying Party has permission from the Attestation Provider to access the requested attestation.</td>
</tr>
<tr>
<td>EDP_07</td>
<td>The Wallet Unit SHALL enable the User, based on the outcome of the evaluation of the applicable embedded disclosure policy(s), to deny or allow the presentation of the requested attestation to the Relying Party.</td>
</tr>
<tr>
<td>EDP_08</td>
<td>The Commission SHALL take measures to ensure a technical specification is created establishing common mechanisms for the specification of embedded disclosure policies by Attestation Providers, and for the evaluation of such policies by Wallet Units.</td>
</tr>
<tr>
<td>EDP_09</td>
<td>An Attestation Provider SHALL include an embedded disclosure policy (if any) by value in the Issuer metadata related to the attestation, in compliance with the [OpenID4VCI] issuance protocol or an extension thereof specified in the technical specification mentioned in EDP_08.</td>
</tr>
<tr>
<td>EDP_10</td>
<td>During attestation issuance, a Wallet Unit SHALL retrieve and store locally the corresponding embedded disclosure policy, if any.</td>
</tr>
<tr>
<td>EDP_11</td>
<td>An Attestation Provider SHALL revoke an attestation if a corresponding embedded disclosure policy is added, changed, or deleted.</td>
</tr>
</tbody>
</table>
<h4 id="a2344-topic-44-relying-party-registration-certificates">A.2.3.44 Topic 44 - Relying Party registration certificates</h4>
<h5 id="description_31">Description <!-- omit from toc --></h5>
<p>This topic identifies high-level requirements for Relying Party registration
certificates, which were introduced in Commission Implementing Regulation
2024/2982 [2024/2982]. A registration certificate may be issued by a
Provider of registration certificates to a Relying Party during the registration process described in
<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>.
If present, it contains mainly the list of attributes registered by the Relying Party
according to Article 5b 2 (c) of the [European Digital Identity Regulation], as well as information about the intermediary used by this Relying Party, if applicable. A
registration certificate is signed by the Provider of registration certificates.
As a Relying Party is obliged to register for each purpose ("intended use") separately, multiple registration certificates may be issued to a single Relying Party.</p>
<p>Commission Implementing Regulation 2024/2982 requires a Wallet Unit to
authenticate and validate the registration certificate (if available), and to display to the User the information on the Relying Party as registered by the Registrar. The information in the registration certificate can also be retrieved from the Registrar's online service. This enables Users
to verify that the attributes being requested by the Relying Party are within
the scope of their registered attributes ("intended use"), providing assurance that the request is legitimate and trustworthy.</p>
<h5 id="hlrs_28">HLRs <!-- omit from toc --></h5>
<p>A. Issuance of Relying Party registration certificates</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPRC_01</td>
<td>During the registration process for Relying Parties, as specified in <a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>, a Provider of registration certificates associated to the Member State Registrar MAY create and sign or seal a separate registration certificate for each intended use requested to be registered by the Relying Party, and issue it to the Relying Party. If present, the registration certificate SHALL comply with the applicable requirements in the technical specification mentioned in RPRC_02. <em>Note: See also <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>.</em></td>
</tr>
<tr>
<td>RPRC_01b</td>
<td>If, during registration, a Relying Party received one or more registration certificates, it SHALL distribute these to all its Relying Party Instances.</td>
</tr>
<tr>
<td>RPRC_02</td>
<td>The Commission SHALL ensure that a technical specification is created, describing at least 1. the contents and format of registration certificates. 2. the signing method(s) used to ensure the authenticity of the registration certificates. 3. the trust infrastructure necessary for signing registration certificates and for verifying these signatures, including the use of Trusted Lists to establish trust in Providers of registration certificates and to distribute their trust anchors to Wallet Units. 4. the method used for binding each registration certificate to the Relying Party Instance access certificate that will be used during the same transaction. This binding method SHALL enable a Wallet Unit to verify that the registration certificate is bound to the Relying Party that authenticated itself using the access certificate. The binding method SHALL consider situations in which the Relying Party uses the services of an intermediary (see <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>) to connect to the Wallet Unit. 5. whether or not a registration certificate must have a validity period. 6. the method to be used for revocation of registration certificates. Moreover, the technical specification SHALL describe the impact of revocation, especially compared to the impact of revocation of the Relying Party Instance access certificates.</td>
</tr>
<tr>
<td>RPRC_03</td>
<td>The contents of a registration certificate SHALL include at least the information required in Annex V of the <a href="https://data.europa.eu/eli/reg_impl/2025/848/oj">CIR 2025/848</a> regarding registration of wallet-relying parties. If the Relying Party uses the services of an intermediary (see <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>), the 'association to the intermediary' mentioned in Annex I (15) of [CIR 2025/848] SHALL consist of the user-friendly name and unique identifier of this intermediary, as meant in requirements Reg_31 and Reg_32. <em>Note: this name and identifier are identical to those in the access certificate of the intermediary.</em></td>
</tr>
<tr>
<td>RPRC_03a</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains a name for the Relying Party, in a format suitable for presenting to a User. <em>Note: A Wallet Unit needs such a name when requesting User approval according to [<a href="#a236-topic-6---relying-party-authentication-and-user-approval">Topic 6</a>]</em></td>
</tr>
<tr>
<td>RPRC_03b</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains an EU-wide unique identifier for the Relying Party, and SHALL specify a method for deriving such identifiers. <em>Notes: - The Wallet Instance needs such an identifier at least to allow the User to send a report of suspicious Relying Party presentation requests to a data protection authority according to <a href="#a2350-topic-50---blueprint-to-report-unlawful-or-suspicious-request-of-data">Topic 50</a>. - The EU-wide unique identifier could, for example, be a concatenated list of one or more registered official Relying Party identifiers listed in Annex I(3) of the <a href="https://data.europa.eu/eli/reg_impl/2025/848/oj">CIR 2025/848</a> regarding registration of Wallet Relying Parties, expressed in the semantic form defined in [ETSI EN 319 412-1] sections 5.1.4 or 5.1.5. The exact specification is left for the technical specifications to be developed by the European Commission.</em></td>
</tr>
<tr>
<td>RPRC_03c</td>
<td>The EU-wide unique identifier meant in RPRC_03b SHALL be identical in all registration certificates issued for a given Relying Party. <em>Note: In case the registration certificates issued to an intermediated Relying Party are held and presented by an intermediary, the Relying Party meant in this requirement is the intermediated Relying Party. An intermediary may obtain and hold registration certificates with a different unique identifier.</em></td>
</tr>
<tr>
<td>RPRC_03d</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains at least one of the following: a) the URL of a web form provided by the Relying Party, which Users can use to send attribute erasure requests, b) an e-mail address of the Relying Party, on which the Relying Party is prepared to receive attribute erasure requests from Users, c) a telephone number of the Relying Party, on which the Relying Party is prepared to receive attribute erasure requests from Users. <em>Note: See <a href="#a2348-topic-48---blueprint-for-requesting-data-deletion-to-relying-parties">Topic 48</a> for more information about attribute erasure requests.</em></td>
</tr>
<tr>
<td>RPRC_03e</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains at least one of the following: a) the URL of web form provided by the Data Protection Authority supervising the Relying Party, which Users can use to report suspicious attribute presentation requests. b) an e-mail address of that DPA, on which the DPA is prepared to receive reports about suspicious attribute presentation requests from Users, c) a telephone number of that DPA, on which the DPA is prepared to receive reports about suspicious attribute presentation requests from Users. <em>Note: See <a href="#a2350-topic-50---blueprint-to-report-unlawful-or-suspicious-request-of-data">Topic 50</a> for more information about reporting suspicious attribute presentation requests.</em></td>
</tr>
</tbody>
</table>
<p>B. Presentation and verification of Relying Party registration certificates</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPRC_04</td>
<td>If a Relying Party Instance received one or more registration certificates (see RPRC_01b), it SHALL include a single registration certificate applicable for its current intended use in each presentation request to a Wallet Unit, according to the applicable standard's extension mentioned in RPRC_05. The registration certificate SHALL be included in the request by value, not by reference. The Wallet Unit SHALL do so both in proximity and remote presentation flows. <em>Note: This ensures that no external requests are necessary to validate the request, and that transactions are atomic and self-contained.</em></td>
</tr>
<tr>
<td>RPRC_05</td>
<td>The Commission SHALL ensure that extensions are specified for [ISO/IEC 18013-5] and for [OpenID4VP], allowing a Relying Party to transfer a single Relying Party registration certificate to a Wallet Unit in a presentation request. These extensions SHALL comply with applicable requirements in these standards. <em>Note that it must not be possible to include multiple registration certificates in a single presentation request.</em></td>
</tr>
<tr>
<td>RPRC_06</td>
<td>Either during a presentation transaction or as a general User setting, a Wallet Unit SHALL offer the User the possibility to indicate whether the User wants to verify the information registered by the competent Registrar about the Relying Party.</td>
</tr>
<tr>
<td>RPRC_06a</td>
<td>If the User indicated that they want to verify the information registered about the Relying Party and a registration certificate is available in the request, the Wallet Unit SHALL verify the authenticity and validity of the registration certificate according to the technical specification meant in RPRC_02. If the outcome of the verification is negative, the Wallet Unit SHALL, when asking for User approval according to RPA_07, notify the User that it could not obtain the information registered about the Relying Party.</td>
</tr>
<tr>
<td>RPRC_06b</td>
<td>If the User indicated that they want to verify the information registered about the Relying Party but no registration certificate is available in the request, the Wallet Unit SHALL connect to the URL of the online service of the Registrar (as included in the access certificate) to obtain this information. If the Wallet Unit cannot connect to this URL or if it cannot verify the authenticity and validity of the registered information, it SHALL, when asking for User approval according to RPA_07, notify the User that it could not obtain the information registered about the Relying Party.</td>
</tr>
<tr>
<td>RPRC_07</td>
<td>If the User indicated that they want to verify the information registered about the Relying Party and the Wallet Unit retrieved this information either from the registration certificate or from the online service of the Registrar, it SHALL verify that all attributes requested in the presentation request are included in the list of attributes registered by the Registrar. If the outcome of the verification is negative, the Wallet Unit SHALL, when asking for User approval according to RPA_07, notify the User about the requested attributes that the Relying Party did not register.</td>
</tr>
<tr>
<td>RPRC_08</td>
<td>Empty.</td>
</tr>
<tr>
<td>RPRC_09</td>
<td>Empty.</td>
</tr>
<tr>
<td>RPRC_10</td>
<td>The Commission SHALL provide a technical specification establishing a common Certificate Policy for registration certificates, covering at least management and selection of signing keys, revocation and lifecycle management of registration certificates on individual intended use level. <em>Note: The technical specification may require the Provider of registration certificates to follow applicable parts of technical standards such as EN 319 401 (for General Policy Requirements for TSPs) and TS 119 461 (for identity proofing of Relying Party representatives).</em></td>
</tr>
<tr>
<td>RPRC_11</td>
<td>A Relying Party Instance SHALL include at most one registration certificate in a presentation request for a given intended use of a Relying Party.</td>
</tr>
<tr>
<td>RPRC_12</td>
<td>Empty.</td>
</tr>
</tbody>
</table>
<h4 id="a2345-topic-45-qeaa-rulebook">A.2.3.45 Topic 45 - QEAA Rulebook</h4>
<p>See <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>.</p>
<h4 id="a2346-topic-46-protocols-and-interfaces-for-presentation-of-pid-and-qeaa-with-relying-parties">A.2.3.46 Topic 46 - Protocols and interfaces for Presentation of PID and (Q)EAA with Relying Parties</h4>
<p>See <a href="#a231-topic-1---accessing-online-services-with-a-wallet-unit">Topic 1</a>
and <a href="#a2312-topic-12---attestation-rulebooks">Topic 12</a>.</p>
<h4 id="a2347-topic-47-protocols-and-interfaces-for-pid-and-qeaa-issuance-and-non-qualified-certificates-issuance">A.2.3.47 Topic 47 - Protocols and interfaces for PID and (Q)EAA issuance, and (non-)qualified certificates issuance</h4>
<p>See <a href="#a2310-topic-10---issuing-a-pid-or-attestation-to-a-wallet-unit">Topic 10</a>/<a href="#a2323-topic-23---pid-issuance-and-qeaa-issuance">23</a>.</p>
<h4 id="a2348-topic-48-blueprint-for-requesting-data-deletion-to-relying-parties">A.2.3.48 Topic 48 - Blueprint for requesting data deletion to Relying Parties</h4>
<h5 id="description_32">Description <!-- omit from toc --></h5>
<p>In this use case, a User requests the deletion of their personal attributes from
Relying Parties with which they have interacted through their Wallet Unit.</p>
<p>Users are concerned about having control over their personal data, thus
the function of requesting data deletion ensures a higher degree of
transparency, privacy and control of the Users over their personal
data.</p>
<p>This Topic lists high-level requirements related to the function
of Users requesting the deletion of their personal data from Relying
Parties through their Wallet Unit.</p>
<p>Note: A Relying Party may use the services of an intermediary to request data
from a Wallet Unit, see <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>.
However, such intermediaries are required to delete any data they obtain from a
Wallet Unit immediately after sending it to the Relying Party. Data deletion
requests are therefore always sent to the Relying Party, not the intermediary.</p>
<h5 id="hlrs_29">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>DATA_DLT_01</td>
<td>A Wallet Provider SHALL ensure that its Wallet Units support the possibilities mentioned in DATA_DLT_02, allowing a User to request from a Relying Party the erasure of their attributes that were presented by that Wallet Unit to that Relying Party, in accordance with Article 17 of Regulation (EU) 2016/679.</td>
</tr>
<tr>
<td>DATA_DLT_02</td>
<td>A Wallet Unit SHALL support at least the following possibilities to send a data erasure request to a Relying Party: a) Open a URL in an external browser to ask for the deletion of data in a web form provided by the Relying Party, b) Open an external mail client and start a draft e-mail to the Relying Party, with a suitable template text, c) open an external phone client and start a phone call. Depending on whether a Relying Party URL, e-mail address, and/or phone number was logged for the relevant attestation presentation transaction (see requirement DASH_03 in <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>), the Wallet Unit SHALL offer the User to use one or more of these possibilities.</td>
</tr>
<tr>
<td>DATA_DLT_02a</td>
<td>If the User initiates sending a data erasure request for a particular attestation presentation transaction, but no Relying Party URL, e-mail address, or telephone number is available in the log for that transaction, the Wallet Unit SHALL connect to the URL of the online service of the Registrar indicated in the log to obtain this information. The Wallet Unit SHALL inform the User that it must connect to the Registrar to look up the contact information it needs to send a data deletion request. <em>Note: this situation may occur if there was no registration certificate in the presentation request and the User did not request the Wallet Unit to obtain the information registered about the Relying Party from the Registrar. See RPRC_04 - RPRC_06b in <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>.</em></td>
</tr>
<tr>
<td>DATA_DLT_03</td>
<td>A Wallet Instance SHALL provide a function where the User may select one Relying Party to which a data deletion request must be submitted.</td>
</tr>
<tr>
<td>DATA_DLT_04</td>
<td>Empty</td>
</tr>
<tr>
<td>DATA_DLT_05</td>
<td>A Wallet Unit SHALL include the initiation of a data deletion request in a log, so it can be displayed to the User via the dashboard as specified in <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>. <em>Note: Because the request is sent by an external web browser, e-mail client, or phone client (see DATA_DLT_02), the Wallet Unit can only log the initiation of the request.</em></td>
</tr>
<tr>
<td>DATA_DLT_06</td>
<td>For the initiation of a data deletion request, the log SHALL contain at least: - Date and time of the initiation of the request, - Name and unique identifier of the Relying Party to which the request was made, - Attributes requested to be deleted.</td>
</tr>
<tr>
<td>DATA_DLT_07</td>
<td>Before executing a data deletion request, a Relying Party SHALL authenticate the requesting User (or the request itself), using appropriate authentication mechanisms of its own choosing. The Relying Party SHOULD use the authentication or signature facilities offered by the User's Wallet Unit for this purpose.</td>
</tr>
<tr>
<td>DATA_DLT_08</td>
<td>Wallet Units, Relying Parties, and Registrars SHALL comply with the relevant requirements in <a href="../../../technical-specifications/ts7-common-interface-for-data-deletion-request/">Technical Specification 7</a>.</td>
</tr>
</tbody>
</table>
<h4 id="a2349-topic-49-protocol-and-interfaces-for-requesting-data-deletion-to-relying-parties">A.2.3.49 Topic 49 - Protocol and interfaces for requesting data deletion to relying parties</h4>
<p>Deleted.</p>
<h4 id="a2350-topic-50-blueprint-to-report-unlawful-or-suspicious-request-of-data">A.2.3.50 Topic 50 - Blueprint to report unlawful or suspicious request of data</h4>
<h5 id="description_33">Description <!-- omit from toc --></h5>
<p>In this use case, a User reports a Relying Party to the competent national data
protection authority, because the User claims that this Relying Party sent an
unlawful or inappropriate request for attribute to the Wallet Unit. Users are
concerned about having control over their personal data, and specifically about
a Relying Party over-asking for personal information, thus the function of
reporting suspicious or inappropriate requests ensures a higher degree of
transparency, privacy and control of the Users over their personal data.</p>
<p>This topic lists high-level requirements related to the function of Users
reporting unlawful or inappropriate attribute requests from Relying Parties.</p>
<h5 id="hlrs_30">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPT_DPA_01</td>
<td>A Wallet Unit SHALL enable the User to start the process of reporting a suspicious presentation request to a DPA. When prompted by the User, a Wallet Unit SHALL provide the contact details of the DPA which supervises the Relying Party that made the suspicious request, if available in the log for that request (see DASH_03). If the contact details of the supervising DPA are not available in the log, the Wallet Unit SHALL provide the contact details of the DPA of the region in which the Wallet Provider is residing. In addition, the Wallet Unit MAY also provide the contact details of other DPAs, taken from the "European Data Protection Board" website (<a href="https://www.edpb.europa.eu/about-edpb/about-edpb/members_en">https://www.edpb.europa.eu/about-edpb/about-edpb/members_en</a>). <em>Note: The DPA contact details may be unavailable in the log if there was no registration certificate in the presentation request and the User did not request the Wallet Unit to obtain the information registered about the Relying Party from the Registrar. See RPRC_04 - RPRC_06b in <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>.</em></td>
</tr>
<tr>
<td>RPT_DPA_02</td>
<td>The Wallet Unit SHALL offer the User the option to report a suspicious request to a DPA via the transaction log presented in the dashboard, see <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>.</td>
</tr>
<tr>
<td>RPT_DPA_02a</td>
<td>A Wallet Unit SHALL support at least the following possibilities to report a suspicious presentation request to a DPA, depending on what contact details are available for the DPA: a) Open a URL in an external browser to report the request in a web form provided by the DPA. b) Open an external e-mail client and start a draft e-mail to the DPA, with a suitable template text, c) open an external phone client and start a phone call.</td>
</tr>
<tr>
<td>RPT_DPA_03</td>
<td>Empty</td>
</tr>
<tr>
<td>RPT_DPA_04</td>
<td>A Wallet Provider SHALL ensure that a Wallet Unit allows its User to substantiate a report sent to a DPA, including by attaching relevant information to identify the Relying Party and the Users' claims in a machine-readable format. <em>Note: The log kept by the Wallet Unit will be standardized and is machine-readable in order to enable data portability. An excerpt from this log therefore can be used to substantiate the report.</em></td>
</tr>
<tr>
<td>RPT_DPA_05</td>
<td>A Wallet Unit SHALL keep reports sent to the DPA in a log so that it can be presented to the User in the dashboard (as specified in <a href="#a2319-topic-19---user-navigation-requirements-dashboard-logs-for-transparency">Topic 19</a>).</td>
</tr>
<tr>
<td>RPT_DPA_06</td>
<td>Wallet Units, Data Protection Authorities, and Registrars SHALL comply with the relevant requirements in <a href="../../../technical-specifications/ts8-common-interface-for-reporting-of-wrp-to-dpa/">Technical Specification 8</a>.</td>
</tr>
</tbody>
</table>
<h4 id="a2351-topic-51-pid-or-attestation-deletion">A.2.3.51 Topic 51 - PID or attestation deletion</h4>
<h5 id="description_34">Description <!-- omit from toc --></h5>
<p>This topic lists high-level requirements related to a User deleting a PID or
attestation from their Wallet Unit.</p>
<h5 id="hlrs_31">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>PAD_01</td>
<td>A Wallet Unit SHALL at any time enable the User to delete any PID or attestation from their Wallet Unit.</td>
</tr>
<tr>
<td>PAD_02</td>
<td>If the User indicates that a PID or attestation must be deleted, and the Wallet Unit contains multiple PIDs or attestation having the corresponding attestation type and Provider, a Wallet Unit SHALL delete all of these PIDs and attestations simultaneously. <em>Note: This situation may occur if the PID Provider or Attestation Provider issued a batch of attestations to the Wallet Unit, rather than a single one.</em></td>
</tr>
<tr>
<td>PAD_03</td>
<td>If the Wallet Unit deletes a PID or attestation on the User's request, the Wallet Unit SHALL NOT notify the respective PID Provider or Attestation Provider. <em>Note: This is a matter of User privacy.</em></td>
</tr>
<tr>
<td>PAD_04</td>
<td>If the Wallet Unit deletes a PID or attestation on the User's request, the Wallet Unit SHALL ensure that all cryptographic key material in the WSCA/WSCD related to this PID or attestation is securely destroyed. <em>Note: Key deletion is a cryptographic key operation and requires User authentication, as specified in requirement WIAM_14.</em></td>
</tr>
<tr>
<td>PAD_05</td>
<td>If a Wallet Unit supports the [W3C Digital Credentials API] and it deletes a PID or attestation on the User's request, the Wallet Instance SHALL disclose the fact that it no longer stores this PID or attestation to the Digital Credentials API framework.</td>
</tr>
<tr>
<td>PAD_06</td>
<td>If the User uninstalls the Wallet Instance, the Wallet Instance SHALL request the associated WSCA(s) to delete all sensitive data and cryptographic keys related to the Wallet Unit and to all PIDs and attestations on the Wallet Unit, if the WSCA(s) are connected to the User device at the moment the Wallet Instance is uninstalled. <em>Note: It may happen there is no connection to the WSCA at the moment the User uninstalls the Wallet Instance; for instance, in case the WSCD is an external smart card and the User does not present that card to the User device. Another example occurs when the WSCD is a remote HSM and the User device is offline at the moment the User uninstalls the Wallet Instance. In such cases, the cryptographic keys will probably remain present on the WSCD, even though they will never be used again. If needed, it is up to the Wallet Provider to define how the Wallet Unit should handle such situations. For example, an HSM manager could address such cases by deciding to delete cryptographic keys in the HSM that are too old or haven't been used for too long, while being aware of the risks in doing so.</em></td>
</tr>
</tbody>
</table>
<h4 id="a2352-topic-52-relying-party-intermediaries">A.2.3.52 Topic 52 Relying Party intermediaries</h4>
<h5 id="description_35">Description <!-- omit from toc --></h5>
<p>This topic lists high-level requirements regarding so-called intermediaries,
which form a special class of Relying Party. Article 5b (10) of the [European
Digital Identity Regulation] states "Intermediaries acting on behalf of relying
parties shall be deemed to be relying parties and shall not store data about the
content of the transaction". Such an intermediary is a party that offers
services to Relying Parties to, on their behalf, connect to Wallet Units and
request the User attributes that these Relying Parties need. The intermediary
then performs all necessary verifications, and, if successful, sends the
presented attributes to the intermediated Relying Party. This implies that an
intermediary performs all tasks assigned to a Relying Party in this ARF on
behalf of the intermediated Relying Party.</p>
<h5 id="hlrs_32">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPI_01</td>
<td>An intermediary SHALL register as a Relying Party, in accordance with all requirements in <a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>, while indicating it intends to act as an intermediary. <em>Notes: - This implies that an intermediary obtains an access certificate containing its own name and unique Relying Party identifier. - An intermediary may also obtain a registration certificate according to <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>, but this certificate will not be used for intermediated transactions. - An entity that registered as an intermediary may also register as a Relying Party in its own capacity. In such a case, it will receive one or more registration certificates for its intended use(s), and will use one of these certificates when interacting with a Wallet Unit.</em></td>
</tr>
<tr>
<td>RPI_02</td>
<td>Empty</td>
</tr>
<tr>
<td>RPI_03</td>
<td>An intermediary SHALL register at the Registrar each intermediated Relying Party it is acting on behalf of, as well as each intended use separately related to a given intermediated Relying Party. If a Provider of registration certificates associated with the Registrar issues registration certificates, the intermediary SHALL receive one or more registration certificates for the intermediated Relying Party, according to the requirements in <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>. The registration certificate SHALL contain the intermediated Relying Party's name and unique identifier, as well as the list of attributes registered for that Relying Party's intended use.</td>
</tr>
<tr>
<td>RPI_04</td>
<td>When registering information for a Relying Party via an intermediary, the Registrar SHALL verify, in a manner to be decided by Registrar's Member State, that the Relying Party will indeed use the services of the intermediary to interact with Wallet Units.</td>
</tr>
<tr>
<td>RPI_05</td>
<td>Empty</td>
</tr>
<tr>
<td>RPI_06</td>
<td>When requested by an intermediated Relying Party, an intermediary SHALL request a presentation of attributes from a specific Wallet Unit, using the intermediary's access certificate meant in requirement RPI_01 and a registration certificate of the Relying Party, as meant in RPI_03, if available. If no registration certificate is available, the intermediary SHALL include the user-friendly name and unique identifier of the intermediated Relying Party in an extension of the presentation request, according to RPI_06a.</td>
</tr>
<tr>
<td>RPI_06a</td>
<td>The Commission SHALL ensure that extensions are specified for [ISO/IEC 18013-5] and for [OpenID4VP], allowing an intermediary to transfer the user-friendly name and unique identifier of an intermediated Relying Party to a Wallet Unit. These extensions SHALL comply with applicable requirements in these standards.</td>
</tr>
<tr>
<td>RPI_07</td>
<td>In case a Wallet Unit receives a presentation request from an intermediary on behalf of an intermediated Relying Party, during the Relying Party authentication process it SHALL display the names and identifiers of both the intermediary and the intermediated Relying Party to the User when asking for User consent, as described in RPA_07. <em>Note: The Wallet Unit can see that a presentation request is from an intermediary either because this is indicated in the registration certificate or because the extension meant in RPI_06 and RPI_06a is present.</em></td>
</tr>
<tr>
<td>RPI_07a</td>
<td>In case a Wallet Unit receives a presentation request from an intermediary on behalf of an intermediated Relying Party, and if the User indicated that they want to verify the information registered about this Relying Party (according to RPRC_06), and if a registration certificate is available, the Wallet Unit SHALL verify that the name and the unique identifier of the intermediary, as included in the registration certificate of the intermediated Relying Party, are identical to the name and unique identifier in the access certificate. If this verification fails, the Wallet Unit SHALL notify the User when asking for User consent.</td>
</tr>
<tr>
<td>RPI_07b</td>
<td>In case a Wallet Unit receives a presentation request from an intermediary on behalf of an intermediated Relying Party, and if the User indicated that they want to verify the information registered about this Relying Party (according to RPRC_06), and if no registration certificate is available, the Wallet Unit SHALL connect to the URL of the online service of the Registrar indicated in the access certificate to obtain this information, using the unique identifier of the intermediated Relying Party. The Wallet Unit SHALL verify that the name and the unique identifier of the intermediary for this intermediated Relying Party, as registered by the Registrar, are identical to the name and unique identifier included in the access certificate. If this verification fails, the Wallet Unit SHALL notify the User when asking for User consent.</td>
</tr>
<tr>
<td>RPI_08</td>
<td>When a Wallet Unit presents to an intermediary any User attributes from a PID or attestation, the intermediary SHALL, after successfully carrying out the verifications in RPI_09, forward these attributes (only) to the Relying Party on behalf of which the presentation request was made. If any of the verifications in RPI_09 fail, the intermediary SHALL NOT forward any attributes to the Relying Party.</td>
</tr>
<tr>
<td>RPI_09</td>
<td>When a Wallet Unit presents to an intermediary any attributes from a PID or attestation, the intermediary SHALL verify the authenticity of the PID or attestation, its revocation status, device binding, and User binding, as well as any combined presentation of attributes, if applicable, as specified in this ARF and if agreed with the Relying Party. Furthermore, the intermediary SHALL verify the authenticity of the Wallet Unit and its revocation status, as specified in this ARF, if agreed with the Relying Party. <em>Note: This ARF does not mandate that a Relying Party must carry out all of these verifications. Therefore, the intermediary and any Relying Party using its services must agree on what verifications the intermediary will carry out.</em></td>
</tr>
<tr>
<td>RPI_10</td>
<td>The intermediary SHALL delete any PIDs or attestations it obtained from the Wallet Unit, including any User attributes, completely and immediately after it has sent the User attributes to the intermediated Relying Party. If the intermediary does not send any User attributes to the intermediated Relying Party, for example because one of the verifications in the previous step failed, the intermediary SHALL delete the PIDs, attestations, or WUAs completely and immediately as soon as it has completed all necessary verifications.</td>
</tr>
</tbody>
</table>
<h4 id="a2353-topic-53-zero-knowledge-proofs">A.2.3.53 Topic 53 Zero-Knowledge Proofs</h4>
<h5 id="description_36">Description <!-- omit from toc --></h5>
<p><strong>NOTE: Discussions on Zero-Knowledge Proofs are ongoing. No specific ZKP has been selected to be supported by components in the EUDI Wallet ecosystem. For an up-to-date discussion, see <a href="../../../technical-specifications/ts4-zkp/">Technical Specification 4</a>.</strong></p>
<p>This topic lists high-level requirements for a Zero-Knowledge Proof scheme to be used within the EUDI Wallet ecosystem as a proof mechanism for PIDs and attestations. A Zero-Knowledge Proof (ZKP) is a cryptographic protocol that allows one party
(the prover) to convince another party (the verifier) that a given statement is
true without revealing any additional information beyond the validity of the
statement itself. This ensures that the verifier gains no knowledge about how
the prover knows the statement to be true, preserving privacy while enabling trust.</p>
<p>The topic of ZKPs for the EUDI Wallet ecosystem was introduced in the <a href="../../../discussion-topics/g-zero-knowledge-proof/">Discussion Paper for Topic G</a>. The high-level requirements in this Topic were taken from that discussion paper.</p>
<h5 id="hlrs_33">HLRs <!-- omit from toc --></h5>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ZKP_01</td>
<td>A ZKP scheme SHALL provide support for the following generic functions, while hiding all attributes of PIDs or attestations: (i) generation of a proof that an (some) attribute(s) having a specific value is (are) included in a PID or attestation, (ii) generation of a proof that a PID or attestation is within its validity period, (iii) generation of a proof that a PID or attestation has not been revoked, and (iv) generation of a proof that a PID or attestation is bound to a key stored in the WSCA/WSCD of the Wallet Unit. Additionally, a ZKP scheme SHOULD provide support for the following function, which SHOULD  be used only when hiding the PID Provider or Attestation Provider is necessary: (v) generation of a proof that a PID or attestation has been issued by a trusted PID Provider or Attestation Provider, without revealing the PID Provider or Attestation Provider. <em>Notes: - See section 4.1.1 of the Discussion Paper for Topic G.</em></td>
</tr>
<tr>
<td>ZKP_02</td>
<td>A ZKP scheme SHALL support proving possession of attestation of a given type. <em>Note: See section 4.1.2 and 4.1.3 of the Discussion Paper for Topic G.</em></td>
</tr>
<tr>
<td>ZKP_03</td>
<td>A ZKP scheme SHOULD support the privacy-preserving binding of an attestation to a PID. In addition to the generic functions defined in ZKP_01, for this use case, a ZKP scheme SHALL provide support for the following functions: (i) generation of a proof that the Wallet Unit stores an attestation and a PID and that the attestation includes a specific attribute, having a specific value, which is also present in the PID. <em>Note: See section 4.1.4 of the Discussion Paper for Topic G.</em></td>
</tr>
<tr>
<td>ZKP_04</td>
<td>A ZKP scheme SHOULD support the derivation of a verifiable User pseudonym, by combining an attribute value that is unique for the User with Relying Party-specific context (e.g., the Relying Party identifier) In addition to the generic functions defined in ZKP_01, for this use case, a ZKP scheme SHALL provide support for the following functions: (i) generation of a request for the issuance of an attestation that includes a secret attribute unique to the User, without revealing this attribute to the Attestation Provider, (ii) generation of an attestation presentation that includes a verifiable pseudonym derived from the secret attribute, a Relying Party identifier, and context-related information. <em>Note: See section 4.1.5 of the Discussion Paper for Topic G.</em></td>
</tr>
<tr>
<td>ZKP_05</td>
<td>A ZKP scheme SHALL be usable in both remote and proximity presentation flows. While the inclusion of ZKP will introduce computational and verification delays, these delays SHALL NOT critically undermine or defeat the purpose of the Relying Party service (e.g. because of a critical impact on the User experience of the Wallet Unit).</td>
</tr>
<tr>
<td>ZKP_06</td>
<td>A ZKP scheme SHOULD be able to generate proofs for already issued PIDs and attestations in the formats specified in [ISO/IEC 18013-5] or [SD-JWT VC].</td>
</tr>
<tr>
<td>ZKP_07</td>
<td>A ZKP scheme SHALL NOT introduce any additional communication or information that could be used to track or link User activity during, before, or after proof generation.</td>
</tr>
<tr>
<td>ZKP_08</td>
<td>A ZKP scheme SHALL rely solely on algorithms standardised by a standardisation organisation recognised by the Commission or in a standard recognised by the Commission.</td>
</tr>
<tr>
<td>ZKP_09</td>
<td>Use of a ZKP scheme SHALL NOT prevent the Wallet Unit's ability to provide User authentication with Level of Assurance High.</td>
</tr>
</tbody>
</table>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.path", "toc.integrate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>