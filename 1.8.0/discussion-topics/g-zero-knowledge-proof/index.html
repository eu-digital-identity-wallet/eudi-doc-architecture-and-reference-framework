
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>G - Zero Knowledge Proof - European Digital Identity</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#g-zero-knowledge-proof" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="European Digital Identity" class="md-header__button md-logo" aria-label="European Digital Identity" data-md-component="logo">
      
  <img src="../../media/eu-logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            European Digital Identity
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              G - Zero Knowledge Proof
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  European Digital Identity Wallet

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../architecture-and-reference-framework-main/" class="md-tabs__link">
        
  
  
    
  
  Architecture and reference framework

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  Discussion topics

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../technical-specifications/" class="md-tabs__link">
        
  
  
    
  
  Technical specifications

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="European Digital Identity" class="md-nav__button md-logo" aria-label="European Digital Identity" data-md-component="logo">
      
  <img src="../../media/eu-logo.jpg" alt="logo">

    </a>
    European Digital Identity
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    European Digital Identity Wallet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture-and-reference-framework-main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture and reference framework
    
      <br>
      <small>Architecture and Reference Framework</small>
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discussion topics
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical-specifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical specifications
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="g-zero-knowledge-proof">G - Zero Knowledge Proof</h1>
<p>Version 1.0, updated 18 March 2025</p>
<p><a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework/discussions/408">GitHub discussion</a></p>
<h2 id="1-introduction">1. Introduction</h2>
<h3 id="11-discussion-paper-topic-description">1.1 Discussion Paper topic description</h3>
<p>This document is the Discussion Paper for European Digital Identity Cooperation Group regarding
Topic G: Zero Knowledge Proof.</p>
<p>The ARF Development Plan [ARF_DevPlan] describes this Topic as follows:</p>
<p>ZKP offer strong potential as a privacy-enhancing technique. It should be
revisited to determine the foundational requirements needed for its future
integration, particularly focusing on defining specific requirements for
implementing ZKP by using any type of WSCD/WSCA.</p>
<h3 id="12-related-risks-in-the-risk-register">1.2 Related risks in the Risk Register</h3>
<p>Risks considered in [Topic_A] are also applicable here</p>
<h2 id="13-key-words">1.3 Key words</h2>
<p>This document uses the capitalised key words 'SHALL', 'SHOULD' and 'MAY' as
specified in RFC 2119, i.e., to indicate requirements, recommendations and
options specified in this document.</p>
<p>In addition, 'must' (non-capitalised) is used to indicate an external
constraint, for instance a self-evident necessity or a requirement that is
mandated by an external document. The word 'can' indicates a capability, whereas
other words, such as 'will' and 'is' or 'are' are intended as statements of
fact.</p>
<h2 id="14-document-structure">1.4 Document structure</h2>
<p>This document is structured as follows:</p>
<ul>
<li>Chapter 2 presents privacy properties of Zero-Knowledge Proof schemes.</li>
<li>Chapter 3 introduces families of Zero-Knowledge Proof schemes and gives an
overview of representative solutions</li>
<li>Chapter 4 discusses topics related to the integration of Zero-Knowledge Proof schemes
into the ARF</li>
<li>Chapter 5 lists the additions and changes that will be made to the ARF
as a result of discussing this topic with Member States.</li>
</ul>
<h2 id="2-zero-knowledge-proof-technology-legal-requirements-and-privacy-properties">2. Zero-Knowledge Proof technology, legal requirements and privacy properties</h2>
<p>Regulation (EU) 2024/1183 of the European Parliament and of the Council of 11
April 2024 amending Regulation (EU) No 910/2014 as regards establishing the
European Digital Identity Framework [European Digital Identity Regulation], Recital 14, discusses the use of
privacy-preserving technologies, such as zero knowledge proof:</p>
<blockquote>
<p>Member States should integrate different privacy-preserving technologies, such
as zero knowledge proof, into the European Digital Identity Wallet. Those
cryptographic methods should allow a relying party to validate whether a given
statement based on the person’s identification data and attestation of
attributes is true, without revealing any data on which that statement is based,
thereby preserving the privacy of the user.</p>
</blockquote>
<p>Similarly, Recital 15 of [European Digital Identity Regulation] mentions:</p>
<blockquote>
<p>All Union citizens [...] should be empowered to securely request, select, combine,
store, delete, share and present data related to their identity [...] while enabling
selective disclosure of personal data</p>
</blockquote>
<p>Recital 59 of [European Digital Identity Regulation] provides the following definition and requirements for
selective disclosure:</p>
<blockquote>
<p>Selective disclosure is a concept empowering the owner of data to disclose only
certain parts of a larger data set, in order for the receiving entity to obtain
only such information as is necessary for the provision of a service requested by
a user. The European Digital Identity Wallet should technically enable the
selective disclosure of attributes to relying parties. It should be technically
possible for the user to selectively disclose attributes, including from multiple,
distinct electronic attestations, and to combine and present them seamlessly to
relying parties. This feature should become a basic design feature of European
Digital Identity Wallets, thereby reinforcing convenience and the protection of
personal data, including data minimisation.</p>
</blockquote>
<p>Furthermore, Article 5a, 16 of [European Digital Identity Regulation] mandates for "the technical framework
of the European Digital Identity Wallet" to:</p>
<blockquote>
<p>(a) not allow providers of electronic attestations of attributes or any other
party, after the issuance of the attestation of attributes, to obtain data that
allows transactions or user behaviour to be tracked, linked or correlated,
or knowledge of transactions or user behaviour to be otherwise obtained, unless
explicitly authorised by the user;
(b) enable privacy preserving techniques which ensure unlinkability, where the
attestation of attributes does not require the identification of the user.</p>
</blockquote>
<p>Finally, article 11a.2 of [European Digital Identity Regulation] mandates that:</p>
<blockquote>
<p>Member States shall provide for technical and organisational measures to
ensure a high level of protection of personal data used for identity matching
and to prevent the profiling of users.</p>
</blockquote>
<p>With all these in mind, the goal of this discussion paper is to establish High
Level Requirements for the use of the Zero-Knowledge Proof technology in ARF.</p>
<p>A Zero-Knowledge Proof (ZKP) is a cryptographic protocol that allows one party
(the prover) to convince another party (the verifier) that a given statement is
true without revealing any additional information beyond the validity of the
statement itself. This ensures that the verifier gains no knowledge about how
the prover knows the statement to be true, preserving privacy while enabling trust.</p>
<p>A ZKP system must satisfy three key properties:</p>
<ul>
<li>Completeness: If the statement is true and both the prover and verifier follow
the protocol correctly, the verifier will be convinced of its validity.</li>
<li>Soundness: If the statement is false, a dishonest prover cannot convince an
honest verifier that it is true, except with some negligible probability.</li>
<li>Zero-Knowledge: If the statement is true, the verifier learns nothing beyond
the fact that the statement is correct.</li>
</ul>
<p>ETSI TR 119 476 [ETSI_119476] defines the following privacy-preserving
properties that may be provided by a ZKP scheme:</p>
<ul>
<li>Selective disclosure: A Wallet Unit can be enabled to present a subset of
attributes from at least one, but potentially multiple, (Qualified) Electronic
 Attestations of Attributes ((Q)EAAs).</li>
<li>Relying Party unlinkability: Relying Party unlinkability means that one or more
Relying Parties cannot collude to determine if the selectively disclosed
attributes describe the same User</li>
<li>Full unlinkability: Full unlinkability means that no party can collude to
determine if the selectively disclosed attributes describe the same User. This
includes PID Providers or Attestation Providers colluding with Relying Parties.</li>
</ul>
<p>Additional privacy properties have also been defined in related literature. Such
properties are:</p>
<ul>
<li>Range proofs: A ZKP scheme may enable a Wallet Unit to prove that the value of
an attribute within an attestation satisfies a specific condition without
revealing the exact value. For example, the scheme could allow a Wallet Unit to
prove that their "year of birth" is earlier than 2007 without disclosing the
actual year.</li>
<li>Privacy preserving revocation: A ZKP scheme may allow a Wallet Unit to prove
that a presented attestation is not included in a revocation list without
revealing any additional information. This proof is randomised to prevent
linkage across different verifications, ensuring that it cannot be used to track
or identify a specific User.</li>
<li>Issuer hiding: A ZKP scheme may allow a Wallet Unit to prove that an
attestation was issued by a trusted PID Provider or Attestation Provider—i.e., a
PID Provider or Attestation Provider included in a
predefined trusted list—without disclosing any additional information about the
specific PID Provider or Attestation Provider.</li>
<li>Pseudonymity: In some use cases, Relying Party unlinkability is not a
desirable property, and a Relying Party may need to correlate multiple
presentations of the same attestation to the same User (e.g., in the case of
"returning customers"). A ZKP scheme may allow Wallet Units to generate such
"correlation proofs" while still preserving user privacy to the extent required.</li>
<li>Deniable Issuance and Presentation: A ZKP scheme may allow for repudiation of issued
and/or presented attestations.</li>
<li>Composite Proofs: A ZKP scheme may allow a Wallet Unit to generate
presentations over several attestations with hidden attribute binding (present
vaccination credential + PID with matching name without revealing name).</li>
<li>(Partially) Blind Issuance: A ZKP scheme may enable PID Providers or Attestation
Providers to issue attestations with attributes that remain hidden towards
the providers (but can be verifiably transferred from other attestations).</li>
<li>Conditional Disclosure: A ZKP scheme may allow a Wallet Unit to generate attestation
presentations that contains verified but hidden attributes – which can be
discovered by dedicated party, e.g., personal address only accessible to postal service, not
online shop; credit card number revealed only in case of no-show.</li>
</ul>
<h2 id="3-available-zero-knowledge-proof-schemes">3. Available Zero-Knowledge Proof schemes</h2>
<p>Following ETSI TR 119 476 [ETSI_119476], ZKP schemes can be categorised into
<em>multi-message signature schemes</em> and <em>proofs for arithmetic circuits</em>.</p>
<h3 id="31-multi-message-signature-schemes">3.1 Multi-message signature schemes</h3>
<p>From a high-level perspective, multi-message signature-based solutions are
implemented as follows. Initially, a PID Provider or Attestation Provider constructs an attestation that can
be represented in the form of a list of messages. Then it uses a group signature
algorithm and generates a (short) signature over the group of messages. A
Wallet Unit can now selectively hide any of the messages and generate a
ZKP which proves that “the Wallet Unit possesses a list of messages that
together with the revealed ones can verify the signature of the PID Provider or Attestation Provider. A
scheme of this category is BBS+ and its variant BBS#.</p>
<h4 id="311-bbsbbs">3.1.1 BBS+/BBS</h4>
<p>BBS+ is a digital signature protocol which is used for signing a group of
messages.  It was first envisioned by Boneh, Boyen, Shacham in [BBS2024] (from
where it takes its name), touched and re-visited by [Cam2016]. Currently under
standardisation by the IRTF Crypto Forum Research Group, BBS+ provides the ability to
sign a group of individual messages, with only a single constant size signature.
The signature can be validated given the signer’s Public Key (PK) and the entire
group of signed messages; this is equivalent to validating a “traditional”
digital signature, if we consider the group of messages as a single compound
message. BBS+ can be combined with ZKPs allowing an entity to selectively hide
elements of a singed group of messages. In particular, any entity that knows the
signature and the original signed group of messages, can create a proof of
knowledge of the signature while selectively disclosing only a sub-array of the
signed messages. The proof can be validated with only the signer’s public key
and the array of revealed messages. BBS+ is based on pairing friendly curves.
BBS# [Ora2024] is a modification of BBS+ allowing group signatures and
selective disclosure based on ECDSA, hence it can be used with existing WSCDs.</p>
<h4 id="312-advantages">3.1.2 Advantages</h4>
<ul>
<li>
<p>Performant with low computational and communication overhead</p>
</li>
<li>
<p>They are generic and they can be used with any type of attestation</p>
</li>
</ul>
<h4 id="313-disadvantages">3.1.3 Disadvantages</h4>
<ul>
<li>Require changes in the attestation signing process using digital signature schemes
 that are not widely supported yet on the issuer side</li>
</ul>
<h3 id="32-proofs-for-arithmetic-circuits-programmable-zkps">3.2 Proofs for arithmetic circuits (programmable ZKPs)</h3>
<p>These solutions are based on a program expressed in the form of an arithmetic
circuit. This circuit receives a secret input, referred to as the witness,
which can be for example an attestation, as well as a public statement. The
circuit performs a calculation and outputs true if certain conditions hold (e.g.,
“the attestation includes an age attribute with value &gt; 18”). A Wallet Unit,
can then generates a ZKP which proves that “the Wallet Unit knows a witness (e.g.,
an attestation), which when provided as input to a certain circuit using the
provided statement, the circuit outputs true”. Zero-Knowledge Succinct Non-Interactive
Arguments of Knowledge (zk-SNARK) is a representative scheme of this category.</p>
<h4 id="321-zk-snarks">3.2.1 zk-SNARKs</h4>
<p>zk-SNARKs are ZKP schemes based on arithmetic circuits. Circuits can be
constructed for arbitrary programs expressed using a Domain Specific Language
(DSL) and an appropriate compiler. zk-SNARK solutions require a setup phase
where a circuit is mapped to some public parameters, which must be known both to
the prover and the verifier. This setup phase may require a secret input, which
must be hidden from the prover (trusted setup) or it may not require a secret input (transparent setup).
Furthermore, the secret input may be required for setting up all circuits, or
only for a specific universal setup phase. The setup phase has an impact on the
size of proof and the verification time. Recent advances in this area, such as
[Fri2024] and [Paq2024] have demonstrated interoperability with existing attestation formats. A
key challenge that these new proposals aim to address is that many multi-message signature schemes,
like BBS+, rely on new cryptographic assumptions that require system-wide
changes to PID Providers' and Attestation Providers' infrastructure. Additionally, PID Providers or Attestation Providers often mandate that
attestations be device-bound, integrating secure elements into the authentication
process. This further complicates adoption, as multi-message signature schemes would
necessitate either updates to both hardware secure elements and operating systems
across all user devices, or additional interactions between Wallet Units and PID Providers or Attestation Providers, whereas
some zk-SNARKs solutions, such as [Fri2024], can support
this function without requiring such modifications.</p>
<h4 id="advantages">Advantages</h4>
<ul>
<li>Can be used with existing signature algorithms. Do not require any change to
the attestation signing process</li>
</ul>
<h4 id="disadvantages">Disadvantages</h4>
<ul>
<li>
<p>Introduce computational overhead and in some cases storage overhead</p>
</li>
<li>
<p>Per use case circuits are required.</p>
</li>
</ul>
<h2 id="4-discussion">4. Discussion</h2>
<h3 id="41-expectations-from-zkp-systems">4.1 Expectations from ZKP systems</h3>
<p>In Chapter 2, we introduced key privacy properties of Zero-Knowledge Proof (ZKP)
systems. Some of these properties can also be achieved using non-ZKP mechanisms.
For example, selective disclosure can be implemented using salted and hashed
data signatures, while batch issuance can help achieve unlinkability between
presentations of the same credential. Similarly, short-lived certificates may be
preferred to privacy-preserving revocation. On the other hand, certain privacy
properties can only be ensured through ZKPs. Similarly, replacing these mechanisms
with ZKP schemes may result in simpler protocols and attestation management processes.</p>
<p>Similarly, the need for privacy varies across use cases. In some scenarios, full
identity verification is required, such as when opening a bank account. In
contrast, other cases may only require proving a specific attribute or a
property of an attribute—such as proving that a user is over 18 without
revealing their exact birthdate. In cases where full identity verification is
necessary, achieving unlinkability may not always be possible. Indeed, this is also
recognised by the [European Digital Identity Regulation] which in Article 5a, 16b
mandates unlinkability "where the attestation of attributes does not require the
identification of the user". In the following we identify use cases where ZKP shall be
used when it becomes available.</p>
<h4 id="411-selective-disclosure-of-an-attribute">4.1.1 Selective disclosure of an attribute</h4>
<p>In many cases, Users are required to prove that they possess a PID or attestation
that includes a specific attribute without revealing additional information about
their identity. For example, they may need to prove possession of a PID that
includes the "age over 18" attribute or a specific city. A ZKP scheme can be used
in this use case to provide privacy-preserving selective disclosure for both remote
and proximity flows.</p>
<p>A ZKP scheme shall hide all attributes of the PID or attestation while providing proofs that:</p>
<ul>
<li>The PID or attestation includes the revealed attribute.</li>
<li>The PID or attestation is within its validity period.</li>
<li>The PID or attestation has not been revoked.</li>
<li>The PID or attestation has been issued by a trusted issuer, optionally without
revealing the issuer.</li>
<li>The PID or attestation is bound to a key stored in the WSCD of the Wallet User.</li>
</ul>
<h4 id="412-proof-of-personhood">4.1.2 Proof of personhood</h4>
<p>Many online services require users to prove that they are not robots. Currently,
this is usually done using CAPTCHA. According to a recent report, it takes a user
an average of 32 seconds to complete a CAPTCHA [Clo2021]. If a user could prove possession
of a PID, this would serve as a sufficient indication that the user is a human
being. A ZKP scheme can be used to provide a privacy-preserving proof of personhood.</p>
<p>In fact, this is a simpler form of the selective disclosure use case, as a ZKP scheme
shall provide the same proofs, except for the proof that "the PID or attestation includes
the revealed attribute."</p>
<p>For this use case, a suitable rate limiting mechanisms shall be used. The fact that
a user shall authenticate to the WSCD before generating a proof is such a suitable
mechanism.</p>
<h4 id="413-proof-of-attestation">4.1.3 Proof of attestation</h4>
<p>The previous use case can be generalised to any type of attestation. For example,
Users may want to prove that they are students (e.g., to receive a discount) without
revealing any additional information about their identity. This should be possible
for both remote and proximity presentation flows.</p>
<h4 id="414-privacy-preserving-binding-of-an-attestation-to-a-pid">4.1.4 Privacy-preserving binding of an attestation to a PID</h4>
<p>In many cases, "simple" attestations may need to be linked to the PID of a User.
For example, some countries require tickets for sporting events to include the User's
identity number. As a consequence, tickets for different sporting events can be
linked to the same User. Similarly, such information was included in the
implementation of some countries' COVID vaccination certificates.
By using a ZKP scheme and composite proofs, a Wallet Unit can generate a proof
that an attestation includes an attribute (e.g., <code>personal_administrative_number</code>),
which is also present in the User's PID, without revealing any information about
this attribute or any other attributes contained in the PID.
In addition to this binding, the ZKP scheme should also provide the same proofs
as the "Proof of Personhood" use case.</p>
<h4 id="415-privacy-preserving-linking-of-an-attestation-to-a-relying-party-identifier">4.1.5 Privacy preserving linking of an attestation to a Relying Party identifier</h4>
<p>In some use cases, a Relying Party needs to correlate multiple presentations of
the same attestation (e.g., to detect a "returning customer"). A ZKP scheme can
be used to derive a pseudonym by combining an attribute of an attestation that
is unique to the User with the Relying Party identifier.</p>
<p>A related solution shall have the following properties:</p>
<ul>
<li>The attribute used for deriving the pseudonym shall be hidden from the
Relying Party.</li>
<li>The attribute used for deriving the pseudonym shall also be hidden from the
Provider; otherwise, a colluding Provider and Relying Parties would be able to
correlate User presentations. This property can be achieved using blind issuance.</li>
</ul>
<h3 id="42-device-binding-using-wscd">4.2 Device binding using WSCD</h3>
<p>According to ARF "User binding [...] is the property that the subject of the PID
or attestation [...] is in fact the person that presents the PID or attestation
to the Relying Party." The simplest approach for implementing User binding is by
binding an attestation to a Wallet Secure Cryptographic Device (WSCD), aka
device binding, and then trusting the User authentication mechanisms implemented
by the WSCD. A PID Provider or Attestation Provider implements device
binding by including a cryptographic public key in the attestation and signing
it. The corresponding private key is protected by a certified WSCD in the Wallet
Unit. During an interaction, the Relying Party verifies that the PID or
attestation it received from a Wallet Unit is indeed bound to the WSCD included
in the Wallet Unit. The Relying Party does so by requesting the Wallet Unit to
sign some data using the private key corresponding to the public key in the PID
or attestation.</p>
<p>A ZKP scheme should achieve the same functionality in a privacy-preserving
manner. Specifically, using a ZKP scheme, a Wallet Unit should be able to prove
that it knows a valid signature that can be verified using the public key
included in the PID or attestation—without revealing either the signature or the
public key.</p>
<h3 id="43-performance">4.3 Performance</h3>
<p>ZKP schemes may introduce computational, communication, or storage overhead,
which can impact their practicality in real-world deployments. For example,
zkSNARKs may take several seconds to generate a proof, require tens or even hundreds
of megabytes of auxiliary data per attestation type—data that must be stored and
processed by the User’s device—and produce proofs that are several kilobytes in size.</p>
<p>To ensure usability, ZKP schemes should strike a balance between security and
efficiency, introducing only tolerable levels of overhead.</p>
<p>A ZKP-based solution should remain usable and feasible across different presentation
flows. Acceptable delays due to ZKP processing vary depending on the use case.
For instance, using an attestation in a proximity flow to enter a stadium imposes
stricter time constraints compared to a remote, cross-device presentation flow used
for user authentication. Likewise, technologies used for attestation presentation,
such as QR codes, NFC, and BLE, impose stricter requirements regarding the size of
the presented data.</p>
<h3 id="44-attestation-format-support">4.4 Attestation format support</h3>
<p>Implementing a ZKP solution may require modifications to the existing
attestation format. For instance, new fields might need to be added to the
attestation presentation to include the proof itself, proof parameters (e.g.,
the “index” of messages in multi-message signature formats), and other relevant
data. These changes must align with the specifications of the relevant message
format standards (e.g, ISO mdoc). Additionally, future versions of ARF may
define different ZKP schemes for proximity and remote presentation flows.
Regardless of the specific approach, ZKP scheme providers should collaborate
with relevant standardisation bodies to ensure their schemes remain compatible
with the corresponding attestation formats.</p>
<h3 id="45-integration-with-issuance-and-presentation-protocols">4.5 Integration with issuance and presentation protocols</h3>
<p>ZKP schemes may require modifications to the message format of the issuance and
presentation protocols, as well as adjustments to the metadata format used by
PID Providers or Attestation Providers. These changes could include new
fields for specifying ZKP parameters,
signaling ZKP support, and other relevant metadata. To ensure interoperability,
ZKP scheme providers should collaborate with standardisation bodies to maintain
compatibility with the corresponding protocols.</p>
<p>Additionally, support for ZKP schemes is expected to follow the launch of the EUDI
Wallet. PID Providers and Attestation Providers will likely have already invested
in PID and attestation issuance infrastructure and software, with many PIDs and attestations
already issued. A ZKP system should be designed to minimise disruptions to the existing
issuance ecosystem at the time of its deployment.</p>
<p>Beyond changes to existing protocols, ZKP schemes may introduce additional
interactions. For example, zkSNARK-based schemes may require the distribution of
public parameters from PID Providers or Attestation Providers to Wallet Units and/or to Relying Parties.
Other schemes, such as BBS#, may require pre-computations that involve
communication between a Wallet Unit and a PID Provider or Attestation Provider, before a proof can be
generated. Privacy-preserving revocation mechanisms may also require Wallet
Units to retrieve cryptographic accumulators before generating a proof.</p>
<p>The frequency and overhead of these interactions vary significantly. Public
parameters may only need to be distributed once per attestation type, while
pre-computation steps might need to be performed for every N presentations.
Additionally, the impact of these interactions differs depending on scale; e.g.,
high-volume interactions initiated by thousands of Wallet Units could impose a
significant load on PID Providers or Attestation Providers and other network participants.
These interactions shall not result in User tracking or linkability.</p>
<h3 id="46-additional-desirable-properties-from-zkp-based-systems">4.6 Additional desirable properties from ZKP-based systems</h3>
<p>Beyond the privacy properties of ZKP schemes presented in Section 2, a ZKP-based
system may also offer additional security properties.
A ZKP-based system may be extendable and updatable to accommodate future advancements
in security and performance. For instance, in a zkSNARK-based system, the arithmetic
circuits used for proof generation could be replaced or optimised to enhance
efficiency or mitigate newly discovered vulnerabilities. Likewise, a ZKP-based
system should be agile, allowing adaptability to different cryptographic
primitives. For example, a solution based on multi-message signatures could
support various elliptic curve types, enabling flexible deployment across different
environments and security requirements.</p>
<h2 id="5-additions-and-changes-to-the-arf">5 Additions and changes to the ARF</h2>
<h3 id="51-high-level-requirements-to-be-added-to-annex-2">5.1 High-Level Requirements to be added to Annex 2</h3>
<p>The following High-Level Requirements will be added to Annex 2 of the ARF</p>
<h4 id="requirement-1">REQUIREMENT 1</h4>
<p>Irrespectively of the use case, a ZKP scheme SHALL provide support for the following generic functions: (i) generation of a proof that an (some) attribute(s) is (are) included in a PID or attestation (ii) generation of a proof that a PID or attestation is within its validity period (iii) generation of a proof that a PID or attestation has not been revoked (iv) generation of a proof that a PID or attestation is bound to a key stored in the WSCD of the Wallet User (v) generation of a proof that a PID or attestation has been issued by a trusted issuer without revealing the issuer. NOTE: Although function (vi) SHALL be supported
it should be used only when issuer hiding is necessary.</p>
<h4 id="requirement-2">REQUIREMENT 2</h4>
<p>A ZKP scheme SHALL support the selective disclosure of an attribute use case for remote or proximity-based presentation flows.</p>
<h4 id="requirement-3">REQUIREMENT 3</h4>
<p>A ZKP scheme SHALL support the  proof of attestation possession use case for proximity-based or remote presentation flows.</p>
<h4 id="requirement-4">REQUIREMENT 4</h4>
<p>A ZKP scheme SHALL support the proof of personhood use case for remote presentation flows.</p>
<h4 id="requirement-5">REQUIREMENT 5</h4>
<p>A ZKP scheme SHOULD support the privacy-preserving binding of an attestation to a PID
use case for proximity-based or remote presentation flows. In addition to the generic
functions defined in REQUIREMENT 1, for this use case, a ZKP scheme SHALL provide support
for the following functions: (i) generation of a proof that the Wallet Unit stores an
attestation and a PID and that the attestation includes a specific attribute also present
in the PID</p>
<h4 id="requirement-6">REQUIREMENT 6</h4>
<p>A ZKP scheme SHOULD support the privacy-preserving linking of an attestation to a Relying
Party identifier use case for proximity-based or remote presentation flows. In addition to
the generic functions defined in REQUIREMENT 1, for this use case, a ZKP scheme SHALL
provide support for the following functions: (i) generation of a request for the issuance of
an attestation that includes a secret attribute unique to the User, without revealing this
attribute to the Attestation Provider (ii) generation of an attestation presentation that
includes a verifiable pseudonym derived from the secret attribute and the Relying Party
identifier.</p>
<h4 id="requirement-7">REQUIREMENT 7</h4>
<p>ZKP scheme SHALL be usable with the intended remote and proximity presentation flows. While the inclusion of ZKP may introduce computational and verification delays, these delays shall not  degrade the user experience</p>
<h4 id="requirement-8">REQUIREMENT 8</h4>
<p>The selected ZKP scheme SHOULD be able to generate proofs for already issued attestations in different formats</p>
<h4 id="requirement-9">REQUIREMENT 9</h4>
<p>A ZKP scheme SHALL NOT introduce any
additional communication or information that could be used to track or link User activity
during, before, or after proof generation.</p>
<h4 id="requirement-10">REQUIREMENT 10</h4>
<p>A ZKP scheme SHALL NOT use proprietary solutions</p>
<h4 id="requirement-11">REQUIREMENT 11</h4>
<p>A ZKP scheme SHALL be designed to support migration to post-quantum safe algorithms.</p>
<h3 id="52-high-level-requirements-to-be-changed">5.2 High-Level Requirements to be changed</h3>
<h3 id="53-descriptions-to-be-added-to-the-arf-main-document">5.3 Descriptions to be added to the ARF main document</h3>
<h2 id="6-references">6 References</h2>
<table>
<thead>
<tr>
<th>Reference</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>[ARF_DevPlan]</td>
<td>Architecture and Reference Framework Development plan 2025, European Commission, v0.91, final draft</td>
</tr>
<tr>
<td>[BBS2024]</td>
<td>Boneh, Dan, Xavier Boyen, and Hovav Shacham. "Short group signatures." In Annual international cryptology conference, pp. 41-55. Berlin, Heidelberg: Springer Berlin Heidelberg, 2004.</td>
</tr>
<tr>
<td>[Cam2016]</td>
<td>Camenisch, Jan, Manu Drijvers, and Anja Lehmann. "Anonymous attestation using the strong diffie hellman assumption revisited." In Trust and Trustworthy Computing: 9th International Conference, TRUST 2016, Vienna, Austria, August 29-30, 2016, Proceedings 9, pp. 1-20. Springer International Publishing, 2016</td>
</tr>
<tr>
<td>[Clo2021]</td>
<td>Cloudflare, Humanity wastes about 500 years per day on CAPTCHAs. It’s time to end this madness, available at <a href="https://blog.cloudflare.com/introducing-cryptographic-attestation-of-personhood">https://blog.cloudflare.com/introducing-cryptographic-attestation-of-personhood</a></td>
</tr>
<tr>
<td>[European Digital Identity Regulation]</td>
<td>Regulation (EU) 2024/1183 of the European Parliament and of the Council of 11 April 2024 amending Regulation (EU) No 910/2014 as regards establishing the European Digital Identity Framework</td>
</tr>
<tr>
<td>[ETSI_119476]</td>
<td>ETSI TR 119 476 V1.2.1, Electronic Signatures and Trust  Infrastructures (ESI); Analysis of selective disclosure and zero-knowledge proofs applied to Electronic Attestation of Attributes</td>
</tr>
<tr>
<td>[Fri2024]</td>
<td>Matteo Frigo and abhi shelat, Anonymous credentials from ECDSA, Cryptology ePrint Archive, Paper 2024/2010, 2024, available at <a href="https://eprint.iacr.org/2024/2010">https://eprint.iacr.org/2024/2010</a></td>
</tr>
<tr>
<td>[Ora2024]</td>
<td>Orange, “The BBS# protocol”, Technical Report, 2024</td>
</tr>
<tr>
<td>[Paq2024]</td>
<td>Christian Paquin, Guru-Vamsi Policharla, and Greg Zaverucha, Crescent: Stronger Privacy for Existing Credentials, Cryptology ePrint Archive, Paper 2024/2013, 2024, available at <a href="https://eprint.iacr.org/2024/2013">https://eprint.iacr.org/2024/2013</a></td>
</tr>
<tr>
<td>[RiskRegister]</td>
<td>Annex 1 to the Commission Implementing Regulation (EU) 2024/2981 of 28 November 2024 laying down rules for the application of Regulation (EU) No 910/2014 of the European Parliament and the Council as regards the certification of European Digital Identity Wallets</td>
</tr>
<tr>
<td>[Topic_A]</td>
<td>Discussion Paper for the European Digital Identity Cooperation Group regarding Topic A: Privacy risks and mitigation, version 1.0</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.path", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>