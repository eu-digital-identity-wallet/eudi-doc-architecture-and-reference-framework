
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.4.0/discussion-topics/x-relying-party-registration/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>X relying party registration - European Digital Identity</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        
        <link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.49ea35f2.css">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="X relying party registration - European Digital Identity" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.4.0/assets/images/social/discussion-topics/x-relying-party-registration.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.4.0/discussion-topics/x-relying-party-registration/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="X relying party registration - European Digital Identity" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://eu-digital-identity-wallet.github.io/eudi-doc-architecture-and-reference-framework/2.4.0/assets/images/social/discussion-topics/x-relying-party-registration.png" >
      
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#topic-x-relying-party-registration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="European Digital Identity" class="md-header__button md-logo" aria-label="European Digital Identity" data-md-component="logo">
      
  <img src="../../media/eu-logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            European Digital Identity
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              X relying party registration
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  European Digital Identity Wallet

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../architecture-and-reference-framework-main/" class="md-tabs__link">
        
  
  
    
  
  Architecture and reference framework

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  Discussion topics

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../technical-specifications/" class="md-tabs__link">
        
  
  
    
  
  Technical specifications

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="European Digital Identity" class="md-nav__button md-logo" aria-label="European Digital Identity" data-md-component="logo">
      
  <img src="../../media/eu-logo.jpg" alt="logo">

    </a>
    European Digital Identity
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    European Digital Identity Wallet
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture-and-reference-framework-main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture and reference framework
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discussion topics
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical-specifications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Technical specifications
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<p>Version 0.4, updated 25 April 2025</p>
<p><a href="https://www.github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework/discussions/431">Link to GitHub discussion</a></p>
<h1 id="topic-x-relying-party-registration">Topic X - Relying Party Registration</h1>
<h3 id="legal-notice-all-legal-information-and-excerpts-documented-in-section-2-is-based-on-the-european-digital-identity-regulation-eu-20241183-and-the-current-public-consultation-draft-of-the-commission-implementing-regulation-for-relying-party-registration-the-latter-is-undergoing-changes-due-to-consultation-process-and-thus-this-document-may-need-modification-after-the-publication-and-approval-of-the-final-cir">Legal notice: All legal information and excerpts documented in Section 2 is based on the European Digital Identity Regulation (EU) 2024/1183 and the current public consultation draft of the Commission Implementing Regulation for Relying Party registration. The latter is undergoing changes due to consultation process, and thus this document may need modification after the publication and approval of the final CIR.</h3>
<h2 id="1-introduction">1 Introduction</h2>
<h3 id="11-discussion-paper-topic-description">1.1 Discussion Paper Topic Description</h3>
<p>This document is the Discussion Paper for the European Digital Identity Cooperation Group regarding Topic X: Relying Party registration.
The ARF Development Plan [ARF_DevPlan] describes this Topic as follows:</p>
<p><em>This topic is to gather High level Requirements (HLR) for Relying Party registration. The HLR relate to information necessary for authentication to access European Digital Identity Wallets, and to relying parties’ contact details and their intended use of wallets, including what data relying parties may ask users for</em>.</p>
<h3 id="12-key-words">1.2 Key Words</h3>
<p>This document uses the capitalised key words 'SHALL', 'SHOULD' and 'MAY' as specified in RFC 2119, i.e., to indicate requirements, recommendations and options specified in this document.
In addition, 'must' (non-capitalised) is used to indicate an external constraint, for instance a self-evident necessity or a requirement that is mandated by an external document. The word 'can' indicates a capability, whereas other words, such as 'will', 'is' or 'are' are intended as statements of fact.</p>
<h3 id="13-document-structure">1.3 Document Structure</h3>
<p>The document is structured as follows:</p>
<ul>
<li>
<p>Chapter 2 presents the legal requirements for functionality related to the Relying Party registration.</p>
</li>
<li>
<p>Chapter 3 presents and discusses a list of identified issues, with suggested changes and/or new High-Level Requirements related to this topic.</p>
</li>
<li>
<p>Chapter 4 presents a log of the additions and changes that will be made to High Level Requirements in the ARF as a result of discussing this topic with Member States.</p>
</li>
<li>
<p>Chapter 5 refers to other topics related to Relying Party registration.</p>
</li>
<li>
<p>Chapter 6 presents the additions and changes that will be made to the ARF main document as a result of discussions.</p>
</li>
</ul>
<h2 id="2-legal-requirements-for-relying-party-registration">2 Legal Requirements for Relying Party registration</h2>
<p>Two legal texts impose direct requirements on the Relying Party registration: The evolving <a href="https://tinyurl.com/IA-5b-draft">Draft of the CIR for RP-Registration</a> and the [European Digital Identity Regulation]. This section recaps the respective legal requirements from these sources.</p>
<h3 id="21-european-digital-identity-regulation-about-relying-party-registration">2.1 [European Digital Identity Regulation] about Relying Party registration</h3>
<p>The [European Digital Identity Regulation] requires the Relying Parties to be registered. It specifies the following requirements related to Relying Party registration:</p>
<ol>
<li>Setting up national registers of registered wallet-relying parties in each Member State</li>
<li>Registering Relying Party needs to provide at minimum, a definite set of information necessary to authenticate to EUDI Wallets including the intended use and indication of data requested for this use from the user</li>
<li>Relying Parties shall only request data that is registered for the intended use</li>
<li>Member States shall make the Relying Party register information available to the public in a manner that is both human and machine-readable</li>
<li>Member States shall provide a common mechanism for authenticating the Relying Parties in the European Digital Identity ecosystem</li>
<li>An Intermediary that is acting on behalf of relying parties is deemed to be a Relying Party, but shall not store data exchanged between the EUDI Wallet user and intermediated Relying Party</li>
<li>The European Commission shall establish technical specifications and procedures to support the registration process, publication of the registries, updates of registration information by means of implementing acts.</li>
</ol>
<p>Below are the actual excerpts from the Regulation, including the recitals and the Articles that establish these requirements.</p>
<p><strong>Recital (17)</strong></p>
<p><em>For the purposes of registration, relying parties should provide the information necessary to allow for their electronic identification and authentication towards European Digital Identity Wallets. When declaring their intended use of the European Digital Identity Wallet, relying parties should provide information regarding the data that they will request, if any, in order to provide their services and the reason for the request.
Relying party registration facilitates the verification by Member States with regard to the lawfulness of the activities of the relying parties in accordance with Union law. The obligation to register provided for in this Regulation should be without prejudice to obligations laid down in other Union or national law, such as the information to be provided to the data subjects pursuant to the Regulation (EU) 2016/679. Relying parties should comply with the safeguards offered by Articles 35 and 36 of that Regulation, in particular by performing data protection impact assessments and by consulting the competent data protection authorities prior to data processing where data protection impact assessments indicate that the processing would result in a high risk. Such safeguards should support the lawful processing of personal data by relying parties, in particular with regard to special categories of data, such as health data. The registration of relying parties is intended to enhance transparency and trust in the use of European Digital Identity Wallets.
Registration should be cost-effective and proportionate to the related risks in order to ensure uptake by service providers. In that context, registration should provide for the use of automated procedures, including the reliance on and the use of existing registers by Member States, and should not entail a pre-authorisation process.
The registration process should enable a variety of use-cases that can differ in terms of mode of operation, whether online or in offline mode, or in terms of the requirement to authenticate devices for the purposes of interfacing with the European Digital Identity Wallet.
Registration should apply exclusively to relying parties providing services by means of digital interaction.</em></p>
<p><strong>Recital (18)</strong></p>
<p><em>Safeguarding Union citizens and residents in the Union against the unauthorised or fraudulent use of European Digital Identity Wallets is of high importance for ensuring trust in and for the wide uptake of European Digital Identity Wallets. Users should be provided with effective protection against such misuse. In particular, when facts that form the basis for fraudulent or otherwise illegal use of a European Digital Identity Wallet are established by a national judicial authority in the context of another procedure, supervisory bodies that are responsible for European Digital Identity Wallet issuers should, upon notification, take the necessary measures to ensure that the registration of the relying party and the inclusion of relying parties in the authentication mechanism are withdrawn or suspended until the notifying authority confirms that the irregularities identified have been remedied.</em></p>
<p><strong>Article 3</strong></p>
<p>Definitions</p>
<p><em>‘relying party’ means a natural or legal person that relies upon electronic identification, European Digital Identity Wallets or other electronic identification means, or upon a trust service;</em></p>
<p><strong>Article 5b - European Digital Identity Wallet-Relying Parties</strong></p>
<ol>
<li><em>Where a relying party intends to rely upon European Digital Identity Wallets</em>
<em>for the provision of public or private services by means of digital</em>
<em>interaction, the relying party shall register in the Member State where it is</em>
<em>established.</em></li>
<li><em>The registration process shall be cost-effective and proportionate-to-risk.</em>
<em>The relying party shall provide at least:</em>
<em>(a) the information necessary to authenticate to European Digital Identity Wallets, which as a minimum includes:</em>
<em>(i) the Member State in which the relying party is established; and</em>
<em>(ii) the name of the relying party and, where applicable, its registration number as stated in an official record together with identification data of that official record;</em>
<em>(b) the contact details of the relying party;</em>
<em>(c) the intended use of European Digital Identity Wallets, including a indication of the data to be requested by the relying party from users.</em></li>
<li><em>Relying parties shall not request users to provide any data other than that</em>
<em>indicated pursuant to paragraph 2, point (c).</em></li>
<li><em>Paragraphs 1 and 2 shall be without prejudice to Union or national law that</em>
<em>is applicable to the provision of specific services.</em></li>
<li><em>Member States shall make the information referred to in paragraph 2</em>
<em>publicly available online in electronically signed or sealed form suitable for</em>
<em>automated processing.</em></li>
<li><em>Relying parties registered in accordance with this Article shall inform</em>
<em>Member States without delay about any changes to the information provided</em>
<em>in the registration pursuant to paragraph 2.</em></li>
<li><em>Member States shall provide a common mechanism for allowing the</em>
<em>identification and authentication of relying parties, as referred to in Article</em>
<em>5a(5), point (c).</em>
<em>…</em></li>
<li><em>Intermediaries acting on behalf of relying parties shall be deemed to be</em>
<em>relying parties and shall not store data about the content of the transaction.</em></li>
<li><em>By ... [6 months from the date of entry into force of this amending</em>
<em>Regulation], the Commission shall establish technical specifications and</em>
<em>procedures for the requirements referred to in paragraphs 2, 5 and 6 to 9 of this</em>
<em>Article by means of implementing acts on the implementation of European</em>
<em>Digital Identity Wallets as referred to in Article 5a(23). Those implementing</em>
<em>acts shall be adopted in accordance with the examination procedure referred</em>
<em>to in Article 48(2).</em>
<em>...</em></li>
</ol>
<h3 id="22-draft-cir-on-relying-party-registration">2.2 Draft CIR on Relying Party registration</h3>
<p>The public consultation version of the [Draft of the CIR for RP-Registration] specifies the following requirements related to Relying Party registration:</p>
<ol>
<li>The roles:</li>
</ol>
<ul>
<li>wallet-relying party - a type of the relying party; includes: service providers, PID providers, attestation providers, trust service providers and intermediaries;</li>
<li>registrar</li>
</ul>
<ol>
<li>Setting up at each Member State one or more national registers of registered wallet-relying parties.</li>
<li>Make this information available to the public in a manner that is both human and machine-readable - via an API and website. The information made available shall be signed or sealed.</li>
<li>Member States should set out and publish one or more registration policies applicable to national registers set up in their territory</li>
<li>Wallet-relying parties should provide the necessary information (during registration process), including their entitlement(s), for inclusion in the national registers</li>
<li>Registrars should set up online and, where applicable, automated registration processes and shall verify registration information provided by the wallet-relying party in an automated manner where possible.</li>
<li>The registrant receives:</li>
</ol>
<ul>
<li>one or more ‘Wallet-Relying Party Access Certificates’, and</li>
<li>one or more 'Wallet-Relying Party Registration Certificates'</li>
</ul>
<ol start="7">
<li>Wallets authenticate wallet-relying parties with use of the Wallet-Relying Party Access Certificates.</li>
<li>In a transaction, a wallet solution shall inform the wallet user whenever the wallet-relying party is asking for more information than what they have registered as intended use and the user will have possibility to reject the transaction (as well as to make a claim or report the case to a competent authority).</li>
<li>The registrar may suspend or cancel the registration with or without prior notice to the affected wallet-relying party based on proportionality assessment, taking into account the impact on the fundamental rights, privacy, security and confidentiality of the users in the eco-system, as well as the severity of the disruption caused by the suspension or cancellation and the associated costs, both for the wallet-relying party and the user.</li>
</ol>
<p>The list of information to be provided by a wallet-relying party during registration (as per Annex I):</p>
<ul>
<li>official name of the wallet-relying party</li>
<li>one or more official identifiers of the wallet-relying party (EORI, LEI, VAT number...)</li>
<li>physical address and member state if not present in official identifier</li>
<li>URL belonging to the wallet-relying party where applicable</li>
<li>Detailed contact information</li>
<li>description of the type of services provided</li>
<li>a list of the attributes that the relying party intends to request</li>
<li>a description of intended use of the data</li>
<li>indication whether the wallet-relying party is a public sector body</li>
<li>applicable entitlement(s) of the wallet-relying party</li>
</ul>
<p>The list of possible entitlements (as per Annex I):</p>
<ul>
<li>Service_Provider</li>
<li>QEAA_Provider</li>
<li>Non_Q_EAA_Provider</li>
<li>PUB_EAA_Provider</li>
<li>PID_Provider</li>
<li>QCert_for_ESeal_Provider</li>
<li>QCert_for_ESig_Provider</li>
<li>rQSigCDs_Provider</li>
<li>rQSealCDs_Provider</li>
<li>ESig_ESeal_Creation_Provider</li>
<li>WAC_Provider</li>
</ul>
<p>Requirements for electronic signatures or seals applied to the information made available on registered wallet-relying parties (as per Annex II):</p>
<ul>
<li>shall be JSON advanced electronic signatures at conformance level B-B, B-T or B-LT, and comply with ETSI TS 119 182-1 (JAdES baseline signatures)</li>
</ul>
<p>Requirements on the API for the register (as per Annex II):</p>
<ul>
<li>be a REST API, supporting JSON as format with JAdES or ASIC signature format</li>
<li>allow any requestor, without prior authentication, to make (search/read) requests to the register, for information about a wallet-relying party</li>
<li>be published and documented using OpenAPI version 3 </li>
</ul>
<p>Requirements for wallet-relying party access certificates (as per Annex IV):</p>
<ul>
<li>issued under certificate policy and certificate practice statement compliant with IETF RFC 3647</li>
<li>certificate to include: a clear description of the public key infrastructure hierarchy and certification
paths from the end-entity wallet-relying party access certificates up to the top of the hierarchy used for issuing them, while indicating the expected trust anchor(s) in such hierarchy and paths; - a machine processable reference to the applicable certificate policy and certificate practice statement; and - the information referred to in Annex I, points 1, 2, 3, 5(b) and 5(d)</li>
</ul>
<p>Requirements for wallet-relying party registration certificates (as per ANNEX V):</p>
<ul>
<li>issued under certificate policy and certificate practice statement compliant with IETF RFC 3647 and
IETF RFC 5755</li>
<li>certificate to include: - the location where the certificate supporting the advanced
electronic signature or advanced electronic seal on that certificate is
available, for the entire certification path to be built up to the expected
trust anchor in the public key infrastructure hierarchy used by the
provider; - machine processable reference to the applicable certificate policy and certificate practice statement; - registration information referred to in Annex I (points 1, 2 and 8; and - to comply with IETF RFC 5755 to express attributes in relation to wallet-relying party registration certificates</li>
</ul>
<p>Below are selected excerpts from the public consultation [Draft of the CIR for RP-Registration], including the recitals and the Articles that establish these requirements.</p>
<p><strong>Recital (1)</strong></p>
<p><em>Member States should establish and maintain registers of registered wallet-relying parties established in their territory.</em></p>
<p><strong>Recital (4)</strong></p>
<p><em>In order to facilitate the consultation of the information on registered wallet-relying parties across the Union, Member States should make this information available to the public in a manner that is both human and machine-readable.</em></p>
<p><strong>Recital (6)</strong></p>
<p><em>As registration policies are a useful tool for providing clear guidance to the wallet-relying parties on the registration process, Member States should set out and publish the registration policies applicable to registers set up in their territory.</em></p>
<p><strong>Recital (7)</strong></p>
<p><em>[...] another objective of the relying party registration is to facilitate the verification by Member States of the lawfulness of the activities of the wallet-relying parties. Therefore, wallet-relying parties should provide, for inclusion in the registers the necessary information, including their entitlement(s).</em></p>
<p><strong>Recital (8)</strong></p>
<p><em>In order to ensure that the registration process is cost-effective and proportionate-to risk, and to strike an appropriate balance between meeting a high level of transparency and safety on the one hand and ensuring uptake by service providers on the other hand, registrars should set up online and, where applicable, automated registration processes for wallet-relying parties that are easy to use and they should verify applications for registration without undue delay.</em></p>
<p><strong>Recital (10)</strong></p>
<p><em>[...] wallet-relying parties should use wallet-relying party access certificates when they identify themselves to wallet units. To guarantee interoperability of those certificates across all wallets provided within the Union, wallet-relying parties access certificates should adhere to common requirements set-out in the Annex to this Regulation</em></p>
<p><strong>Recital (11)</strong></p>
<p><em>[...] wallet-relying parties are not to request users to provide any data other than those indicated for the intended use of wallets during the registration process. Wallet users should be enabled to verify the registration data of wallet-relying parties. To enable wallet users to verify that the attributes being requested by the wallet-relying party are within the scope of their registered attributes, Member States may require the issuance of wallet-relying party registration certificates to registered wallet-relying parties. To ensure the interoperability of the wallet-relying party registration certificates, Member States should ensure that those certificates meet the requirements and standards set out in the Annex of this Implementing Regulation.</em></p>
<p><strong>Recital (12)</strong>
<em>[...] registrars should be able to suspend or cancel the registration of any wallet-relying party without prior notice where the registrars have reason to believe that the registration contains information which is not accurate, not up to date or misleading, the wallet-relying party is not compliant with the registration policy or the wallet-relying party is otherwise acting in breach of Union or national law in a way that relates to their role as a wallet-relying party. In order to safeguard the stability of the wallet ecosystem, the decision to suspend or cancel a registration should be proportionate to the service disruption caused by the suspension or cancellation and the associated cost and inconvenience for the service provider and the user. For the same reason, supervisory bodies are to be enabled to suspend and cancel the registration required pursuant to Article 46a(4), point (f) of Regulation (EU) No 910/2014.</em></p>
<p><strong>Article 2</strong></p>
<p>Key definitions</p>
<p><em>‘wallet-relying party’ means a relying party that intends to rely upon wallet units for the provision of public or private services by means of digital interaction;</em></p>
<p><em>‘register of wallet-relying parties’ means an electronic register used by a Member State to make information on wallet-relying parties registered in that Member State publicly available as set out in Article 5b(5) of Regulation (EU) No 910/2014;</em></p>
<p><em>‘provider of wallet-relying party access certificates’ means a natural or legal person mandated by a Member State to issue wallet-relying party access certificates to wallet-relying parties registered in that Member State;</em></p>
<p><em>‘wallet-relying party access certificate’ means a certificate for electronic seals or signatures authenticating and validating the wallet-relying party issued by a provider of wallet-relying party access certificates;</em></p>
<p><em>‘registrar of wallet-relying parties’ means a body responsible for establishing and maintaining a list of registered wallet-relying parties established in their territory who has been designated by a Member State;</em></p>
<p><em>‘wallet-relying party registration certificate’ means a data object that indicates the attributes the relying party has registered to intend to request from users;</em></p>
<p><em>‘provider of wallet-relying party registration certificates’ means a natural or legal person mandated by a Member State to issue wallet-relying party registration certificates to wallet-relying parties registered in that Member State.</em></p>
<p><strong>Article 3</strong></p>
<p>National registers</p>
<p><em>2 Member States shall make the information set out in Annex I on registered wallet-relying parties from all national registers publicly available online, both in human readable form and in a form suitable for automated processing</em></p>
<p><em>3. The information shall be available through a single national application programming interface (‘API’) and through a national website. It shall be electronically signed or sealed by or on behalf of the registrar, in accordance with the requirements set out in Section 1 of Annex II.</em></p>
<p><strong>Article 4</strong></p>
<p>Registration policies</p>
<p><em>1. Member States shall lay down and publish one or more national registration policies applicable to national registers.</em></p>
<p><em>3. The registration policy shall cover at least the following points:</em></p>
<p><em>(a) the identification and authentication procedures applicable to wallet-relying parties during the registration process;</em></p>
<p><em>(b) the supporting documentation to be provided by the wallet-relying party to establish their identity, business registration, any applicable entitlement(s), and other relevant information that is required under the registration policy;</em></p>
<p><em>(c) where applicable, the description of the authentic sources or other official electronic records in the Member State where the register is set up, that can be relied upon to provide accurate data, information or other evidence required as part of the registration process;</em></p>
<p><em>(d) where applicable, the automated means supported to enable wallet-relying parties to register or to update an existing registration;</em></p>
<p><em>(e) the means of redress available to wallet-relying parties under the law of the Member State where the register is set up;</em></p>
<p><em>(f) the rules and procedures for the verification of the identity of the registered wallet-relying party and of any other relevant information provided by that party.</em></p>
<p><strong>Article 6</strong></p>
<p>The registration process</p>
<p><em>3. Registrars shall verify, where applicable, in an automated manner:</em></p>
<p><em>(a) the accuracy and validity of the information required under Article 5;</em></p>
<p><em>(b) where applicable, the power of attorney of a representative of the wallet-relying party in accordance with the laws and procedures of the Member State where the register is set up;</em></p>
<p><em>(c) the type of entitlement(s) of the wallet-relying party as set out in <strong>Annex I.</strong></em></p>
<p><em>4. The verification of the information referred to in paragraph 3 shall include an authenticity and validity assessment of the provided information against the supporting documentation provided by the wallet-relying parties and against any authentic sources or other official electronic records in the Member State where the register is set up and to which the registrars have access in accordance with national law. The verification of entitlements of wallet-relying parties shall be carried out in accordance with <strong>Annex III</strong>.</em></p>
<p><em>5. When a wallet-relying party no longer intends to rely upon wallet units for the provision of public or private services under a specific registration, it shall notify the relevant registrar without undue delay and request the cancellation of that registration.</em></p>
<p><strong>Article 7</strong></p>
<p>Wallet-relying party access certificates</p>
<p><em>1. Member States shall ensure that providers of wallet-relying party access certificates issue wallet-relying party access certificates to wallet-relying parties registered in accordance with the requirements set out in Article 4 to Article 6 of this Regulation.</em></p>
<p><em>2. Member States shall set up dedicated certificate policies and certificate practice statements in accordance with the requirements set out in Annex IV. Member States shall ensure that wallet-relying party access certificates meet the requirements set out in <strong>Annex IV</strong>.</em></p>
<p><strong>Article 8</strong></p>
<p>Wallet-relying party registration certificates</p>
<p><em>1. Member States may require providers of wallet-relying party registration certificates to issue wallet-relying party registration certificates to wallet-relying parties registered in accordance with the requirements set out in Article 4 to Article 6 of this Regulation.</em></p>
<p><em>2. Where Member States require the provision of wallet-relying party registration certificates, Member States shall ensure that these certificates meet the requirements set out in <strong>Annex V</strong>.</em></p>
<p><strong>Article 9</strong>
Suspension and cancellation</p>
<p><em>1. Registrars may suspend or cancel a registration of a wallet-relying party where such a suspension or cancellation is requested by a supervisory body pursuant to Article 46a(4), point (f) of Regulation (EU) No 910/2014 or where the registrars have reasons to believe that:</em>
<em>(a) the registration contains information which is not accurate, not up to date or misleading;</em>
<em>(b) the wallet-relying party is not compliant with the registration policy;</em>
<em>(c) the wallet-relying party is requesting more attributes than what they have registered in accordance with Article 5 and Article 6 of this Regulation;</em>
<em>(d) the wallet-relying party is otherwise acting in breach of Union or law of that Member State in a way that relates to their role as a wallet-relying party;</em></p>
<p><em>4. When considering the suspension or cancellation in accordance with Article 9 paragraph 2, the registrar shall conduct a proportionality assessment, taking into account the impact on the fundamental rights privacy, security and confidentiality of the users in the eco-system, as well as the severity of the disruption caused by the suspension or cancellation and the associated costs, both for the wallet-relying party and the user. Based on the result of this assessment, the registrar may suspend or cancel the registration with or without prior notice to the affected wallet-relying party.</em></p>
<p><strong>ANNEX I</strong></p>
<p>(summary)</p>
<p>Information regarding wallet-relying parties</p>
<ul>
<li>name of the wallet-relying party as stated in official record</li>
<li>one or more identifiers of the wallet-relying party (EORI, LEI, VAT number...)</li>
<li>physical address</li>
<li>Detailed contact information</li>
<li>a description of the type of services provided</li>
<li>a list of the attributes, that the relying party intends to request</li>
<li>description of intended use of the attributes</li>
<li>indication whether the wallet-relying party is a public sector body</li>
<li>applicable entitlement(s) of the wallet-relying party</li>
</ul>
<p>The possible entitlements of the wallet-relying party:</p>
<ul>
<li>Service_Provider</li>
<li>QEAA_Provider</li>
<li>Non_Q_EAA_Provider</li>
<li>PUB_EAA_Provider</li>
<li>PID_Provider</li>
<li>QCert_for_ESeal_Provider</li>
<li>QCert_for_ESig_Provider</li>
<li>rQSigCDs_Provider</li>
<li>rQSealCDs_Provider</li>
<li>ESig_ESeal_Creation_Provider</li>
<li>WAC_Provider</li>
</ul>
<p><em>5. Detailed contact information of the wallet-relying party, one or more, including:</em>
<em>(a) a website for providing helpdesk and support;</em>
<em>(b) a phone number where the wallet-relying party can be contacted for matters pertaining to its registration and intended use of the wallet units;</em>
<em>(c) a digital address where the wallet-relying party can be contacted for matters pertaining to its registration and intended use of the wallet units;</em>
<em>(d) an e-mail address where the wallet-relying party can be contacted for matters pertaining to its registration and intended use of the wallet units;</em></p>
<p><em>7. A list of the attributes that the relying party intends to request, expressed as a friendly name and a technical name including the namespace that the attributes are grouped under in a machine-readable format for automated processing, with an indication if they are mandatory or optional.</em></p>
<p><strong>ANNEX II</strong></p>
<p>(summary)</p>
<p><em>1. REQUIREMENTS ON ELECTRONIC SIGNATURES OR SEALS APPLIED TO THE INFORMATION MADE AVAILABLE ON REGISTERED WALLET-RELYING PARTIES</em></p>
<ul>
<li>The file format used by the API: be JavaScript Object Notation (JSON)</li>
<li>electronic signatures and electronic seals - JSON advanced electronic signatures at conformance level B-B, B-T or B-LT, comply with ETSI TS 119 182-1 V1.2.1 (JAdES baseline signatures)</li>
</ul>
<p><em>2. REQUIREMENTS ON THE SINGLE API</em></p>
<ul>
<li>REST API, supporting JSON data format</li>
<li>published as OpenAPI version 3</li>
<li>allow any requestor, without prior authentication, to make (search/read) requests to the register</li>
<li>provide security functions in order to ensure the availability and integrity of the API and the information available through it. The API shall be secure by default and by design.</li>
</ul>
<p><strong>ANNEX III</strong></p>
<p>(summary)</p>
<p><em>Source of documentary evidence for the verification of entitlements of wallet-relying parties</em></p>
<ul>
<li>verification of qualified trust service providers - shall be based on the national trusted lists</li>
<li>verification of non-qualified trust service providers - shall be based on the national trusted lists or on national MS verification procedures (set out in their registration policies)</li>
<li>verification of providers of person identification data - shall be based on the list of providers of person identification data published by the Commission in accordance with Article 5a(18) of Regulation (EU) No 910/2014</li>
<li>verification of providers of electronic attestations of attributes issued by or on behalf of a public sector body responsible for an authentic source - shall be based on the list published by the Commission in accordance with Article 45f(3) of Regulation (EU) No 910/2014</li>
</ul>
<p><strong>ANNEX IV</strong></p>
<p>(summary)</p>
<p><em>Requirements for wallet-relying party access certificates</em></p>
<ul>
<li>X.509 certificate with certificate policy and certificate practice statement</li>
<li>shall comply with IETF RFC 3647</li>
<li>plus additional requirements set out in the Annex IV</li>
</ul>
<p><strong>ANNEX V</strong></p>
<p>(summary)</p>
<p><em>Requirements for wallet-relying party registration certificates</em></p>
<ul>
<li>certificate policy and certificate practice statement shall comply with IETF RFC 3647 and IETF RFC 5755</li>
<li>includes the information referred to in Annex I, points 1, 2 and 8;</li>
<li>expresses attributes in way compliant with IETF RFC 5755;</li>
<li>plus additional requirements set out in the Annex V.</li>
</ul>
<h2 id="3-discussion">3 Discussion</h2>
<p>The Relying Party registration covers from functional perspective of the ARF and the European Digital Identity ecosystem the following aspects: </p>
<p>1) the <strong>Registrar function</strong> for which the Member States are responsible to organise this function, register and a publicly accessible API at a national level (based on the future technical specifications and the CIR provided by the European Commission),
2) the registration process mandated to be be followed by all Relying Parties resulting in issuance of one or more <strong>Wallet-Relying Party Access Certificates</strong> (RPAC) and as many <strong>Wallet-Relying Party Registration Certificates</strong> (RPRC) as the Relying Party has dedicated intended uses (use cases, services provided to the EUDI Wallet Users),
3) the <strong>operational use of aforementioned certificates</strong> in Relying Party transactions with the EUDI Wallet Units and their Users,
4) <strong>handling the functional revocation of Relying Party certificates</strong> as necessitated by the legal requirements, 
5) how the registration and operational use of the RP registration certificates shall be done when <strong>the Relying Party relies upon another Relying Party that is acting on its behalf (an intermediary)</strong> to provide its intended use towards the Wallet Units.</p>
<p>Having analysed the combined legal requirements, the current ARF (release 1.8), as well as recent German architecture concept proposals ([German non-paper on RP Authn], [German non-paper on WRP with attestations], that together contain considerable amount of technical detail and that were discussed indirectly in the context of topic D already), this section raises the following topics for discussion at level of High-Level Requirements relevant for the ARF:</p>
<ul>
<li>Requirements needed to support registrar issuance of RP registration certificates for proximity use cases, not just remote (specifically, support of both JWT and CWT formats of the RP registration certificates, support of both JOSE and COSE signature)</li>
<li>Requirements impacted from the fact that the Relying Party has an access certificate per Relying Party Instance (either in remote or proximity scenarios)</li>
<li>Requirements impacted from the fact that registration certificates are issued per each registered intended use of the Relying Party</li>
<li>Changes needed in the ARF due to earlier assumption that PID or Attestation Providers did not need a Relying Party registration certificate</li>
<li>Identified HLR changes due to clarification of the role of intermediaries (adaptation of the certificate usage to the role  of intermediaries and the related processes, e.g. registration process and RP registration certificate content if issued to an intermediary, and binding association between the access certificate of the intermediary and the registration certificates of its End-Relying Parties)  </li>
<li>Modification related to distinguishing between lifecycle of the RP registration and the lifecycle of RPRC itself, as well as the relation between them (e.g. adapt the HLRs to the fact that certificates can only be revoked (no suspension), while the registration can be cancelled or suspended)  </li>
<li>Other terminology mismatches that need alignment between the draft IA and the ARF (eg. registration 'withdrawal' to be replaced with 'cancellation').</li>
<li>Necessary adaptation of registration policy, certification policy and certification policy statement requirements in line with conclusions on the above issues</li>
<li>Impacts on the HLRs under other Topics of ARF Annex 2 (Topic 6 &amp; Topic 31, at least)</li>
</ul>
<p>This document is ONLY intended to clarify the high-level requirements related to the Relying Party registration topic. The necessary technical specifications (including any policy documents) will be developed by the European Commission after agreement over the requirements has been reached.</p>
<h3 id="31-proximity-use-case-support">3.1 Proximity use case support</h3>
<p>The Annex IV and V of the [Draft CIR on Relying Party registration] will bind legally what certificate standards are applicable for the RPAC and RPRC to be issued by the registrar. Use of the RPRC in context of proximity use case is mentioned in the ARF indirectly in (6.6.3.5), but necessary technical requirements for RPRC issuance are pointing at use of JOSE for signing/sealing the certificate, and the data format of the certificate contents being JSON (Annex V of the draft CIR). Requirement for the Registrar to support provisioning of registration certificates in both JWT and CWT format was agreed to be added to the requirements.</p>
<p>A new HLR is proposed to extend the scope of registration to apply over both online and proximity use cases:</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_30</td>
<td>During registration, the Relying Party SHALL be provided both JWT and CWT format registration certificates by the Registrar. <em>Note: This gives the Relying Party freedom to provide their intended use for both remote and proximity use cases, as necessary - without requesting use case implementation approach upon the registration event.</em></td>
<td>New</td>
</tr>
</tbody>
</table>
<h3 id="32-access-certificates-with-multiple-relying-party-instances">3.2 Access certificates with multiple Relying Party instances</h3>
<p>When addressing the RPACs, the Regulation does not recognise the need for multiple instances of Relying Party services in modern IT architectures (replication of RP servers and common dependance on multiple geographical cloud provider regions to ensure availability and continuity of RP services). Multi-instance Relying Parties will also be commonplace in proximity use cases with handheld or mounted verification devices interacting with the Wallet Units. The fact that multiple access certificates with individual private keys can be requested and issued by the Access Certificate Authorities should be clarified in the ARF requirements on registering access certificates, and in the policy documents to be created based on the ARF high-level requirements.</p>
<p>The HLR Reg_15 on policy for revocation is revised to mention multiple RPACs (<em>all</em> RPACS of a Relying Party), and a new HLR Reg_15b is brought to clarify the need for controlled revocation of individual instance RPACs (when the Relying Party still has at least one or more valid RPACs after revoking one or more RPACs assigned to its Relying Party Instances). Related to the existing HLRs on relying party access certificates Reg_31 and Reg_32, the requirements with their contextual notes should be moved under Topic 44 with rewording to mean RPRCs. To ensure binding of the RPAC and RPRC with the unique identifier of the Relying Party, a new HLR Reg_33 is introduced.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_15</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL include a policy for revocation, which SHALL require that an Access Certificate Authority revokes all access certificates of the certificate subject at least when: - the certificate subject which is a Relying Party is cancelled or suspended by the respective Registrar,  - on request of the certificate subject, or - on request of a national supervisory body.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>Reg_15b</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL include a policy for Relying Party Instance-specific revocation, which SHALL require that an Access Certificate Authority revokes one or more of the access certificates of the certificate subject at least when: - the corresponding Relying Party Instance is cancelled by the respective Registrar, - on request of the certificate subject. or - on request of a a national supervisory body. <em>Note: This policy is required for needs of executing partial revocation of access certificates, e.g. for situations when a Relying Party has issues not reaching to all of its instances.</em></td>
<td>New</td>
</tr>
<tr>
<td>Reg_31</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains a name for the Relying Party, in a format suitable for presenting to a User. <em>Note: A Wallet Unit needs such a name when requesting User approval according to [Topic 6].</em></td>
<td>Move modified HLR text under Topic 44 (new RPRC_03a)</td>
</tr>
<tr>
<td> Reg_32</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains an EU-wide unique identifier for the Relying Party, and SHALL specify a method for deriving such identifiers. <em>Note: - The Wallet Instance needs such an identifier at least to lodge a complaint of suspicious Relying Party presentation requests to a data protection authority according to Topic 50. - The EU-wide unique identifier could, for example, be a concatenated list of one or more registered official wallet-relying party identifiers listed in Annex I(3) of the [Draft of the CIR for RP-Registration], expressed in semantic form defined in [ETSI EN319 412-1] Sections 5.1.4 or 5.1.5 and used as the Distinquished Name (DN) of the Certificate subject in both access and registration certificates of the Relying Party</em></td>
<td>Move modified HLR text under Topic 44 (new RPRC_03b). <em>Note: Identicality is covered in new HLR RPRC_09 - see Section 3.3</em></td>
</tr>
<tr>
<td>Reg_33</td>
<td>All Relying Party Instance access certificates of a Relying Party SHALL include the user-friendly (common) name of Relying Party service and unique identifier identical to the ones defined in requirements RPRC_03a and RPRC_03b, respectively.</td>
<td>New</td>
</tr>
</tbody>
</table>
<h3 id="33-registration-certificate-per-intended-use">3.3 Registration certificate per intended use</h3>
<p>The Relying Party registration requires Relying Parties to provide information necessary for authentication, their contact details, and the intended use of the European Digital Identity Wallets, including the specific data they will request from users. The RPAC (wallet Relying Party Access Certificate) authenticates who the Relying Party is, while the RPRC (wallet-Relying Party Registration Certificate) specifies what data that authenticated the Relying Party is entitled to request for a particular registered purpose (intended use). Crucially, Relying Parties are explicitly prohibited from requesting any data beyond what is indicated in their registration. This is a key mechanism for enforcing data minimisation and purpose limitation.</p>
<p>According to the [Draft CIR on Relying Party registration] a Relying Party will get issued a unique RPRC for each of its registered intended uses, and these registration certificates may be revoked independent of each other or of the associated RPAC. The access certificates are the Relying Party's 'master switches' to the EUDI ecosystem, whilst registration certificates are used to register and document the use case/s provided to the Wallet User. The registration certificate will not be a X.509 certificate, and thus the required certificate policies for RPRCs should be clarified both in the IA draft and the ARF. </p>
<p>Current RPRC_2 and RPC_3 in the ARF should be updated to reflect the text of the draft CIR on RPR, a new requirement on use of unique RP identifier across the RPRCs, and a new HLR on creating applicable certificate policies is suggested for Topic 44 as follows:</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPRC_01</td>
<td>During the registration process for Relying Parties, as specified in <a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>, the Member State Registrar SHALL create and sign or seal a registration certificate and issue it to the Relying Party for each intended use requested to be registered by the Relying Party. The registration certificate SHALL comply with the applicable requirements in the technical specification mentioned in RPRC_02. Note: See <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPRC_02</td>
<td>The Commission SHALL ensure that a technical specification is created, describing at least 1. the contents and format of registration certificates, 2. the signing method(s) used to ensure the authenticity of the registration certificates. 3. the trust infrastructure necessary for signing registration certificates and for verifying these signatures, including, if necessary, the use of Trusted Lists to establish trust in Member States Registrars and to distribute their trust anchors to Wallet Units. 4. the method used for binding each registration certificate to the Relying Party Instance access certificate that will be used during the same transaction. This binding method SHALL enable a Wallet Unit to verify that the registration certificate was in fact issued to the Relying Party that authenticated itself using the access certificate. The binding method SHALL consider situations in which the Relying Party uses the services of an intermediary (see <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>) to connect to the Wallet Unit. 5. whether or not a registration certificate must have a validity period. 6. the method to be used for revocation of registration certificates. Moreover, the technical specification SHALL describe the impact of revocation, especially compared to the impact of revocation of the Relying Party Instance access certificates.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPRC_03</td>
<td>The contents of a registration certificate issued per registered intended use of the Relying Party SHALL include at least information required in Annex V of the CIR for Relying Party Registration. If the Relying Party uses the services of an intermediary (see <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>): the fact that this is the case, plus the user-friendly (common) name and unique identifier (as meant in RPRC_03a and RPRC_03b) of this intermediary.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPRC_09</td>
<td>The EU-wide unique identifier SHALL be identical in all registration certificates issued for a given Relying Party.</td>
<td>New</td>
</tr>
<tr>
<td>RPRC_10</td>
<td>The Commission SHALL provide technical specifications establishing common Certificate Policy for registration certificates, covering at least management and selection of signing keys, revocation and lifecycle maganagement of RPRCs on individual intended use level. <em>Note: The TS could set the provider of RPRCs to follow applicable parts of technical standards such as EN 319 401 (for General Policy Requirements for TSPs) and TS 119 461 (for identity proofing of Relying Party representatives).</em></td>
<td>New</td>
</tr>
<tr>
<td>RPRC_11</td>
<td>There SHALL be only one valid registration certificate present in a presentation request for given intended use of a Relying Party. An error SHALL be reported by the Wallet Unit if it receives multiple registration certificates for the same intended use.</td>
<td>New</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: The modifications suggested for RPRC_01 and RPRC_03 above include also the changes required from discussion on intermediaries at Section 3.5.</p>
</blockquote>
<h3 id="34-addressing-the-pid-providers-and-attestation-providers-on-rprcs">3.4 Addressing the PID Providers and Attestation Providers on RPRCs</h3>
<p>The [Draft of the CIR for RP-Registration] implies that among all other roles defined in the ARF also the PID Providers and Attestation Providers will receive registration certificates, with the role registered as part of the registration and reflected in the certificate information (the specific entitlement being one or more of the set PID_Provider, QEAA_Provider, Non_Q_EAA_Provider or PUB_EAA_Provider). This needs to be reflected in the ARF, which so far has separated these roles from the Relying Parties (per definition of the ARF).</p>
<p>Section 6.3.2.2 of the ARF says that "<em>A PID Provider access certificate indicates that its subject is a PID Provider. Similarly, an Attestation Provider access certificate indicates that its subject is a QEAA Provider, a PuB-EAA Provider or a non-qualified EAA Provider.</em>"</p>
<p>This is not the case per the draft CIR, the entitlements indicating the registered role are only present in the Relying Party registration certificate.</p>
<p>Therefore, the definition set in the ARF needs to be adapted or extended accordingly, and Reg_17 on list of HLRs for the issuance of access certificates should be removed (entitlements not being present in access certificates):</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_17</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that an access certificate indicates whether its subject is a PID Provider, a QEAA Provider, a PuB-EAA Provider, a (non-qualified) EAA Provider, or a Relying Party Instance.</td>
<td>Delete</td>
</tr>
</tbody>
</table>
<h3 id="35-registration-certificate-for-intermediaries">3.5 Registration certificate for intermediaries</h3>
<h4 id="351-registration-on-behalf-of-the-end-relying-parties">3.5.1 Registration on-behalf of the End-Relying Parties</h4>
<p>The intention reflected in the [Draft of the CIR for RP-Registration] is that the intermediaries are to receive the RPRC of their End-Relying Parties. If an End-Relying Party uses an intermediary, it (the End-RP) will not need to itself apply or receive its Wallet-Relying Party certificate from the Registrar, if the intermediary (as part of their service towards the End-Relying Parties) registers for it and possesses the RPRCs for all of its customers. This will simplify the process of End-Relying Parties, who can This model is not mandated by the ARF, the processes how registration will be organised in Member States is left for national discretion.</p>
<blockquote>
<p>Note: The means to indicate to the national registry/ies that an entity is registering as an Intermediary is left for national discretion (see RPI_04), there is no such role/entitlement recognised in the Regulation.</p>
</blockquote>
<p>A pure intermediary will upon its registration receive only RPACs listing its own unique Relying Party identifier and (common) name. The intermediated End-Relying Parties are not provided RPACs, and their set of issued RPRCs are hosted by their intermediary. It is not in the scope of the ARF to cover how the intended use specific RPRCs are to be managed between the End-Relying Party and the Intermediary.</p>
<p>As the intermediaries are acting on behalf of the End-Relying Parties, and will remain liable towards the Registrar on accuracy of the information to be registered, they must carry same identity proofing and data verification checks for their customers as the Registrar would do for the End-Relying Party in case of direct registration path. The Registrar shall also not trust blindly the Intermediary but execute the identity verification of both the Intermediary and the End-Relying Parties to be registered.</p>
<blockquote>
<p>Note: Attention must be paid towards compliance of principles such as lawfulness, fairness, transparency, storage limitation or accountability, and of requirements such as those related to data subject rights when using an Intermediary. The compliance against requirements of RPI_10 are therefore essential to be audited when defining the national registration and security policies for Intermediaries. There is no such intention from the Commission, as this (no EU-level policy setting) is already the case for the proxying TSPs since enforcement of (EU) 2014/910.</p>
</blockquote>
<h4 id="352-use-of-certificates-upon-on-behalf-operation-towards-wallet-units">3.5.2 Use of certificates upon on-behalf operation towards Wallet Units</h4>
<p>When operating on behalf of its End-Relying Parties, the intermediary will possess as many RPRCs as number of its intermediated End-RPs entities (multiplied by the number of services/intended uses for each entity possibly). The ARF describes already how the certificates are to be used by the Intermediary and the Wallet Unit in RPI_06 to RPI_10. For clarity, the process of presenting the Intermediary RPAC and the End-Relying Party RPRC with necessary technical level binding is illustrated in Figure 1 below.</p>
<p><img alt="Intermediary-certificate-presentation-to-wu" src="../img/intermediary-certificate-presentation-to-wu.png" /></p>
<p>Figure 1 - Validation of identifiers between Intermediary RPAC and End-Relying Party RPRC.</p>
<p>The ARF (1.8) contains requirement RPI_02, assuming the intermediary does not receive registration certificates of its own, and this assumption remains valid unless the Relying Party acting as an intermediary has other wallet-relying party services with intended uses that invoke the duty to register an RPRC. </p>
<p>As summary, the ARF needs to be adapted to the intended role of the intermediaries as per the [Draft of the CIR for RP-Registration], which implies modifications of multiple HLRs. Below are the proposed changes to the key HRLs in this respect (other HLRs might need to be updated accordingly). </p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPI_02</td>
<td>An intermediary is acting only as an intermediary for other (End-) Relying Parties, but from the Registrar point of view is considered as a Relying Party and obtains a registration certificate according to <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>, containing Intermediary name and Relying Party identifier.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPI_03</td>
<td>For each of the End-Relying Parties that uses its services, an intermediary SHALL possess a registration certificate for each registered intended use of the said End-Relying Party, according to the requirements in <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>. This registration certificate SHALL contain that End-Relying Party's name and unique identifier, as well as the list of attributes registered for that Relying Party's intended use.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPI_05</td>
<td>When issuing a registration certificate for an intermediary, the Registrar SHALL include in the registration certificate the attributes meant in RPRC_03a and RPRC_03b containing the name and unique identifier of the intermediated End-Relying Party.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPI_06</td>
<td>When requested for an intended use by an intermediated End-Relying Party, an intermediary SHALL request the presentation of attributes from a specific Wallet Unit, using the intermediary's access certificate meant in requirement RPI_01, and the registration certificate possessed by the intermediary in relation to the intermediated End-Relying Party and the intended use, as meant in RPI_03.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPRC_01</td>
<td>During the registration process for Relying Parties, as specified in <a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>, the Member State Registrar SHALL create and sign or seal a registration certificate and issue it to the Relying Party for each intended use requested to be registered by the Relying Party. The registration certificate SHALL comply with the applicable requirements in the technical specification mentioned in RPRC_02. <em>Note: See Topic 52.</em></td>
<td>Keep with proposed changes</td>
</tr>
</tbody>
</table>
<h3 id="36-registration-and-registration-certificate-life-cycles">3.6 Registration and Registration Certificate life cycles</h3>
<p>The Article 9 of [Draft of the CIR for RP-Registration]  envisions 'suspension' and 'cancellation' of the registration (apart from the non-specified "active" state after the registration). 
At the same time the RP registration certificate has its own life cycle, which envisions only 'revocation' (apart from the "valid" state after issuance).</p>
<p>In addition, the IA draft text lists the following reasons of suspension/cancellation:
+ the registration contains information which is inaccurate, out of date or misleading;
+ the wallet-relying party is not complying with the registration policy;
+ the wallet-relying party is requesting more attributes than they have registered; 
+ the wallet-relying party is otherwise acting in breach of Union or national law in a manner related to their role as wallet-relying party;
+ by a supervisory body European Digital Identity Wallet Framework in the case of illegal or fraudulent use of the European Digital Identity Wallet.</p>
<p>The technical specifications and policy documents that base their requirements on the ARF must specify the RPRC specific policies on lifecycle management (e.g., updates for and revocation of the existing RPRCs as indended uses and their data requirements change over time) and policies for eventual multi-registration (per intended use, per Member State) and cross-border registration. </p>
<p>Defined policies should also address how to execute post-registration analysis and audits against the registered intended uses, unless the audits are to be left entirely for the EUDI Wallet Unit level functions - such as already introduced in the ARF <a href="https://github.com/eu-digital-identity-wallet/eudi-doc-architecture-and-reference-framework/blob/main/docs/architecture-and-reference-framework-main.md#66313-wallet-unit-enables-the-user-to-report-suspicious-requests-by-a-relying-party-and-to-request-a-relying-party-to-erase-personal-data">Section 6.6.3.13</a>, and the functionalities to be defined via Topic M - User reporting unlawful or suspicious request of data to DPAs.</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_15</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL include a policy for revocation, which SHALL require that an Access Certificate Authority revokes an access certificate at least when: the certificate subject's registration is cancelled by the respective Registrar, on request of the certificate subject, or on request of a national supervisory body.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>Reg_22a</td>
<td>A Registrar SHALL provide a method to suspend or cancel the registration of a registered Attestation Provider.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>Reg_22b</td>
<td>A Registrar SHALL have a policy for the suspension or cancellation of a registered Attestation Provider, which SHALL specify that an Attestation Provider's registration is suspended or cancelled at least on request of the PID Provider,Registrar or of a national supervisory body.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>REG_28</td>
<td>A Member State's Registry SHALL log all changes made on the information regarding a Relying Party, including at least initial registration, updates, deletion of information, and suspension or cancellation.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>REG_29</td>
<td>A Registrar SHALL have a policy for the cancellation and suspension of the registration of a registered Relying Party, which SHALL specify that the Relying Party's registration is cancelled or suspended at least on request of the Relying Party, Registrar or a national supervisory body.</td>
<td>Keep with proposed changes</td>
</tr>
</tbody>
</table>
<h2 id="4-current-hlrs-and-proposals-of-changes">4 Current HLRs and Proposals of Changes</h2>
<p>The ARF, Annex 2, Topic 27, Topic 44 and Topic 52, contains a number of High-Level Requirements related to the topic.</p>
<p>The Topic 27 requirements cover general requirements for Member State registration processes and specific requirements for the registration of Relying Parties, whereas Topic 44 covers issuance of Relying Party registration certificates. Topic 52 focuses on the intermediaries.</p>
<p>The existing HLRs are listed in the tables below, along with a proposal to keep, change, add, or remove the HLR.</p>
<h3 id="41-topic-27-registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">4.1 Topic 27 - Registration of PID Providers, Providers of QEAAs, PuB-EAAs, and (non-qualified) EAAs, and Relying Parties</h3>
<p>A.  General requirements for Member State registration processes</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_01</td>
<td>Member States SHALL provide processes and mechanisms for PID Providers, QEAA Providers, PuB-EAA Providers, (non-qualified) EAA Providers, and other Relying Parties to register in a registry. <em>Note: Member States may choose to implement a single registry for all these roles, or a separate registry for each of these roles, or organise registries e.g. per applicable sector.</em></td>
<td>Keep with proposed change</td>
</tr>
<tr>
<td>Reg_02</td>
<td>Member States SHALL make publicly available all necessary details and documentation about the registration processes for their registry.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_03</td>
<td>Member States SHALL publish the registry entries online, in a sealed or signed machine-readable common format suitable for automated processing, according to the [European Digital Identity Regulation] Article 5b 5, for the purpose of transparency to Users and other stakeholders.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_04</td>
<td>Member States SHALL make the registry available online, in a common human-readable format.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_05</td>
<td>The Commission SHALL establish a technical specification for the common formats mentioned in Reg_03 and Reg_04.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_06</td>
<td>The Commission SHALL provide specifications for a common API for retrieving registry entries from the Member States registries per Reg_03, defining the minimum requirements for interoperability. <em>Note: Requirements for this API are defined in Reg_08 and Reg_09.</em></td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_07</td>
<td>The Commission SHALL provide specifications for a common user interface for accessing the Member State registries per Reg_04. <em>Note: Requirements for this user interface are defined in Reg_08 and Reg_09.</em></td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_08</td>
<td>The API mentioned in Reg_06 and the user interface mentioned in Reg_07 SHALL use a secure channel protecting the authenticity and integrity of the information in the registry during transport.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_09</td>
<td>The API mentioned in Reg_06 and the user interface mentioned in Reg_07 SHALL NOT require authentication or prior registration and authorisation of any entity wishing to retrieve the information in the registry.</td>
<td>Keep</td>
</tr>
</tbody>
</table>
<p>B. <em>General requirements for the issuance of access certificates</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_10</td>
<td>A Member State SHALL ensure that an Access Certificate Authority notified according to [<a href="#a2331-topic-31---pid-provider-wallet-provider-attestation-provider-and-access-certificate-authority-notification-and-publication">Topic 31</a>] issues access certificates on request to Relying Parties, including the PID Providers, QEAA Providers, PuB-EAA Providers and (non-qualified) EAA Providers registered in one of the Member State's registries.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>Reg_11</td>
<td>A Member State SHALL ensure that the issuance process of access certificates by their notified Access Certificate Authority(s) complies with a common Certificate Policy for Access Certificate Authority.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_12</td>
<td>The Commission SHALL provide technical specifications establishing the common Access Certificate Authority Certificate Policy mentioned in Reg_11.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_13</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that an Access Certificate Authority logs all issued certificates for Certificate Transparency (CT). <em>Note: This requirement is still under discussion and might be changed or removed in a future version of this ARF.</em></td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_14</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that an Access Certificate Authority provides one or more method(s) to revoke the access certificates it issued.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_15</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL include a policy for revocation, which SHALL require that an Access Certificate Authority revokes all access certificates of the certificate subject at least when: - the certificate subject which is a Relying Party is cancelled by the respective Registrar,  - on request of the certificate subject, or - on request of a national supervisory body.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>Reg_15b</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL include a policy for Relying Party Instance-specific revocation, which SHALL require that an Access Certificate Authority revokes one or more of the access certificates of the certificate subject at least when: - the corresponding Relying Party Instance is cancelled by the respective Registrar, - on request of the certificate subject, or - on request of a national supervisory body. <em>Note: This policy is required for needs of executing partial revocation of access certificates, e.g. for situations when a Relying Party has issues not reaching to all of its instances.</em></td>
<td>New</td>
</tr>
<tr>
<td>Reg_16</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL specify the profile of access certificates in detail.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_17</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL require that an access certificate indicates whether its subject is a PID Provider, a QEAA Provider, a PuB-EAA Provider, a (non-qualified) EAA Provider, or a Relying Party Instance.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_18</td>
<td>The common Certificate Policy mentioned in Reg_12 SHALL define the minimum change history information to be stored for resolving possible disputes regarding registration.</td>
<td>Keep</td>
</tr>
</tbody>
</table>
<p>C. <em>Requirements for the registration of PID Providers</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_19</td>
<td>A Member State SHALL approve a PID Provider according to a well-defined policy before including it in its PID Provider Registry. To that end, a Member State SHALL define specific vetting processes and rules of acceptance for inclusion of PID Providers in its Registry.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_20</td>
<td>A Member State SHALL identify PID Providers at a level of confidence proportionate to the risk arising from the potential harm a fraudulent PID Provider could cause to Users and other stakeholders in the EUDI Wallet ecosystem.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_20a</td>
<td>A Registrar SHALL provide a method to suspend or cancel a registered PID Provider.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_20b</td>
<td>A Registrar SHALL have a policy for the suspension or cancellation of a registered PID Provider, which SHALL specify that a PID Provider is suspended or cancelled at least on request of the PID Provider or of a national supervisory body.</td>
<td>Delete</td>
</tr>
</tbody>
</table>
<p>D. <em>Requirements for the registration of Attestation Providers</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_21</td>
<td>A Member State SHALL approve an Attestation Provider according to a well-defined policy before including it in its Attestation Provider Registry. To that end, a Member State SHALL define specific vetting processes and rules of acceptance for inclusion of Attestation Providers in its Registry. These processes and rules SHOULD consider any relevant differences between QEAA Providers, PuB-EAA Providers and (non-qualified) EAA Providers.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_22</td>
<td>A Member State SHALL identify Attestation Providers (i.e., QEAA Providers, PuB-EAA Providers and non-qualified EAA Providers) at a level of confidence proportionate to the risk arising from the potential harm a fraudulent Attestation Provider could cause to Users and other stakeholders in the EUDI Wallet ecosystem.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_22a</td>
<td>A Registrar SHALL provide a method to suspend or cancel a registered Attestation Provider.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_22b</td>
<td>A Registrar SHALL have a policy for the suspension or cancellation of a registered Attestation Provider, which SHALL specify that an Attestation Provider is suspended or cancelled at least on request of the PID Provider or of a national supervisory body.</td>
<td>Delete</td>
</tr>
</tbody>
</table>
<p>E. Requirements for the registration of Relying Parties</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_23</td>
<td>The Commission SHALL establish a technical specification for a common set of Relying Party information to be registered in Member State registries. This set SHALL include at least the information defined in [European Digital Identity Regulation] article 5b 2 (c).</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_24</td>
<td>A Member State SHALL enable a Relying Party to register remotely, using an API or user interface.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_25</td>
<td>A Member State SHALL identify a Relying Party at a level of confidence proportionate to the risk arising from the potential harm a fraudulent Relying Party could cause to Users and other stakeholders in the EUDI Wallet ecosystem.</td>
<td>Delete</td>
</tr>
<tr>
<td>Reg_26</td>
<td>A Member State SHALL enable a Relying Party to update the information registered on it using a process comparable to the original registration process, and using the API or user interface mentioned in Reg_24.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_27</td>
<td>Relying Parties SHALL make any updates necessary to ensure the continued correctness of the registered information without undue delay.</td>
<td>Keep</td>
</tr>
<tr>
<td>Reg_28</td>
<td>A Member State's Registry SHALL log all changes made on the information regarding a Relying Party, including at least initial registration, updates, deletion of information, and suspension or cancellation.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>Reg_29</td>
<td>A Registrar SHALL have a policy for the cancellation of a registered Relying Party, which SHALL specify that a Relying Party is cancelled at least on request of the Relying Party or of a national supervisory body.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>Reg_30</td>
<td>During registration, the Relying Party SHALL be provided both JWT and CWT format registration certificates by the Registrar. <em>Note: This gives the Relying Party freedom to provide their intended use for both remote and proximity use cases, as necessary - without requesting use case implementation approach upon the registration event.</em></td>
<td>New</td>
</tr>
</tbody>
</table>
<p>F.  <em>Requirements for the issuance of Relying Party Instance access certificates</em></p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Reg_31</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains a name for the Relying Party, in a format suitable for presenting to a User. <em>Note: A Wallet Unit needs such a name when requesting User approval according to [Topic 6].</em></td>
<td>Move modified HLR text under Topic 44 (<strong>new RPRC_03a</strong>)</td>
</tr>
<tr>
<td> Reg_32</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains an EU-wide unique identifier for the Relying Party, and SHALL specify a method for deriving such identifiers. <em>Note: - The Wallet Instance needs such an identifier at least to lodge a complaint of suspicious Relying Party presentation requests to a data protection authority according to Topic 50. - The EU-wide unique identifier could, for example, be a concatenated list of one or more registered official wallet-relying party identifiers listed in Annex I(3) of the [Draft of the CIR for RP-Registration], expressed in semantic form defined in [ETSI EN319 412-1] Sections 5.1.4 or 5.1.5 and used as the Distinquished Name (DN) of the Certificate subject in both access and registration certificates of the Relying Party</em></td>
<td>Move modified HLR text under Topic 44 (<strong>new RPRC_03b</strong>).</td>
</tr>
<tr>
<td>Reg_33</td>
<td>All Relying Party Instance access certificates of a Relying Party SHALL include the user-friendly (common) name of Relying Party service and unique identifier identical to the ones defined in requirements RPRC_03a and RPRC_03b, respectively.</td>
<td>New</td>
</tr>
</tbody>
</table>
<h3 id="42-topic-44-relying-party-registration-certificates">4.2 Topic 44 - Relying Party Registration Certificates</h3>
<p>A. Issuance of Relying Party registration certificates</p>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPRC_01</td>
<td>During the registration process for Relying Parties, as specified in Topic 27, the Member State Registrar SHALL create and sign or seal a registration certificate and issue it to the Relying Party for each intended use requested to be registered by the Relying Party. The registration certificate SHALL comply with the applicable requirements in the technical specification mentioned in RPRC_02. <em>Note: See Topic 52.</em></td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPRC_02</td>
<td>The Commission SHALL ensure that a technical specification is created, describing at least 1. the contents and format of registration certificates, 2. the signing method(s) used to ensure the authenticity of the registration certificates. 3. the trust infrastructure necessary for signing registration certificates and for verifying these signatures, including, if necessary, the use of Trusted Lists to establish trust in Member States Registrars and to distribute their trust anchors to Wallet Units. 4. the method used for binding each registration certificate to the Relying Party Instance access certificate that will be used during the same transaction. This binding method SHALL enable a Wallet Unit to verify that the registration certificate is bound to the Relying Party that authenticated itself using the access certificate. The binding method SHALL consider situations in which the Relying Party uses the services of an intermediary (see Topic 52) to connect to the Wallet Unit. 5. whether or not a registration certificate must have a validity period. 6. the method to be used for revocation of registration certificates. Moreover, the technical specification SHALL describe the impact of revocation, especially compared to the impact of revocation of the Relying Party Instance access certificates.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPRC_03</td>
<td>The contents of a registration certificate issued per registered intended use of the Relying Party SHALL include at least information required in Annex V of the CIR for Relying Party Registration. If the Relying Party uses the services of an intermediary (see Topic 52): the fact that this is the case, plus the user-friendly (common) name and unique identifier (as meant in RPRC_03a and RPRC_03b) of this intermediary.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPRC_03a</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration instance certificate contains a common name for the Relying Party instance, in a format suitable for presenting to a User. <em>Notes: - A Wallet Unit needs such a name when requesting User approval according to [Topic 6], - If Relying Party uses an Intermediary, both Intermediary and End-Relying Party common names need to be shown when requesting User approval and the User should be informed that the Intermediary is representing/acting on behalf of the End-Relying Party</em>.</td>
<td>New</td>
</tr>
<tr>
<td>RPRC_03b</td>
<td>The common Relying Party Registration Certificate Policy SHALL require that a Relying Party registration certificate contains an EU-wide unique identifier for the Relying Party, and SHALL specify a method for deriving such identifiers. <em>Notes: - The Wallet Instance needs such an identifier at least to lodge a complaint of suspicious Relying Party presentation requests to a data protection authority according to Topic 50. - The EU-wide unique identifier could, for example, be a concatenated list of one or more registered official wallet-relying party identifiers listed in Annex I(3) of the [Draft of the CIR for RP-Registration], expressed in semantic form defined in [ETSI EN319 412-1] Sections 5.1.4 or 5.1.5 and used as the Distinguished Name (DN) of the certificate subject in both access and registration certificates of the Relying Party. Exact specification is left for the technical specifications to be developed by the European Commission.</em></td>
<td>New</td>
</tr>
<tr>
<td>RPRC_04</td>
<td>In both proximity and remote presentation flows, the Relying Party Instance SHALL transfer a Relying Party registration certificate to the Wallet Unit in the presentation request, according to the applicable standard's extension mentioned in RPRC_05. The registration certificate SHALL be included in the request by value, not by reference. <em>Note: This ensures that no external requests are necessary to validate the request, and that transactions are atomic and self-contained.</em></td>
<td>Keep</td>
</tr>
<tr>
<td>RPRC_05</td>
<td>The Commission SHALL ensure that extensions are specified for [ISO/IEC 18013-5] and for [OpenID4VP], allowing a Relying Party to transfer a Relying Party registration certificate to a Wallet Unit. These extensions SHALL comply with applicable requirements in these standards.</td>
<td>Keep</td>
</tr>
<tr>
<td>RPRC_06</td>
<td>The Wallet Unit SHALL verify the authenticity and validity of the registration certificate according to the technical specification meant in RPRC_02. If the outcome of the verification is negative, the Wallet Unit SHALL, when asking for User approval according to RPA_07 and subject to the User preference set according to RPRC_08, notify the User that it could not verify whether the Relying Party registered the requested attributes with the competent authorities.</td>
<td>Keep</td>
</tr>
<tr>
<td>RPRC_07</td>
<td>The Wallet Unit SHALL verify that all attributes requested in the presentation request are included in the list of attributes in the registration certificate. If the outcome of the verification is negative, the Wallet Unit SHALL, when asking for User approval according to RPA_07 and subject to the User preference set according to RPRC_08, notify the User about the requested attributes that the Relying Party did not register.</td>
<td>Keep</td>
</tr>
<tr>
<td>RPRC_08</td>
<td>A Wallet Unit SHOULD enable its User to set their preference for showing or hiding the notifications meant in RPRC_06 and RPRC_07. By default, the Wallet Unit SHALL show the notifications.</td>
<td>Keep</td>
</tr>
<tr>
<td>RPRC_09</td>
<td>The EU-wide unique identifier SHALL be identical in all registration certificates issued for a given Relying Party. <em>Note: In case the registration certificates issued to an End-Relying Party are held and presented by an Intermediary (Relying Party), the given Relying Party meant in the text is the End-Relying Party. An Intermediary will obtain and hold registration certificates with non-identical unique identifiers.</em></td>
<td>New</td>
</tr>
<tr>
<td>RPRC_10</td>
<td>The Commission SHALL provide technical specifications establishing common Certificate Policy for registration certificates, covering at least management and selection of signing keys, revocation and lifecycle management of RPRCs on individual intended use level. <em>Note: The TS could set the provider of RPRCs to follow applicable parts of technical standards such as EN 319 401 (for General Policy Requirements for TSPs) and TS 119 461 (for identity proofing of Relying Party representatives).</em></td>
<td>New</td>
</tr>
<tr>
<td>RPRC_11</td>
<td>There SHALL be only one valid registration certificate present in a presentation request for given intended use of a Relying Party. An error SHALL be reported (logged and shown for the User) by the Wallet Unit if it receives multiple registration certificates for the same intended use within same presentation request.</td>
<td>New</td>
</tr>
</tbody>
</table>
<h3 id="43-topic-52-relying-party-intermediaries">4.3 Topic 52 - Relying Party Intermediaries</h3>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPI_01</td>
<td>An intermediary SHALL register as a Relying Party, in accordance with all requirements in <a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>. <em>Note: This implies that an intermediary obtains an access certificate containing its own name and unique Relying Party identifier.</em></td>
<td>Keep</td>
</tr>
<tr>
<td>RPI_02</td>
<td>An intermediary is acting only as an intermediary for other (End-) Relying Parties, but from the Registrar and the regulation's point of view is considered as a Relying Party and obtains a registration certificate according to <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>, containing Intermediary name and Relying Party identifier.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPI_03</td>
<td>For each of the End-Relying Parties that uses its services, an intermediary SHALL be the holder of the registration certificate for each registered intended use of the said End-Relying Party, according to the requirements in <a href="#a2344-topic-44---relying-party-registration-certificates">Topic 44</a>. This registration certificate SHALL contain that End-Relying Party's name and unique identifier, as well as the list of attributes registered for that Relying Party's intended use.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPI_04</td>
<td>When issuing a registration certificate for a Relying Party to an intermediary, the Registrar SHALL verify, in a manner to be decided by a Member State, that the Relying Party will indeed use the services of the intermediary to interact with Wallet Units.</td>
<td>Keep</td>
</tr>
<tr>
<td>RPI_05</td>
<td>When issuing a registration certificate for an intermediary, the Registrar SHALL include in the registration certificate the attributes meant in RPRC_03a and RPRC_03b containing the name and unique identifier of the intermediated End-Relying Party.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPI_06</td>
<td>When requested for an intended use by an intermediated End-Relying Party, an intermediary SHALL request the presentation of attributes from a specific Wallet Unit, using the intermediary's access certificate meant in requirement RPI_01, and the registration certificate accessible to the intermediary in relation to the intermediated End-Relying Party and the intended use, as meant in RPI_03.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPI_07</td>
<td>In case a Wallet Unit receives a presentation request from an intermediary, on behalf of a Relying Party, it SHALL verify the name of the intermediary during Relying Party authentication and display this name to the User when asking for User approval, as described in requirement RPA_06a.</td>
<td>Keep</td>
</tr>
<tr>
<td>RPI_08</td>
<td>When a Wallet Unit presents any User attributes to an intermediary, the intermediary SHALL forward these attributes only to the Relying Party that requested the intermediary to request these attributes from the Wallet Unit.</td>
<td>Keep</td>
</tr>
</tbody>
</table>
<h2 id="5-relation-to-other-topics">5 Relation to Other Topics</h2>
<p>Below we discuss how Relying Party registration relates to the other topics being discussed.</p>
<p>As indicated in the chapter 3, several changes are proposed in the context of the Relying Party registration. The changes introduced in the respective HLRs are to be also reflected in the remaining topics/HLRs, at least in reference to Topic 6 and Topic 31. Note that term <strong>Registration Certificate Authority</strong> has been introduced, aside the formerly used Access Certificate Authority.</p>
<p>In result, the following modification are therefore proposed:</p>
<blockquote>
<p>Note: only affected HLRs are listed, not exhaustive lists as in Section 4.</p>
</blockquote>
<h3 id="51-topic-6-relying-party-authentication-and-user-approval">5.1 Topic 6 - Relying Party authentication and User approval</h3>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>RPA_06a</td>
<td>If the registration certificate indicates that an intermediary, as described in <a href="#a2352-topic-52-relying-party-intermediaries">Topic 52</a>, the Wallet Unit SHALL verify that the name and the unique identifier of the intermediary included in the registration certificate are identical to the name and unique identifier included in the Relying Party Instance access certificate. If this verification fails, the Wallet Unit SHALL treat this as a Relying Party authentication failure. If this verification succeeds, the Wallet Instance SHALL display to the User the names of the intermediary and the intermediated End-Relying Party.</td>
<td>Keep with proposed changes</td>
</tr>
</tbody>
</table>
<h3 id="52-topic-31-pid-provider-wallet-provider-attestation-provider-and-access-certificate-authority-notification-and-publication">5.2 Topic 31 - PID Provider, Wallet Provider, Attestation Provider, and Access Certificate Authority notification and publication</h3>
<table>
<thead>
<tr>
<th><strong>Index</strong></th>
<th><strong>Requirement specification</strong></th>
<th><strong>Proposal</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>GenNot_01</td>
<td>The European Commission SHALL establish technical specifications for a common system enabling the notification of PID Providers, PuB-EAA Providers, Wallet Providers, Access Certificate Authorities and Registrars of Registration Certificates by Member States to the Commission. <em>Note: Notification does not apply to QEAA Providers and (non-qualified) EAA Providers, as explained in Sections D and F below, respectively.</em></td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>GenNot_02</td>
<td>As part of the specifications referred to in GenNot_01, the European Commission SHALL establish standard operating procedures for the notification of a PID Provider, PuB-EAA Provider, Wallet Provider, Access Certificate Authorities or Registration Certificate Authorities to the Commission. <em>Note: The outcome of the notification procedure is the publication of the information notified by the Member State according to <a href="https://eur-lex.europa.eu/legal-content/EN/ALL/?uri=CELEX:32024R1183#d1e1347-1-1">Article 5a</a> (18) in a machine and human readable manner using the common system mentioned in Section H, TLPub_01.</em></td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>GenNot_05</td>
<td>As part of the specifications referred to in GenNot_01, the European Commission SHALL establish standard operating procedures for the suspension or cancellation of a PID Provider, PuB-EAA Provider, Wallet Provider, Access Certificate Authority or Registration Certificate Authority. These operating procedures SHALL include unambiguous conditions for suspension or cancellation. As an outcome of the suspension or cancellation procedure, the status of the suspended or cancelled PID Provider, PuB-EAA Provider, Wallet Provider, Access Certificate Authority or Registration Certificate Authority in the Trusted List SHALL be changed to Invalid.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>PPNot_02</td>
<td>The common set of information to be notified about a PID Provider SHALL include at least: 1. Identification data: i. MS/Country of establishment, ii. Name as registered in an official record, iii. Where applicable: a. A business registration number from an official record, b. Identification data from that official record. 2. PID Provider trust anchors, i.e., public keys and name as per point 1) ii) above, supporting the authentication of PIDs issued by the PID Provider, 3. PID Provider Access Certificate Authority trust anchors, i.e., public keys and CA name, supporting the authentication of the PID Provider by Wallet Units at the service supply point(s) listed per point 4. below. 4. Service supply point(s), i.e., the URL(s) at which a Wallet Unit can start the process of requesting and obtaining a PID. <em>Notes: - Relating to point 3. above: PID Provider Access Certificate Authority trust anchors are notified separately from the ~~Relying Party~~ Access Certificate Authority (see Section G below), since PID Providers are -legally speaking- not Relying Parties. - For the concept of an  Access Certificate Authority, see also [<a href="#a2327-topic-27---registration-of-pid-providers-providers-of-qeaas-pub-eaas-and-non-qualified-eaas-and-relying-parties">Topic 27</a>] and <a href="../../architecture-and-reference-framework-main/#632-pid-provider-or-attestation-provider-registration-and-notification">Section 6.3.2 of the ARF main document</a>.</em></td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPACANot_01</td>
<td>The European Commission SHALL establish technical specifications for the common set of information to be notified about Access Certificate Authorities and Registrars of Registration Certificates.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPACANot_02</td>
<td>The common set of information to be notified about an Access Certificate Authority and Registrars of Registration Certificates SHALL include: 1. Identification data: i) MS/Country of establishment, ii) Name as registered in an official record, iii) Where applicable: - A business registration number from an official record, - Identification data from that official record. 2. Access Certificate Authority or Registration Certificate Authority trust anchors, i.e., public keys and name as per point 1) ii), supporting the authentication of Relying Parties by Wallet Units.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPACANot_04</td>
<td>Access Certificate Authority and Registration Certificate Authority trust anchors SHALL be accepted because of their secure notification by the Member States to the Commission and by their publication in the corresponding Commission-compiled Access Certificate Authority and Registration Certificate Authority Trusted Lists which are signed or sealed by the Commission. *Note: The adopted version of the CIR for Relying Party registration will clarify how the Trusted List for Registrars of Registration Certificates are to be arranged, the certificates not being PKI/X.509 certificates as is the case with standard EU Trusted Lists. It is also to be clarified in the related technical specification if Access Certificate Authorities can sign other certificates than access certificates. *</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>RPACANot_06</td>
<td>If an Access Certificate Authority is suspended or cancelled (see requirement GenNot_05 above), that Access Certificate Authority SHALL immediately revoke all of its valid access certificates. <em>Note: When the access certificates of an Intermediary that has its RPACs issued by said suspended or cancelled Access Certificate Authority are revoked, the End-Relying Parties depending on said Intermediary, while having valid registration certificates from a Registrar will have no access to transact with EUDI Wallet Users until the End-Relying Parties a) transit to another Intermediary that has RPAC issued by an active Access Certification Authority or b)the original Access Certificate Authority can continue its operations and re-issue earlier revoked certificates for the original Intermediary.</em></td>
<td>New</td>
</tr>
<tr>
<td>RPACANot_07</td>
<td>If a Registrar of Relying Party Registration Certificates is suspended or cancelled (see requirement GenNot_05 above), that Registrar of Relying Party Registration Certificates SHALL immediately revoke all of its valid registration certificates.</td>
<td>New</td>
</tr>
<tr>
<td>TLPub_01</td>
<td>The European Commission SHALL establish technical specifications for the system enabling the publication by the Commission of the information notified by the Member States regarding PID Providers, Wallet Providers, PuB-EAA Providers, Access Certificate Authorities and Registrars of Registration Certificates.</td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>TLPub_02</td>
<td>The European Commission SHALL establish technical specifications for the set of information to be published about: PID Providers, Wallet Providers,PuB-EAA Providers, Access Certificate Authorities and Registrars of Registration Certificates based on the information notified by the Member States. <em>Note: The information to be published MAY be different from the information to be notified per requirements PPNot_01, WPNot_01, PuBPNot_01, and RPACANot_01 above, respectively.</em></td>
<td>Keep with proposed changes</td>
</tr>
<tr>
<td>TLPub_08</td>
<td>As part of the specifications referred to in TLPub_01, the European Commission SHALL establish technical specifications for ensuring the availability and authenticity of the full history regarding the information notified about PID Providers, Wallet Providers, PuB-EAA Providers, Access  Certificate Authorities and Registrars of Registration Certificates.</td>
<td>New</td>
</tr>
</tbody>
</table>
<h3 id="53-use-of-certificate-transparency">5.3 Use of Certificate Transparency</h3>
<p>[Topic S] refers to use of Certificate Transparencey (CT) in the context of access certificates. There is no decision yet whether CT will be used at all, as the initial intention of CT use was the context of browsers/QWACs. Regulation has no requirement for use of Certificate Transparency with registration certificates.</p>
<h3 id="54-user-requesting-data-deletion-to-relying-parties">5.4 User requesting data deletion to relying parties</h3>
<p>[Topic L] will discuss requirements related to the EUDI Wallet User's means to request data deletion from any Relying Parties that they've provided with attestation data. This will be using the contact details which are required to be registered as part of the registration data set.</p>
<h3 id="55-user-reporting-unlawful-or-suspicious-request-of-data-to-dpas">5.5 User reporting unlawful or suspicious request of data to DPAs</h3>
<p>[Topic M] will cover requirements on EUDI Wallet Users means to report evidently or potentially unlawful presentation requests by a Relying Party to relevant data protection authority/-ies (DPAs). This reporting would be actuated if a Relying Party is trying to ask attestations or attributes beyond its reported Intended Use -specific data set that is present in the related Registration Certificate. </p>
<p>If found in breach and not corrected promptly by the Relying Party, the DPA and national authorities are allowed to request revocation of the access and registration certificates of the Relying Party in breach of their registration data.</p>
<h3 id="56-relation-to-risk-register">5.6 Relation to Risk Register</h3>
<p>The risk register for European Digital Identity Wallets [RiskRegister]
contains the following risks that are related to the Relying Party registration:</p>
<table>
<thead>
<tr>
<th>Risk type</th>
<th>Risk id</th>
<th>Related risk titles</th>
</tr>
</thead>
<tbody>
<tr>
<td>High-level risks to the wallets</td>
<td>R6</td>
<td>Data disclosure</td>
</tr>
<tr>
<td>High-level risks to the wallets</td>
<td>R9</td>
<td>Unauthorised transaction</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>R6 Data disclosure</th>
</tr>
</thead>
<tbody>
<tr>
<td>Data disclosure is defined as the unauthorised exposure of personal data including special categories of personal data. The privacy breach risk is very similar when considered from a privacy rather than security viewpoint.</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>R9 Unauthorised transaction</th>
</tr>
</thead>
<tbody>
<tr>
<td>Unauthorised transactions are defined as operational activities conducted without the permission or knowledge of the wallet user. In many cases, an unauthorised transaction can lead to Identity theft (R4) or Data disclosure (R6). It is also related to unauthorised transactions, such as the misuse of cryptographic keys.</td>
</tr>
</tbody>
</table>
<p>More specifically, [RiskRegister] describes the following threats to a Wallet:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Threat description</th>
<th>Related risks</th>
</tr>
</thead>
<tbody>
<tr>
<td>TR25</td>
<td>The wallet can present attributes to a relying party without the approval of a user.</td>
<td>Data disclosure (R6)</td>
</tr>
<tr>
<td>TR29</td>
<td>An attacker can leak attributes from the wallet and identify the wallet user where identification is not required/allowed.</td>
<td>Data disclosure (R6)</td>
</tr>
<tr>
<td>TR38</td>
<td>Not being able to prove user’s consent for shared attributes, relying parties can affect the integrity of logs.</td>
<td>Data disclosure (R6)</td>
</tr>
<tr>
<td>TR40</td>
<td>A relying party that consists of multiple units/entities that each have a different scope of what they are allowed to request/process, can request and process data for which they do not have lawful grounds for.</td>
<td>Data disclosure (R6) / Unauthorised transaction (R9)</td>
</tr>
</tbody>
</table>
<h2 id="6-additions-and-changes-to-the-arf">6 Additions and Changes to the ARF</h2>
<p>The agreed Annex 2 HLR changes are listed in Section 4 and Section 5.1-5.2 above. In addition, discussions of the Relying Party registration in the main part of the ARF will be updated accordingly.</p>
<p><em>Note: In addition, the latest changes of [Draft of the CIR for RP-Registration] make the issuance of the Relying Party registration certificates optional. This impacts this paper and the ARF. Therefore an impact analysis has been conducted, presented below. The changes that are needed will be included in ARF 1.10.0 that will be published until the end of next week.</em> </p>
<h3 id="impact-analysis-to-the-arf-of-making-the-rprc-optional">Impact analysis to the ARF of making the RPRC optional</h3>
<table>
<thead>
<tr>
<th>#</th>
<th>Goal of RPRC according to ARF</th>
<th>Section(s) in ARF</th>
<th>Challenges if there is no RPRC</th>
<th>Proposed solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>The RPRC of a Relying Party contains the attributes that the Relying Party (i.e., a Service Provider) intends to request. The Wallet Unit notifies the User in case one or more of the requested attributes is not included in the list of attributes in the registration certificate.  The RPRC also contains the RP name and unique identifier, which is identical to the same data in the access cert.</td>
<td>6.4.2, 6.6.3.3, 6.6.3.5, Annex 2, Topic 6,  RPA_06, RPA_06a &amp; new RPA_06x HLRs needed</td>
<td>Need to define what the Wallet Unit needs to do in case no RPRC is present</td>
<td>1) The RP access cert SHALL always contain the URL of an end point of the Registrar that the Wallet Unit can use to obtain information about the Relying Party. 2) The Wallet Unit SHALL enable the User to specify that they want to do additional verifications of the RP. By default, the Wallet Unit SHALL NOT do this verification. The Wallet Unit SHALL make clear that these additional verifications may involve an online check of information at a Registrar. 3) If the User has indicated that they want to do the additional verifications: a. the Wallet Unit SHALL retrieve the RPRC from the presentation request if present and proceed as already described in the ARF; b. If the RPRC is not present, the Wallet Unit SHALL request the Registrar at the URL in point 1) for the list of registered attributes of the Relying Party, using the unique ID of the RP from its access certificate; c. The Wallet Unit SHALL notify the User about the outcome of the verification in case the RP requests attributes that it did not register. The Wallet Unit SHALL also notify the User in case the Wallet Unit was not able to retrieve the RPRC information. Otherwise (i.e., if everything is OK), a User notification is optional. <em>General notes: (i) This approach means that the level of privacy/security of the User (by carrying out the additional verifications) is not dependent on whether the MS that registered the RP has issued an RPRC. Rather, if the User chooses to, they are carried out, regardless of whether there is an RPRC in the presentation request. (ii) There are a couple of reasons for setting the default to not doing the additional verifications: RPRCs were envisioned to enable additional verifications of RPs, on top of the authentication enabled by the RP access certificate. Since RPRCs are now optional, the additional verifications enabled by the RPRC should be viewed as optional as well. These additional verifications should therefore be done only if the User explicitly requests them. In addition, to avoid possible performance issues at the Registrars. (iii) In the IA, there is no obligation for an RP to include its RPRC in a presentation request, even if it has one. It's useful to document this in the ARF.</em></td>
</tr>
<tr>
<td>2</td>
<td>The RPRC contains a URL to the privacy policy of the Relying Party regarding the intended use</td>
<td>This is not described in the ARF yet. This needs to be added in the main doc, section 6.6.3.3, as well as in Topic 44</td>
<td>No way for the RP to declare its intended use in the request</td>
<td>1) If it does not include a RPRC in the presentation request, the Relying Party SHALL include the URL to the privacy policy in a different field of the presentation request. The Commission SHALL reference or create an extension of ISO/IEC 18013-5 and OpenID4VP that enables this. 2) In case the RP is an intermediary, the URL SHALL be a URL pointing to the privacy policy of the end-RP, not the intermediary. See also issue #5 below. 3) The Wallet Unit SHALL enable the User to indicate that they want to be informed about the purpose of the RP. If the User indicates this, the Wallet Unit SHALL invoke a browser and take them to the URL.</td>
</tr>
<tr>
<td>3</td>
<td>According to Topic X, the RPRC of a PID Provider or Attestation Provider contains its entitlements. However, according to the ARF section 6.3.2.3., this information is contained in the access certificate, because according to section 6.3.2.1, a PID Provider or Attestation Provider does not receive a RPRC when it registers. According to section 6.3.2.3, the access certificate of a PID Provider or Attestation Provider may optionally also contain the Provider's entitlement to issue attestations of a specific type, for instance an mDL or diploma. In the IA on RP registration, these are called sub-entitlements.</td>
<td>6.3.2.1, 6.3.2.3, 6.6.2.1, 6.6.2.2, New/changed HLRs needed in Topic 10/23, Also updates to Topic X needed</td>
<td>Contradictions need to be removed. Clarity needs to be given about where the Wallet Unit can find entitlements in case there is no RPRC.</td>
<td>1) Unlike currently described in the ARF, a PID Provider or Attestation Provider optionally receives a RPRC during registration. This RPRC contains its basic entitlements as well as its sub-entitlements. So the sub-entitlements are not optional, like currently in the ARF. 2) The (sub-)entitlements of a PID Provider or Attestation Provider will not be included in the access cert, unlike currently described in the ARF. (Just like the registered attributes are not included in the access cert of an RP.) 3) The access cert of a PID Provider or Attestation Provider SHALL also contain the URL of an end point of the Registrar that the Wallet Unit can use to obtain information about the Provider. 4) If a Wallet Unit contacts an Attestation Provider to request issuance of an attestation, it receives an access certificate and optionally a RPRC from the Provider. If there is no RPRC, the Wallet Unit SHALL contact the Registrar and requests the entitlements of the Attestation Provider. 5) Like when a RPRC is present, the Wallet Unit SHALL notify the User in case the Attestation Provider has not been registered for the attestation type. In addition, the Wallet Unit SHALL also notify the User in case the Wallet Unit was not able to contact the Registrar. Otherwise (i.e., if everything is OK), a User notification is optional. <em>Notes: (i) In step 4 contacting the Register is mandatory and should not be left to the User to decide (like in #issue 1 above). This is because the risk to privacy is less compared to the analogous risk in issue #1.  (ii) Additionally, we need to check if the ARF already describes that a Relying Party can also check the subentitlement of an Attestation Provider.</em></td>
</tr>
<tr>
<td>4</td>
<td>Embedded disclosure policies may be based on information in the RPRC as well as the access certificate.</td>
<td>6.6.2.7.2, 6.6.3.4, EDP_02</td>
<td>Not possible to base EDPs on information in the RPRC</td>
<td>Let an EPD refer only to information in the access certificate. Since only policies 2 and 3 (per the IA) are mandated for EDPs, this is possible, because the unique RP identifier is in the access certificate</td>
</tr>
<tr>
<td>5</td>
<td>RPRC contains the (business) relation between an end-RP and the intermediary it uses. The RPRC of the end-RP contains an attribute containing the identifier of the intermediary. The Wallet Unit verifies that that this identifier is identical to the RP identifier in the access cert it got. In addition, the Wallet Unit shows the name/identifier of the end-RP in the RPRC to the User.</td>
<td>3.11, 6.6.3.5, Annex 2 Topic 52, 3.11, 6.6.3.5</td>
<td>No way for the Wallet Unit to know that the intermediary is requesting attributes on behalf of an end-RP. No way for the Wallet Unit to receive the name of the end-RP.</td>
<td>The process is basically the same as for issue #1 above: 1) The URL of the end point of the Registrar mentioned in step 1) of issue #1 enables the Wallet Unit to obtain information about the intermediary as well as its end-Relying Parties. Note that according to the IA on RP registration, an intermediary and its end-RPs are always registered by the same Registrar. 2) If the intermediary does not include an RPRC in the presentation request, it SHALL include the user-friendly name and the unique identifier of the end-RP in a different field of the presentation request. The Commission SHALL reference or create an extension of ISO/IEC 18013-5 and OpenID4VP that enables this. The Wallet Unit SHALL show the user-friendly name of the end-RP to the User when asking for User approval. 3) If the User has indicated that they want to do the additional verifications meant in step 2) of issue #1, a. the Wallet Unit SHALL retrieve the RPRC from the presentation request, if present, and proceed as already described in the ARF 1.9.0.  b. If the RPRC is not present, the Wallet Unit SHALL retrieve the unique identifier of the end-PR from the presentation request and use it to request the Registrar at the URL in point 1) to confirm (i) that this RP indeed uses the services of this intermediary. (ii) that this end-RP has been properly registered for the attributes it is requesting. c. The Wallet Unit SHALL notify the User about the outcome of these verifications in case one or both of them are unsuccessful. The Wallet Unit SHALL also notify the User in case the Wallet Unit was not able to retrieve the RPRC information. Otherwise (i.e., if everything is OK), a User notification is optional.</td>
</tr>
<tr>
<td>6</td>
<td>HLR DASH_03 says: For a presentation transaction executed through the Wallet Unit, the log SHALL contain the name, contact details, and unique identifier of the corresponding Relying Party, and the Member State in which that Relying Party is established. DASH_05 says For an issuance or re-issuance transaction executed through the Wallet Unit, the log SHALL contain the name, contact details, and unique identifier of the corresponding PID Provider or Attestation Provider. These HRLs do not say where the Wallet Unit gets this information, and neither does the main document.  But the assumption was from the RPRC. Moreover, in Topic M it was decided that the RPRC also contains the contact details of the relevant DPA.</td>
<td>Topic 19, (After 1.10:) Topic 48, Topic 50</td>
<td>The name and unique ID are in the RP access certificate, but the contact details are not (to my understanding). So we need to define where the Wallet Unit gets this information if there is no RPRC.</td>
<td>DASH_03 and DASH_05 must be adapted to say that name and unique ID come from the access certificate, and that logging of the contact details is only required if there is a RPRC containing this info. Moreover, the Wallet Unit SHALL log the URL of the end point of the Registrar (from the access cert, see also point 1 in issue #1). During integration of Topic L (data deletion) and M (report to DPA) into the ARF, we need to specify how the Wallet Unit obtains the contact details of the RP or the DPA in case these are not in the log (because there was no RPRC). The Wallet Unit can contact the Registrar to do so.</td>
</tr>
</tbody>
</table>
<h3 id="other-but-related-changes-to-be-done-in-the-arf-when-updating-texts-on-the-rprc">Other but related changes to be done in the ARF when updating texts on the RPRC</h3>
<table>
<thead>
<tr>
<th>#</th>
<th>Description</th>
<th>Section(s) in ARF</th>
<th>Proposed solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>7</td>
<td>The ARF does not contain the concept of a Trusted List of Relying Party Registrars. Yet, Topic 44 says that such Registrars sign RP registration certificates, and that Wallet Units must verify the authenticity of these certificates. A Wallet Unit can only do so if it has the trust anchors of all Registrars, and that implies we need a Trusted List for them.</td>
<td>Main document chapter 6 (including in Figure 11), Annex 2 Topic 44.</td>
<td>Add the Trusted List of Relying Party Registrars both in the ARF main document and in Topic 44.</td>
</tr>
<tr>
<td>8</td>
<td>The ARF main document does not distinguish a Registrar for Wallet Providers, PID Providers and Attestation Providers. Instead, it says that these entities are registered by a Trusted List Provider. This is also shown in Figure 11. This is not consistent with the language used in the IA on RP registration.</td>
<td>Main document chapter 6 (including in Figure 11), Topic 44</td>
<td>We need to introduce a separate Access Certificate Provider and Registration Certificate Provider, as these roles are introduced in the IA on Art 5b, in addition to the role of Registrar.</td>
</tr>
<tr>
<td>9</td>
<td>The ARF is not clear on the number of RPRCs per request and the number of purposes per RPRC. This needs to be explained.</td>
<td>6.6.3.3, Topic 44</td>
<td>Each request by an RP shall have one purpose and shall therefore have only one RPRC. The RP may request attributes from multiple attestations, but those should all be covered by the same RPRC. (i) If the RP wants to request data for multiple purposes from the same Wallet Unit, they shall send multiple requests. (ii) It's the RP's responsibility to ensure that they get an RPRC for each of their purposes. (iii) A purpose is indicated by means of a URL to the privacy policy of the Relying Party regarding the intended use. See also issue #2 above.</td>
</tr>
<tr>
<td>10</td>
<td>Terminology</td>
<td></td>
<td>The ARF must no longer use "suspension" and "withdrawal" of the RP, but "suspension" and "cancellation" of the registration of an RP when talking about registration</td>
</tr>
</tbody>
</table>
<h2 id="7-references">7 References</h2>
<table>
<thead>
<tr>
<th>Reference</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>[ARF_DevPlan]</td>
<td>Architecture and Reference Framework Development plan 2025, European Commission, v1.0</td>
</tr>
<tr>
<td>[Topic S]</td>
<td>Topic S - Certificate transparency</td>
</tr>
<tr>
<td>[Topic 6]</td>
<td>Topic 6 - Relying Party authentication and User approval</td>
</tr>
<tr>
<td>[Topic 27]</td>
<td>Topic 27 - Registration of PID Providers, Providers of QEAAs, PuB-EAAs, and (non-qualified) EAAs, and Relying Parties</td>
</tr>
<tr>
<td>[Topic 31]</td>
<td>Topic 31 - PID Provider, Wallet Provider, Attestation Provider, and Access Certificate Authority notification and publication</td>
</tr>
<tr>
<td>[Topic 44]</td>
<td>Topic 44 - Relying Party registration certificates</td>
</tr>
<tr>
<td>[Topic 52]</td>
<td>Topic 52 - Relying Party intermediaries</td>
</tr>
<tr>
<td>[RiskRegister]</td>
<td><a href="https://eur-lex.europa.eu/legal-content/EN/TXT/HTML/?uri=OJ:L_202402981#anx_I">Annex 1 to the Commission Implementing Regulation laying down rules for the application of Regulation (EU) No 910/2014 of the European Parliament and of the Council as regards the certification of the European Digital Identity Wallets, European Commission, October 2024, draft</a></td>
</tr>
<tr>
<td>[European Digital Identity Regulation]</td>
<td>Regulation (EU) 2024/1183 of the European Parliament and of the Council of 11 April 2024 amending Regulation (EU) No 910/2014 as regards establishing the European Digital Identity Framework</td>
</tr>
<tr>
<td>[Draft of the CIR for RP-Registration]</td>
<td><a href="https://ec.europa.eu/info/law/better-regulation/have-your-say/initiatives/14399-European-Digital-Identity-Wallets-registration-of-relying-parties_en">Commission Implementing Regulation (EU) 2025/xxxx laying down rules for the application of Regulation (EU) No 910/2014 of the European Parliament and of the Council as regards the registration of wallet-relying parties*, draft</a></td>
</tr>
<tr>
<td>[OID4VP]</td>
<td><a href="https://github.com/eu-digital-identity-wallet/eudi-doc-standards-and-technical-specifications/issues/2">OpenID for Verifiable Presentations</a></td>
</tr>
<tr>
<td>[German non-paper on RP Authn]</td>
<td>DE non-paper on Wallet-Relying Party Authentication, outlining a proposed solution for implementing the Wallet-Relying Party authentication requirements from IA 5b</td>
</tr>
<tr>
<td>[German non-paper on WRP with attestations]</td>
<td>DE non-paper on use fo OID4VC with Wallet-Relying Party Attestations (architecture concept)</td>
</tr>
<tr>
<td>[ETSI EN 319 401]</td>
<td><a href="https://github.com/eu-digital-identity-wallet/eudi-doc-standards-and-technical-specifications/issues/140">ETSI Electronic Signatures and Infrastructures; General Policy Requirements for Trust Service Providers</a></td>
</tr>
<tr>
<td>[ETSI TS 119 461]</td>
<td><a href="https://github.com/eu-digital-identity-wallet/eudi-doc-standards-and-technical-specifications/issues/271">ETSI Electronic Signatures and Infrastructures; Policy and security requirements for trust service components providing identity proofing of trust service subjects</a></td>
</tr>
<tr>
<td>[ETSI EN 319 412-1]</td>
<td><a href="https://github.com/eu-digital-identity-wallet/eudi-doc-standards-and-technical-specifications/issues/178">ETSI Electronic Signatures and Infrastructures; Certificate Profiles, Part 1: Overview and common data structures</a></td>
</tr>
</tbody>
</table>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.path", "navigation.top", "toc.integrate", "toc.follow"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>